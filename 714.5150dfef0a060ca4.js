"use strict";(self.webpackChunkshams_hr_web_app=self.webpackChunkshams_hr_web_app||[]).push([[714],{7714:(Ji,O,m)=>{m.r(O),m.d(O,{FleetModule:()=>Ei});var g=m(6895),D=m(1635),u=m(7155),I=m(3900),R=m(6212);class X extends R.G{}var T=m(9172),F=m(5311),w=m(1654),C=m(673),c=m(4006),x=m(5412),E=m(9646),G=m(4128);class W{}var e=m(4650),f=m(9057),$=m(5);let b=(()=>{const a=class{constructor(n){this.http=n}getVehicleList(n){return this.http.post(f.b.getVehicleList,n)}getVehicleSearchData(){return this.http.get(f.b.getVehicleSearchData)}getVehicle(n){let i=f.b.getVehicle;return i=i.replace(/{id}/gi,n),this.http.get(i)}getVehicleManageData(){return this.http.get(f.b.getVehicleManageData)}addVehicle(n){return this.http.post(f.b.addVehicle,n)}editVehicle(n){return this.http.post(f.b.editVehicle,n)}deleteVehicle(n){let i=f.b.deleteVehicle;return i=i.replace(/{id}/gi,n),this.http.post(i,null)}};let t=a;return a.\u0275fac=function(i){return new(i||a)(e.LFG($.o))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),t})();var S=m(5332);let U=(()=>{const a=class{constructor(n){this.http=n}getVehicleDocList(n){return this.http.post(f.b.getVehicleDocList,n)}getVehicleDocSearchData(){return this.http.get(f.b.getVehicleDocSearchData)}addVehicleDoc(n){return this.http.post(f.b.addVehicleDoc,n)}addVehicleDocFile(n){return this.http.post(f.b.addVehicleDocFile,n)}removeVehicleDoc(n){let i=f.b.removeVehicleDoc;return i=i.replace(/{id}/gi,n),this.http.post(i,null)}removeVehicleDocFile(n){let i=f.b.removeVehicleDocFile;return i=i.replace(/{id}/gi,n),this.http.post(i,null)}exportVehicleDoc(n){let i=f.b.exportVehicleDoc;return i=i.replace(/{id}/gi,n),this.http.postAttachment(i,null)}};let t=a;return a.\u0275fac=function(i){return new(i||a)(e.LFG($.o))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),t})();var Q=m(5659),v=m(9549),A=m(4144),N=m(4859),V=m(4385),L=m(3238),y=m(9602),ee=m(2833),te=m(4682),Y=m(1837),H=m(1234),k=m(2043);const ie=["docUpload"],oe=["docName"];function ne(t,a){1&t&&(e.TgZ(0,"app-form-heading"),e._uU(1," Add Vehicle\n"),e.qZA())}function ae(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function le(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function ce(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o),e.xp6(1),e.Oqu(o)}}function re(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o),e.xp6(1),e.Oqu(o)}}function se(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function me(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function de(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function pe(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){e.CHM(o);const i=e.oxw().index,l=e.oxw(2);return e.KtG(l.onDocRemove(i))}),e._uU(1,"Remove File"),e.qZA()}}function ue(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"div",32)(1,"div",6)(2,"mat-form-field",7)(3,"mat-label"),e._uU(4,"Doc Type"),e.qZA(),e.TgZ(5,"mat-select",33,34),e.NdJ("selectionChange",function(i){const r=e.CHM(o).index,s=e.oxw(2);return e.KtG(s.onDocumentTypeChange(i,r))}),e.YNc(7,de,2,2,"mat-option",12),e.qZA()(),e.TgZ(8,"mat-form-field",7)(9,"mat-label"),e._uU(10,"Identifier"),e.qZA(),e._UZ(11,"input",35),e.qZA(),e.TgZ(12,"mat-form-field",36)(13,"mat-label"),e._uU(14,"Expiry"),e.qZA(),e._UZ(15,"input",37)(16,"mat-datepicker-toggle",38)(17,"mat-datepicker",null,39),e.qZA(),e.TgZ(19,"div",40)(20,"button",41),e.NdJ("click",function(){const l=e.CHM(o).index,r=e.oxw(2);return e.KtG(r.onDocSelect(l))}),e._uU(21,"Select File"),e.qZA(),e._UZ(22,"input",42,43)(24,"label",44,45),e.YNc(26,pe,2,0,"button",46),e.qZA(),e.TgZ(27,"div",47)(28,"app-delete-action-icon",48),e.NdJ("deleteEvent",function(){const l=e.CHM(o).index,r=e.oxw(2);return e.KtG(r.deleteDocumentItem(l))}),e.qZA()()()()}if(2&t){const o=a.$implicit,n=a.index,i=e.MAs(6),l=e.MAs(18),r=e.MAs(25),s=e.oxw(2);e.Q6J("formGroupName",n),e.xp6(7),e.Q6J("ngForOf",s.manageData.documentTypeList),e.xp6(8),e.Q6J("matDatepicker",l),e.xp6(1),e.Q6J("for",l),e.xp6(4),e.Q6J("disabled",null==i.value),e.xp6(6),e.Q6J("ngIf",""!=r.textContent),e.xp6(2),e.Q6J("item",o)}}function he(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"div",2)(1,"form",3),e.NdJ("submit",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.addVehicle())}),e.TgZ(2,"div",4)(3,"div",5)(4,"div",6)(5,"mat-form-field",7)(6,"mat-label"),e._uU(7,"Code"),e.qZA(),e._UZ(8,"input",8),e.qZA(),e.TgZ(9,"mat-form-field",7)(10,"mat-label"),e._uU(11,"Plate Number"),e.qZA(),e._UZ(12,"input",9),e.qZA(),e.TgZ(13,"mat-form-field",10)(14,"mat-label"),e._uU(15,"Make"),e.qZA(),e.TgZ(16,"mat-select",11),e.NdJ("selectionChange",function(i){e.CHM(o);const l=e.oxw();return e.KtG(l.onMakeChange(i))}),e.YNc(17,ae,2,2,"mat-option",12),e.qZA()(),e.TgZ(18,"mat-form-field",10)(19,"mat-label"),e._uU(20,"Model"),e.qZA(),e.TgZ(21,"mat-select",13),e.YNc(22,le,2,2,"mat-option",12),e.qZA()()(),e.TgZ(23,"div",6)(24,"mat-form-field",7)(25,"mat-label"),e._uU(26,"Year"),e.qZA(),e._UZ(27,"input",14),e.qZA(),e.TgZ(28,"mat-form-field",15)(29,"mat-label"),e._uU(30,"Wheel"),e.qZA(),e.TgZ(31,"mat-select",16),e._UZ(32,"mat-option"),e.YNc(33,ce,2,2,"mat-option",12),e.qZA()(),e.TgZ(34,"mat-form-field",10)(35,"mat-label"),e._uU(36,"Fuel"),e.qZA(),e.TgZ(37,"mat-select",17),e._UZ(38,"mat-option"),e.YNc(39,re,2,2,"mat-option",12),e.qZA()(),e.TgZ(40,"mat-form-field",15)(41,"mat-label"),e._uU(42,"Color"),e.qZA(),e._UZ(43,"input",18),e.qZA()(),e.TgZ(44,"div",6)(45,"mat-form-field",19)(46,"mat-label"),e._uU(47,"Owner Company"),e.qZA(),e.TgZ(48,"mat-select",20),e.NdJ("selectionChange",function(i){e.CHM(o);const l=e.oxw();return e.KtG(l.onCompanyChange(i))}),e._UZ(49,"mat-option"),e.YNc(50,se,2,2,"mat-option",12),e.qZA()(),e.TgZ(51,"mat-form-field",19)(52,"mat-label"),e._uU(53,"Owner Person"),e.qZA(),e.TgZ(54,"mat-select",21),e._UZ(55,"mat-option"),e.YNc(56,me,2,2,"mat-option",12),e.qZA()()()()(),e.TgZ(57,"div",4)(58,"div",5)(59,"div",22)(60,"div",23)(61,"div",24)(62,"label"),e._uU(63,"Document"),e.qZA()(),e.TgZ(64,"div",25)(65,"app-add-action-icon",26),e.NdJ("addEvent",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.addDocumentItemForm())}),e.qZA()()(),e.TgZ(66,"div",27),e.YNc(67,ue,29,7,"div",28),e.qZA()()()(),e.TgZ(68,"div",4)(69,"app-crud-reset-button",29),e.NdJ("resetEvent",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.reset())}),e.qZA(),e._UZ(70,"app-crud-add-button",30),e.qZA()()()}if(2&t){const o=e.oxw();e.xp6(1),e.Q6J("formGroup",o.manageForm),e.xp6(16),e.Q6J("ngForOf",o.manageData.makeList),e.xp6(5),e.Q6J("ngForOf",o.modelListFiltered),e.xp6(11),e.Q6J("ngForOf",o.manageData.wheelTypeList),e.xp6(6),e.Q6J("ngForOf",o.manageData.fuelTypeList),e.xp6(11),e.Q6J("ngForOf",o.manageData.companyList),e.xp6(6),e.Q6J("ngForOf",o.employeeList),e.xp6(11),e.Q6J("ngForOf",o.documentListControls),e.xp6(3),e.Q6J("disabled",o.isProcessing)}}let _e=(()=>{const a=class{constructor(n,i,l,r,s,d,p){this.dialogRef=n,this.vehicleService=i,this.employeeService=l,this.vehicleDocService=r,this.ds=s,this.renderer=d,this.data=p,this.isLoaded=!1,this.modelListFiltered=[],this.employeeList=[],this.isProcessing=!1}get documentListControls(){return this.manageForm.get("documentList").controls}ngOnInit(){this.manageForm=new c.cw({code:new c.NI("VHC-",[c.kI.required]),plateNumber:new c.NI(null,[c.kI.required]),makeId:new c.NI(null,[c.kI.required]),modelId:new c.NI(null,[c.kI.required]),year:new c.NI(null),ownerCompanyId:new c.NI(null),ownerPersonId:new c.NI(null),wheelType:new c.NI("Four"),fuelType:new c.NI("Petrol"),color:new c.NI(null),documentList:new c.Oe([])}),this.isLoaded=!1,this.sub=this.vehicleService.getVehicleManageData().subscribe(n=>{this.manageData=n.item,this.addDefaultDoc("Mulkia"),this.isLoaded=!0})}addDefaultDoc(n){let i=this.manageData.documentTypeList.find(l=>l.name==n)?.id;this.manageForm.get("documentList").push(new c.cw({documentTypeId:new c.NI(i,c.kI.required),identifier:new c.NI(null,c.kI.required),expiryDate:new c.NI(null,c.kI.required),file:new c.NI(null)}))}onMakeChange(n){this.modelListFiltered=this.manageData.modelList.filter(i=>i.make.id==this.manageForm.value.makeId)??[],this.manageForm.patchValue({modelId:""})}onCompanyChange(n){this.employeeList=[],this.sub=this.employeeService.getEmployeeListByCompany(this.manageForm.value.ownerCompanyId).subscribe(i=>{i?.response.status==C.s.success?(this.employeeList=i.list,this.manageForm.patchValue({ownerPersonId:null})):alert(i?.response.message)})}onDocumentTypeChange(n,i){let l=this.manageData.documentTypeList.find(s=>s.id==n.value);var r=this.manageForm.get("documentList").at(i);r.get("identifier").disabled&&r.get("identifier").enable(),r.get("expiryDate").disabled&&r.get("expiryDate").enable(),r.patchValue({identifier:null,expiryDate:null,file:null}),this.onDocRemove(i),l.isIdentifier?r.get("identifier")?.setValidators(c.kI.required):r.get("identifier")?.removeValidators(c.kI.required),l.isExpiry?r.get("expiryDate")?.setValidators(c.kI.required):r.get("expiryDate")?.removeValidators(c.kI.required),r.get("identifier").markAsUntouched(),r.get("expiryDate").markAsUntouched(),r.get("identifier").updateValueAndValidity(),r.get("expiryDate").updateValueAndValidity()}addDocumentItemForm(){this.manageForm.get("documentList").push(new c.cw({documentTypeId:new c.NI(null,c.kI.required),identifier:new c.NI({value:null,disabled:!0}),expiryDate:new c.NI({value:null,disabled:!0}),file:new c.NI(null)}))}deleteDocumentItem(n){this.manageForm.get("documentList").removeAt(n)}onDocSelect(n){let i=this.manageForm.get("documentList").at(n),l=this.manageData.documentTypeList.find(s=>s.id==i.value.documentTypeId),r=this.docUpload.get(n).nativeElement;r.onchange=()=>{if(r.files&&r.files[0]){const s=r.files[0];if(l.contentLimitKb>0&&s.size>1e3*l.contentLimitKb)return r.value="",void alert(`Size max allowed ${l.contentLimitKb}kb exceeded`);let d=this.docName.get(n).nativeElement;this.renderer.setProperty(d,"textContent",s.name),i.patchValue({file:s})}},r.click()}onDocRemove(n){let i=this.manageForm.get("documentList").at(n);this.docUpload.get(n).nativeElement.value="";let r=this.docName.get(n).nativeElement;this.renderer.setProperty(r,"textContent",""),i.patchValue({file:null})}addVehicle(){if(!this.manageForm.valid)return void this.manageForm.markAllAsTouched();if(!confirm(F.J.areYouSureTo))return;let n=new W;n.code=this.manageForm.value.code,n.plateNumber=this.manageForm.value.plateNumber,n.makeId=this.manageForm.value.makeId,n.modelId=this.manageForm.value.modelId,n.year=this.manageForm.value.year,n.ownerCompanyId=this.manageForm.value.ownerPersonId?null:this.manageForm.value.ownerCompanyId,n.ownerPersonId=this.manageForm.value.ownerPersonId??null,n.wheelType=this.manageForm.value.wheelType,n.fuelType=this.manageForm.value.fuelType,n.color=this.manageForm.value.color;let i=this.validateDoc();""==i?(this.isProcessing=!0,this.sub=this.vehicleService.addVehicle(n).pipe((0,I.w)(l=>{if(l.response?.status!=C.s.success)return this.isProcessing=!1,alert(l.response?.message),(0,E.of)(null);let r=l.item?.id;const s=[];return this.manageForm.value.documentList.forEach(d=>{const p=new FormData;p.append("vehicleId",r),p.append("documentTypeId",d.documentTypeId),p.append("identifier",d.identifier),null!=d.expiryDate&&p.append("expiryDate",this.ds.formatToRequest(d.expiryDate)),p.append("doc",d.file),s.push(this.vehicleDocService.addVehicleDoc(p))}),0==s.length?(this.reset(),this.closeDialog(),(0,E.of)(null)):(0,G.D)(s)})).subscribe(l=>{this.isProcessing=!1,this.reset(),this.closeDialog()})):alert(`Error : ${i}`)}validateDoc(){let n=[],i="";if(this.manageForm.value.documentList.forEach(r=>{n.findIndex(d=>d.key.docId==r.documentTypeId)>=0?i=r.documentTypeId:n.push({key:{docId:r.documentTypeId},value:1})}),""!=i){var l=this.manageData.documentTypeList.find(r=>r.id==i)?.name;return`Duplicate doc ${l} found`}return""}reset(){for(this.manageForm.reset();this.manageForm.get("documentList").length>0;)this.manageForm.get("documentList").removeAt(0)}closeDialog(){this.dialogRef.close(!0)}ngOnDestroy(){this.sub?.unsubscribe()}};let t=a;return a.\u0275fac=function(i){return new(i||a)(e.Y36(x.so),e.Y36(b),e.Y36(S.G),e.Y36(U),e.Y36(Q.R),e.Y36(e.Qsj),e.Y36(x.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-add-vehicle"]],viewQuery:function(i,l){if(1&i&&(e.Gf(ie,5),e.Gf(oe,5)),2&i){let r;e.iGM(r=e.CRH())&&(l.docUpload=r),e.iGM(r=e.CRH())&&(l.docName=r)}},decls:2,vars:2,consts:[[4,"ngIf"],["mat-dialog-content","","class","row",4,"ngIf"],["mat-dialog-content","",1,"row"],[1,"my-2",3,"formGroup","submit"],[1,"row"],[1,"col-12"],[1,"row","form-group"],[1,"form-field","col-2"],["type","text","matInput","","formControlName","code"],["type","text","matInput","","formControlName","plateNumber"],[1,"form-field","col-4"],["formControlName","makeId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","modelId"],["type","number","matInput","","formControlName","year"],[1,"form-field","col-3"],["formControlName","wheelType"],["formControlName","fuelType"],["type","text","matInput","","formControlName","color"],[1,"form-field","col-6"],["formControlName","ownerCompanyId",3,"selectionChange"],["formControlName","ownerPersonId"],["formArrayName","documentList"],[1,"row","my-4"],[1,"col-2"],[1,"col-2","text-end"],[3,"addEvent"],[1,"mt-3"],["class","col-12 form-group",3,"formGroupName",4,"ngFor","ngForOf"],[1,"col-2",3,"resetEvent"],[1,"col-2","offset-8",3,"disabled"],[3,"value"],[1,"col-12","form-group",3,"formGroupName"],["formControlName","documentTypeId",3,"selectionChange"],["typeId",""],["type","text","matInput","","formControlName","identifier"],["appearance","outline",1,"col-2","form-field"],["matInput","","formControlName","expiryDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],[1,"col-5","mt-2"],["type","button","mat-button","","color","primary",1,"col-3",3,"disabled","click"],["type","file","accept","image/*,.pdf",2,"display","none"],["docUpload",""],[1,"col-6"],["docName",""],["type","button","mat-button","","color","primary","class","col-3",3,"click",4,"ngIf"],[1,"col-1","text-end","mt-2"],[3,"item","deleteEvent"],["type","button","mat-button","","color","primary",1,"col-3",3,"click"]],template:function(i,l){1&i&&(e.YNc(0,ne,2,0,"app-form-heading",0),e.YNc(1,he,71,9,"div",1)),2&i&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[g.sg,g.O5,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.sg,c.u,c.x0,c.CE,v.KE,v.hX,v.R9,A.Nt,N.lW,x.xY,V.gD,L.ey,y.Mq,y.hl,y.nW,ee.L,te.X,Y.b,H.E,k.H]}),t})();var q=m(1219),fe=m(2696),ge=m(3667),Z=m(7579);function ve(t,a){if(1&t&&(e.TgZ(0,"mat-option",15),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function xe(t,a){if(1&t&&(e.TgZ(0,"mat-option",15),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function Ze(t,a){if(1&t&&(e.TgZ(0,"mat-option",15),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}let Te=(()=>{const a=class{constructor(){this.onSearchChange=new Z.x,this.onSearch=new Z.x,this.modelListFiltered=[]}ngOnInit(){this.filterForm=new c.cw({searchKey:new c.NI(""),makeId:new c.NI(""),modelId:new c.NI(""),companyId:new c.NI("")}),this.valueChangeSub=this.filterForm.valueChanges.subscribe(n=>{this.onSearchChange.next(n)})}search(){this.onSearch.next()}resetFilter(){this.filterForm.patchValue({searchKey:"",makeId:"",modelId:"",companyId:""})}onMakeChange(n){this.modelListFiltered=this.searchData.modelList.filter(i=>i.make.id==this.filterForm.value.makeId)??[],this.filterForm.patchValue({modelId:""})}ngOnDestroy(){this.valueChangeSub.unsubscribe()}};let t=a;return a.\u0275fac=function(i){return new(i||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-vehicle-search-filter"]],inputs:{searchData:"searchData"},outputs:{onSearchChange:"onSearchChange",onSearch:"onSearch"},decls:34,vars:4,consts:[[1,"mt-4",3,"formGroup","ngSubmit"],[1,"row","form-group"],["type","button","mat-button","","color","primary",1,"col-1","offset-1","mt-2",3,"click"],[1,"form-field","col-2"],["formControlName","makeId",3,"selectionChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","modelId"],[1,"form-field","col-3"],["formControlName","companyId"],["appearance","outline","floatLabel","always",1,"form-field","col-2"],["type","search","placeholder","","matInput","","formControlName","searchKey"],[1,"col-1"],["type","submit","mat-raised-button","","color","primary",1,"col-12","offset-0","mt-2"],[1,"material-icons"],[3,"value"]],template:function(i,l){1&i&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return l.search()}),e.TgZ(1,"div",1)(2,"button",2),e.NdJ("click",function(){return l.resetFilter()}),e._uU(3,"Reset"),e.qZA(),e.TgZ(4,"mat-form-field",3)(5,"mat-label"),e._uU(6,"Make"),e.qZA(),e.TgZ(7,"mat-select",4),e.NdJ("selectionChange",function(s){return l.onMakeChange(s)}),e.TgZ(8,"mat-option",5),e._uU(9,"All"),e.qZA(),e.YNc(10,ve,2,2,"mat-option",6),e.qZA()(),e.TgZ(11,"mat-form-field",3)(12,"mat-label"),e._uU(13,"Model"),e.qZA(),e.TgZ(14,"mat-select",7)(15,"mat-option",5),e._uU(16,"All"),e.qZA(),e.YNc(17,xe,2,2,"mat-option",6),e.qZA()(),e.TgZ(18,"mat-form-field",8)(19,"mat-label"),e._uU(20,"Company"),e.qZA(),e.TgZ(21,"mat-select",9)(22,"mat-option",5),e._uU(23,"All"),e.qZA(),e.YNc(24,Ze,2,2,"mat-option",6),e.qZA()(),e.TgZ(25,"mat-form-field",10)(26,"mat-label"),e._uU(27,"Search"),e.qZA(),e._UZ(28,"input",11),e.qZA(),e.TgZ(29,"div",12)(30,"button",13)(31,"i",14),e._uU(32,"search"),e.qZA(),e._uU(33," Search"),e.qZA()()()()),2&i&&(e.Q6J("formGroup",l.filterForm),e.xp6(10),e.Q6J("ngForOf",l.searchData.makeList),e.xp6(7),e.Q6J("ngForOf",l.modelListFiltered),e.xp6(7),e.Q6J("ngForOf",l.searchData.companyList))},dependencies:[g.sg,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,v.KE,v.hX,A.Nt,N.lW,V.gD,L.ey]}),t})();class we{}class Ce extends we{}class ye{}var K=m(455),De=m(7786);const Ie=["docUpload"],Ne=["docName"];function be(t,a){1&t&&(e.TgZ(0,"app-form-heading"),e._uU(1," Edit Vehicle\n"),e.qZA())}function Ae(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function Ve(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function Le(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o),e.xp6(1),e.Oqu(o)}}function qe(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o),e.xp6(1),e.Oqu(o)}}function Fe(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function Ee(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function Ue(t,a){if(1&t&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function Je(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"button",53),e.NdJ("click",function(){e.CHM(o);const i=e.oxw().index,l=e.oxw(2);return e.KtG(l.onDocSelect(i))}),e._uU(1,"Select File"),e.qZA()}if(2&t){e.oxw();const o=e.MAs(6);e.Q6J("disabled",null==o.value)}}function Se(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"button",54),e.NdJ("click",function(){e.CHM(o);const i=e.oxw().index,l=e.oxw(2);return e.KtG(l.onDocRemove(i))}),e._uU(1,"Remove File"),e.qZA()}}function Qe(t,a){1&t&&(e.TgZ(0,"label"),e._uU(1,"Doc Uploaded"),e.qZA())}function Ye(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"div",32)(1,"div",6)(2,"mat-form-field",7)(3,"mat-label"),e._uU(4,"Doc Type"),e.qZA(),e.TgZ(5,"mat-select",33,34),e.NdJ("selectionChange",function(i){const r=e.CHM(o).index,s=e.oxw(2);return e.KtG(s.onDocumentTypeChange(i,r))}),e.YNc(7,Ue,2,2,"mat-option",12),e.qZA()(),e.TgZ(8,"mat-form-field",7)(9,"mat-label"),e._uU(10,"Identifier"),e.qZA(),e._UZ(11,"input",35),e.qZA(),e.TgZ(12,"mat-form-field",36)(13,"mat-label"),e._uU(14,"Expiry"),e.qZA(),e._UZ(15,"input",37)(16,"mat-datepicker-toggle",38)(17,"mat-datepicker",null,39),e.qZA(),e._UZ(19,"input",40,41)(21,"input",42,43),e.TgZ(23,"div",44),e.YNc(24,Je,2,1,"button",45),e._UZ(25,"input",46,47)(27,"label",48,49),e.YNc(29,Se,2,0,"button",50),e.YNc(30,Qe,2,0,"label",0),e.qZA(),e.TgZ(31,"div",51)(32,"app-delete-action-icon",52),e.NdJ("deleteEvent",function(){const l=e.CHM(o).index,r=e.oxw(2);return e.KtG(r.deleteDocumentItem(l))}),e.qZA()()()()}if(2&t){const o=a.$implicit,n=a.index,i=e.MAs(18),l=e.MAs(20),r=e.MAs(22),s=e.MAs(28),d=e.oxw(2);e.Q6J("formGroupName",n),e.xp6(7),e.Q6J("ngForOf",d.manageData.documentTypeList),e.xp6(8),e.Q6J("matDatepicker",i),e.xp6(1),e.Q6J("for",i),e.xp6(8),e.Q6J("ngIf",0==l.value.length||0==r.value.length),e.xp6(5),e.Q6J("ngIf",""!=s.textContent),e.xp6(1),e.Q6J("ngIf",l.value.length>0&&r.value.length>0),e.xp6(2),e.Q6J("item",o)}}function ke(t,a){if(1&t&&e._UZ(0,"app-crud-edit-button",55),2&t){const o=e.oxw(2);e.Q6J("disabled",o.isProcessing)}}function Me(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"div",2)(1,"form",3),e.NdJ("submit",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.editVehicle())}),e.TgZ(2,"div",4)(3,"div",5)(4,"div",6)(5,"mat-form-field",7)(6,"mat-label"),e._uU(7,"Code"),e.qZA(),e._UZ(8,"input",8),e.qZA(),e.TgZ(9,"mat-form-field",7)(10,"mat-label"),e._uU(11,"Plate Number"),e.qZA(),e._UZ(12,"input",9),e.qZA(),e.TgZ(13,"mat-form-field",10)(14,"mat-label"),e._uU(15,"Make"),e.qZA(),e.TgZ(16,"mat-select",11),e.NdJ("selectionChange",function(i){e.CHM(o);const l=e.oxw();return e.KtG(l.onMakeChange(i))}),e.YNc(17,Ae,2,2,"mat-option",12),e.qZA()(),e.TgZ(18,"mat-form-field",10)(19,"mat-label"),e._uU(20,"Model"),e.qZA(),e.TgZ(21,"mat-select",13),e.YNc(22,Ve,2,2,"mat-option",12),e.qZA()()(),e.TgZ(23,"div",6)(24,"mat-form-field",7)(25,"mat-label"),e._uU(26,"Year"),e.qZA(),e._UZ(27,"input",14),e.qZA(),e.TgZ(28,"mat-form-field",15)(29,"mat-label"),e._uU(30,"Wheel"),e.qZA(),e.TgZ(31,"mat-select",16),e._UZ(32,"mat-option"),e.YNc(33,Le,2,2,"mat-option",12),e.qZA()(),e.TgZ(34,"mat-form-field",10)(35,"mat-label"),e._uU(36,"Fuel"),e.qZA(),e.TgZ(37,"mat-select",17),e._UZ(38,"mat-option"),e.YNc(39,qe,2,2,"mat-option",12),e.qZA()(),e.TgZ(40,"mat-form-field",15)(41,"mat-label"),e._uU(42,"Color"),e.qZA(),e._UZ(43,"input",18),e.qZA()(),e.TgZ(44,"div",6)(45,"mat-form-field",19)(46,"mat-label"),e._uU(47,"Owner Company"),e.qZA(),e.TgZ(48,"mat-select",20),e.NdJ("selectionChange",function(i){e.CHM(o);const l=e.oxw();return e.KtG(l.onCompanyChange(i))}),e._UZ(49,"mat-option"),e.YNc(50,Fe,2,2,"mat-option",12),e.qZA()(),e.TgZ(51,"mat-form-field",19)(52,"mat-label"),e._uU(53,"Owner Person"),e.qZA(),e.TgZ(54,"mat-select",21),e._UZ(55,"mat-option"),e.YNc(56,Ee,2,2,"mat-option",12),e.qZA()()()()(),e.TgZ(57,"div",4)(58,"div",5)(59,"div",22)(60,"div",23)(61,"div",24)(62,"label"),e._uU(63,"Document"),e.qZA()(),e.TgZ(64,"div",25)(65,"app-add-action-icon",26),e.NdJ("addEvent",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.addDocumentItemForm())}),e.qZA()()(),e.TgZ(66,"div",27),e.YNc(67,Ye,33,8,"div",28),e.qZA()(),e.TgZ(68,"div",4)(69,"mat-slide-toggle",29),e._uU(70,"Active"),e.qZA(),e.YNc(71,ke,1,1,"app-crud-edit-button",30),e.qZA()()()()()}if(2&t){const o=e.oxw();e.xp6(1),e.Q6J("formGroup",o.manageForm),e.xp6(7),e.Q6J("disabled",!0),e.xp6(9),e.Q6J("ngForOf",o.manageData.makeList),e.xp6(5),e.Q6J("ngForOf",o.modelListFiltered),e.xp6(11),e.Q6J("ngForOf",o.manageData.wheelTypeList),e.xp6(6),e.Q6J("ngForOf",o.manageData.fuelTypeList),e.xp6(11),e.Q6J("ngForOf",o.manageData.companyList),e.xp6(6),e.Q6J("ngForOf",o.employeeList),e.xp6(11),e.Q6J("ngForOf",o.documentListControls),e.xp6(4),e.Q6J("ngIf",null!=o.data)}}let Oe=(()=>{const a=class{constructor(n,i,l,r,s,d,p){this.dialogRef=n,this.vehicleService=i,this.vehicleDocService=l,this.employeeService=r,this.ds=s,this.renderer=d,this.data=p,this.isLoaded=!1,this.modelListFiltered=[],this.employeeList=[],this.deletedDocumentList=[],this.isProcessing=!1}get documentListControls(){return this.manageForm.get("documentList").controls}ngOnInit(){this.manageForm=new c.cw({code:new c.NI({value:null,disabled:!0},[c.kI.required]),plateNumber:new c.NI(null,[c.kI.required]),makeId:new c.NI(null,[c.kI.required]),modelId:new c.NI(null,[c.kI.required]),year:new c.NI(null),ownerCompanyId:new c.NI(null),ownerPersonId:new c.NI(null),wheelType:new c.NI(null),fuelType:new c.NI(null),color:new c.NI(null),documentList:new c.Oe([]),active:new c.NI(!0,[c.kI.required])}),this.isLoaded=!1,this.sub=this.vehicleService.getVehicleManageData().pipe((0,I.w)(n=>(this.manageData=n.item,this.vehicleService.getVehicle(this.data?.id)))).subscribe(n=>{this.isLoaded=!0;let i=n.item;this.modelListFiltered=this.manageData.modelList.filter(l=>l.make.id==i.make?.id)??[],this.manageForm.patchValue({code:i.code,plateNumber:i.plateNumber,makeId:i.make.id,modelId:i.model?.id,year:i.year,ownerCompanyId:i.ownerCompany?.id,ownerPersonId:i.ownerPerson?.id,wheelType:i.wheelType,fuelType:i.fuelType,color:i.color,active:i.active}),(null!=i.ownerCompany||null!=i.ownerPerson)&&(this.sub=this.employeeService.getEmployeeListByCompany(this.manageForm.value.ownerCompanyId).subscribe(l=>{l?.response.status==C.s.success?(this.employeeList=l.list,this.manageForm.patchValue({ownerPersonId:i.ownerPerson?.id})):alert(l?.response.message)})),i.documentList.forEach(l=>{let r=null!=l.expiryDate?this.ds.responseFormatToDate(l.expiryDate):null;this.manageForm.get("documentList").push(new c.cw({id:new c.NI(l.id),documentTypeId:new c.NI({value:l.documentType.id,disabled:!0}),identifier:new c.NI({value:l.identifier,disabled:!0}),expiryDate:new c.NI({value:r,disabled:!0}),file:new c.NI(null),fileName:new c.NI(l.fileName)}))})})}addDocumentItemForm(){this.manageForm.get("documentList").push(new c.cw({id:new c.NI(null),documentTypeId:new c.NI(null,c.kI.required),identifier:new c.NI({value:null,disabled:!0}),expiryDate:new c.NI({value:null,disabled:!0}),file:new c.NI(null),fileName:new c.NI(null)}))}deleteDocumentItem(n){let i=this.manageForm.get("documentList").at(n);null!=i.value.id&&this.deletedDocumentList.push(i.value.id),this.manageForm.get("documentList").removeAt(n)}onDocumentTypeChange(n,i){let l=this.manageData.documentTypeList.find(s=>s.id==n.value);var r=this.manageForm.get("documentList").at(i);r.get("identifier").disabled&&r.get("identifier").enable(),r.get("expiryDate").disabled&&r.get("expiryDate").enable(),r.patchValue({identifier:null,expiryDate:null,file:null,fileName:null}),this.onDocRemove(i),l.isIdentifier?r.get("identifier")?.setValidators(c.kI.required):r.get("identifier")?.removeValidators(c.kI.required),l.isExpiry?r.get("expiryDate")?.setValidators(c.kI.required):r.get("expiryDate")?.removeValidators(c.kI.required),r.get("identifier").markAsUntouched(),r.get("expiryDate").markAsUntouched(),r.get("identifier").updateValueAndValidity(),r.get("expiryDate").updateValueAndValidity()}onDocSelect(n){let i=this.manageForm.get("documentList").at(n),l=this.manageData.documentTypeList.find(s=>s.id==i.getRawValue().documentTypeId),r=this.docUpload.get(n).nativeElement;r.onchange=()=>{if(r.files&&r.files[0]){const s=r.files[0];if(l.contentLimitKb>0&&s.size>1e3*l.contentLimitKb)return r.value="",void alert(`Size max allowed ${l.contentLimitKb}kb exceeded`);let d=this.docName.get(n).nativeElement;this.renderer.setProperty(d,"textContent",s.name),i.patchValue({file:s})}},r.click()}onDocRemove(n){let i=this.manageForm.get("documentList").at(n);this.docUpload.get(n).nativeElement.value="";let r=this.docName.get(n).nativeElement;this.renderer.setProperty(r,"textContent",""),i.patchValue({file:null})}reset(){for(this.manageForm.reset();this.manageForm.get("documentList").length>0;)this.manageForm.get("documentList").removeAt(0)}onMakeChange(n){this.modelListFiltered=this.manageData.modelList.filter(i=>i.make.id==this.manageForm.value.makeId)??[],this.manageForm.patchValue({modelId:""})}onCompanyChange(n){this.employeeList=[],this.sub=this.employeeService.getEmployeeListByCompany(this.manageForm.value.ownerCompanyId).subscribe(i=>{i?.response.status==C.s.success?(this.employeeList=i.list,this.manageForm.patchValue({ownerPersonId:null})):alert(i?.response.message)})}editVehicle(){if(!this.manageForm.valid)return void this.manageForm.markAllAsTouched();if(!confirm(F.J.areYouSureTo))return;let n=new ye;n.id=this.data?.id,n.code=this.data.code,n.plateNumber=this.manageForm.value.plateNumber,n.makeId=this.manageForm.value.makeId,n.modelId=this.manageForm.value.modelId,n.year=this.manageForm.value.year,n.ownerCompanyId=this.manageForm.value.ownerCompanyId,n.ownerPersonId=this.manageForm.value.ownerPersonId,n.wheelType=this.manageForm.value.wheelType,n.fuelType=this.manageForm.value.fuelType,n.color=this.manageForm.value.color,n.active=this.manageForm.value.active;let i=[],l=[];this.manageForm.get("documentList").controls.forEach((s,d)=>{if(null!=s.value.id)return void l.push({docId:s.getRawValue().documentTypeId,identifier:s.getRawValue().identifier});let p=new Ce;p.documentTypeId=s.value.documentTypeId,p.identifier=s.value.identifier,null!=s.value.expiryDate&&(p.expiryDate=this.ds.formatToRequest(s.value.expiryDate)),i.push(p)});let r=this.validateDoc(i,l);""==r?(this.isProcessing=!0,this.sub=this.vehicleService.editVehicle(n).pipe((0,I.w)(s=>{if(s.status!=C.s.success)return this.isProcessing=!1,alert(s.message),(0,E.of)(null);let d=n.id;const p=[];return this.deletedDocumentList.forEach(h=>{p.push(this.vehicleDocService.removeVehicleDoc(h))}),this.manageForm.get("documentList").controls.forEach(h=>{if(null!=h.getRawValue().id){if(null==h.value.file)return;{const _=new FormData;_.append("id",h.getRawValue().id),_.append("doc",h.value.file),p.push(this.vehicleDocService.addVehicleDocFile(_))}}else{const _=new FormData;_.append("vehicleId",d),_.append("documentTypeId",h.value.documentTypeId),_.append("identifier",h.value.identifier),null!=h.value.expiryDate&&_.append("expiryDate",this.ds.formatToRequest(h.value.expiryDate)),_.append("doc",h.value.file),p.push(this.vehicleDocService.addVehicleDoc(_))}}),0==p.length?(this.reset(),this.closeDialog(),(0,E.of)(null)):(0,G.D)(p)})).subscribe(s=>{this.isProcessing=!1,this.reset(),this.closeDialog()})):alert(`Error : ${r}`)}validateDoc(n,i){let l=[],r="";if(n.forEach(d=>{l.findIndex(h=>h.key.docId==d.documentTypeId)>=0||i.findIndex(_=>_.docId==d.documentTypeId)>=0?r=d.documentTypeId:l.push({key:{docId:d.documentTypeId},value:1})}),""!=r){var s=this.manageData.documentTypeList.find(d=>d.id==r)?.name;return`Duplicate doc ${s} found`}return""}closeDialog(){this.dialogRef.close(!0)}ngOnDestroy(){this.sub?.unsubscribe()}};let t=a;return a.\u0275fac=function(i){return new(i||a)(e.Y36(x.so),e.Y36(b),e.Y36(U),e.Y36(S.G),e.Y36(Q.R),e.Y36(e.Qsj),e.Y36(x.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-edit-vehicle"]],viewQuery:function(i,l){if(1&i&&(e.Gf(Ie,5),e.Gf(Ne,5)),2&i){let r;e.iGM(r=e.CRH())&&(l.docUpload=r),e.iGM(r=e.CRH())&&(l.docName=r)}},decls:2,vars:2,consts:[[4,"ngIf"],["mat-dialog-content","","class","row",4,"ngIf"],["mat-dialog-content","",1,"row"],[1,"my-2",3,"formGroup","submit"],[1,"row"],[1,"col-12"],[1,"row","form-group"],[1,"form-field","col-2"],["type","text","matInput","","formControlName","code",3,"disabled"],["type","text","matInput","","formControlName","plateNumber"],[1,"form-field","col-4"],["formControlName","makeId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","modelId"],["type","number","matInput","","formControlName","year"],[1,"form-field","col-3"],["formControlName","wheelType"],["formControlName","fuelType"],["type","text","matInput","","formControlName","color"],[1,"form-field","col-6"],["formControlName","ownerCompanyId",3,"selectionChange"],["formControlName","ownerPersonId"],["formArrayName","documentList"],[1,"row","my-4"],[1,"col-2"],[1,"col-2","text-end"],[3,"addEvent"],[1,"mt-3"],["class","col-12 form-group",3,"formGroupName",4,"ngFor","ngForOf"],["formControlName","active",1,"form-field","col-2","offset-8","text-start"],["class","col-2",3,"disabled",4,"ngIf"],[3,"value"],[1,"col-12","form-group",3,"formGroupName"],["formControlName","documentTypeId",3,"selectionChange"],["typeId",""],["type","text","matInput","","formControlName","identifier"],["appearance","outline",1,"col-2","form-field"],["matInput","","formControlName","expiryDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],["hidden","","formControlName","id"],["id",""],["hidden","","formControlName","fileName"],["fileName",""],[1,"col-5","mt-2"],["type","button","mat-button","","color","primary","class","col-3",3,"disabled","click",4,"ngIf"],["type","file","accept","image/*,.pdf",2,"display","none"],["docUpload",""],[1,"col-6"],["docName",""],["type","button","mat-button","","color","primary","class","col-3",3,"click",4,"ngIf"],[1,"col-1","text-end","mt-2"],[3,"item","deleteEvent"],["type","button","mat-button","","color","primary",1,"col-3",3,"disabled","click"],["type","button","mat-button","","color","primary",1,"col-3",3,"click"],[1,"col-2",3,"disabled"]],template:function(i,l){1&i&&(e.YNc(0,be,2,0,"app-form-heading",0),e.YNc(1,Me,72,10,"div",1)),2&i&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[g.sg,g.O5,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.sg,c.u,c.x0,c.CE,v.KE,v.hX,v.R9,A.Nt,N.lW,x.xY,V.gD,L.ey,K.Rr,y.Mq,y.hl,y.nW,De.W,Y.b,H.E,k.H]}),t})();var J=m(5861),P=m(8064),M=m(7268),B=m(8922);function Re(t,a){1&t&&(e.TgZ(0,"app-form-heading"),e._uU(1," View Vehicle\n"),e.qZA())}function Ge(t,a){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function $e(t,a){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function He(t,a){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o),e.xp6(1),e.Oqu(o)}}function Ke(t,a){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o),e.xp6(1),e.Oqu(o)}}function Pe(t,a){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function Be(t,a){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function ze(t,a){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function je(t,a){1&t&&(e.TgZ(0,"label",45),e._uU(1,"Doc Uploaded"),e.qZA())}function Xe(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"app-view-action-icon",46),e.NdJ("viewEvent",function(i){e.CHM(o);const l=e.oxw(3);return e.KtG(l.viewDoc(i))}),e.qZA()}if(2&t){const o=e.oxw().index;e.Q6J("item",o)}}function We(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"app-download-action-icon",47),e.NdJ("downloadEvent",function(i){e.CHM(o);const l=e.oxw(3);return e.KtG(l.downloadDoc(i))}),e.qZA()}if(2&t){const o=e.oxw().index;e.Q6J("item",o)}}function et(t,a){if(1&t&&(e.TgZ(0,"div",29)(1,"div",6)(2,"mat-form-field",7)(3,"mat-label"),e._uU(4,"Doc Type"),e.qZA(),e.TgZ(5,"mat-select",30,31),e.YNc(7,ze,2,2,"mat-option",12),e.qZA()(),e.TgZ(8,"mat-form-field",7)(9,"mat-label"),e._uU(10,"Identifier"),e.qZA(),e._UZ(11,"input",32),e.qZA(),e.TgZ(12,"mat-form-field",33)(13,"mat-label"),e._uU(14,"Expiry"),e.qZA(),e._UZ(15,"input",34)(16,"mat-datepicker-toggle",35)(17,"mat-datepicker",null,36),e.qZA(),e._UZ(19,"input",37,38)(21,"input",39,40),e.TgZ(23,"div",41),e.YNc(24,je,2,0,"label",42),e.YNc(25,Xe,1,1,"app-view-action-icon",43),e.YNc(26,We,1,1,"app-download-action-icon",44),e.qZA()()()),2&t){const o=a.index,n=e.MAs(18),i=e.MAs(20),l=e.MAs(22),r=e.oxw(2);e.Q6J("formGroupName",o),e.xp6(7),e.Q6J("ngForOf",r.manageData.documentTypeList),e.xp6(8),e.Q6J("matDatepicker",n),e.xp6(1),e.Q6J("for",n),e.xp6(8),e.Q6J("ngIf",i.value.length>0&&l.value.length>0),e.xp6(1),e.Q6J("ngIf",i.value.length>0&&l.value.length>0&&r.allowExport),e.xp6(1),e.Q6J("ngIf",i.value.length>0&&l.value.length>0&&r.allowExport)}}function tt(t,a){if(1&t&&(e.TgZ(0,"div",2)(1,"form",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"mat-form-field",7)(6,"mat-label"),e._uU(7,"Code"),e.qZA(),e._UZ(8,"input",8),e.qZA(),e.TgZ(9,"mat-form-field",7)(10,"mat-label"),e._uU(11,"Plate Number"),e.qZA(),e._UZ(12,"input",9),e.qZA(),e.TgZ(13,"mat-form-field",10)(14,"mat-label"),e._uU(15,"Make"),e.qZA(),e.TgZ(16,"mat-select",11),e.YNc(17,Ge,2,2,"mat-option",12),e.qZA()(),e.TgZ(18,"mat-form-field",10)(19,"mat-label"),e._uU(20,"Model"),e.qZA(),e.TgZ(21,"mat-select",13),e.YNc(22,$e,2,2,"mat-option",12),e.qZA()()(),e.TgZ(23,"div",6)(24,"mat-form-field",7)(25,"mat-label"),e._uU(26,"Year"),e.qZA(),e._UZ(27,"input",14),e.qZA(),e.TgZ(28,"mat-form-field",15)(29,"mat-label"),e._uU(30,"Wheel"),e.qZA(),e.TgZ(31,"mat-select",16),e._UZ(32,"mat-option"),e.YNc(33,He,2,2,"mat-option",12),e.qZA()(),e.TgZ(34,"mat-form-field",10)(35,"mat-label"),e._uU(36,"Fuel"),e.qZA(),e.TgZ(37,"mat-select",17),e._UZ(38,"mat-option"),e.YNc(39,Ke,2,2,"mat-option",12),e.qZA()(),e.TgZ(40,"mat-form-field",15)(41,"mat-label"),e._uU(42,"Color"),e.qZA(),e._UZ(43,"input",18),e.qZA()(),e.TgZ(44,"div",6)(45,"mat-form-field",19)(46,"mat-label"),e._uU(47,"Owner Company"),e.qZA(),e.TgZ(48,"mat-select",20),e._UZ(49,"mat-option"),e.YNc(50,Pe,2,2,"mat-option",12),e.qZA()(),e.TgZ(51,"mat-form-field",19)(52,"mat-label"),e._uU(53,"Owner Person"),e.qZA(),e.TgZ(54,"mat-select",21),e._UZ(55,"mat-option"),e.YNc(56,Be,2,2,"mat-option",12),e.qZA()()()()(),e.TgZ(57,"div",4)(58,"div",5)(59,"div",22)(60,"div",23)(61,"div",24)(62,"label"),e._uU(63,"Document"),e.qZA()()(),e.TgZ(64,"div",25),e.YNc(65,et,27,7,"div",26),e.qZA()(),e.TgZ(66,"div",4)(67,"mat-slide-toggle",27),e._uU(68,"Active"),e.qZA()()()()()()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("formGroup",o.manageForm),e.xp6(7),e.Q6J("disabled",!0),e.xp6(9),e.Q6J("ngForOf",o.manageData.makeList),e.xp6(5),e.Q6J("ngForOf",o.modelListFiltered),e.xp6(11),e.Q6J("ngForOf",o.manageData.wheelTypeList),e.xp6(6),e.Q6J("ngForOf",o.manageData.fuelTypeList),e.xp6(11),e.Q6J("ngForOf",o.manageData.companyList),e.xp6(6),e.Q6J("ngForOf",o.employeeList),e.xp6(9),e.Q6J("ngForOf",o.documentListControls)}}let it=(()=>{const a=class{constructor(n,i,l,r,s,d,p,h,_){this.dialogRef=n,this.menuRoleService=i,this.vehicleService=l,this.vehicleDocService=r,this.employeeService=s,this.ds=d,this.renderer=p,this.fileService=h,this.data=_,this.isLoaded=!1,this.modelListFiltered=[],this.employeeList=[],this.allowExport=!1}get documentListControls(){return this.manageForm.get("documentList").controls}ngOnInit(){this.allowExport=this.menuRoleService.isMenuRoleAuthorizedSingle(T.w.Fleet,w.k.export),this.manageForm=new c.cw({code:new c.NI({value:null,disabled:!0},[c.kI.required]),plateNumber:new c.NI({value:null,disabled:!0},[c.kI.required]),makeId:new c.NI({value:null,disabled:!0},[c.kI.required]),modelId:new c.NI({value:null,disabled:!0},[c.kI.required]),year:new c.NI({value:null,disabled:!0}),ownerCompanyId:new c.NI({value:null,disabled:!0}),ownerPersonId:new c.NI({value:null,disabled:!0}),wheelType:new c.NI({value:null,disabled:!0}),fuelType:new c.NI({value:null,disabled:!0}),color:new c.NI({value:null,disabled:!0}),documentList:new c.Oe([]),active:new c.NI({value:null,disabled:!0},[c.kI.required])}),this.isLoaded=!1,this.sub=this.vehicleService.getVehicleManageData().pipe((0,I.w)(n=>(this.manageData=n.item,this.vehicleService.getVehicle(this.data?.id)))).subscribe(n=>{this.isLoaded=!0;let i=n.item;this.modelListFiltered=this.manageData.modelList.filter(l=>l.make.id==i.make?.id)??[],this.manageForm.patchValue({code:i.code,plateNumber:i.plateNumber,makeId:i.make.id,modelId:i.model?.id,year:i.year,ownerCompanyId:i.ownerCompany?.id,ownerPersonId:i.ownerPerson?.id,wheelType:i.wheelType,fuelType:i.fuelType,color:i.color,active:i.active}),(null!=i.ownerCompany||null!=i.ownerPerson)&&(this.sub=this.employeeService.getEmployeeListByCompany(this.manageForm.value.ownerCompanyId).subscribe(l=>{l?.response.status==C.s.success?(this.employeeList=l.list,this.manageForm.patchValue({ownerPersonId:i.ownerPerson?.id})):alert(l?.response.message)})),i.documentList.forEach(l=>{let r=null!=l.expiryDate?this.ds.responseFormatToDate(l.expiryDate):null;this.manageForm.get("documentList").push(new c.cw({id:new c.NI(l.id),documentTypeId:new c.NI({value:l.documentType.id,disabled:!0}),identifier:new c.NI({value:l.identifier,disabled:!0}),expiryDate:new c.NI({value:r,disabled:!0}),file:new c.NI(null),fileName:new c.NI(l.fileName)}))})})}viewDoc(n){var i=this;let r=this.manageForm.get("documentList").at(n).getRawValue().id;this.sub=this.vehicleDocService.exportVehicleDoc(r).subscribe(function(){var s=(0,J.Z)(function*(d){i.fileService.viewFile(d)});return function(d){return s.apply(this,arguments)}}())}downloadDoc(n){var i=this,l=this.manageForm.get("documentList").at(n);let r=l.getRawValue().id,s=l.getRawValue().identifier,d=this.manageData.documentTypeList.find(h=>h.id==l.getRawValue().documentTypeId),p=`${this.data.code}_${d.code}`;null!=s&&(p=`${p}_${s}`),this.sub=this.vehicleDocService.exportVehicleDoc(r).subscribe(function(){var h=(0,J.Z)(function*(_){i.fileService.downloadFile(_,p)});return function(_){return h.apply(this,arguments)}}())}ngOnDestroy(){this.sub?.unsubscribe()}};let t=a;return a.\u0275fac=function(i){return new(i||a)(e.Y36(x.so),e.Y36(q.K),e.Y36(b),e.Y36(U),e.Y36(S.G),e.Y36(Q.R),e.Y36(e.Qsj),e.Y36(P.I),e.Y36(x.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-view-vehicle"]],decls:2,vars:2,consts:[[4,"ngIf"],["mat-dialog-content","","class","row",4,"ngIf"],["mat-dialog-content","",1,"row"],[1,"my-2",3,"formGroup"],[1,"row"],[1,"col-12"],[1,"row","form-group"],[1,"form-field","col-2"],["type","text","matInput","","formControlName","code",3,"disabled"],["type","text","matInput","","formControlName","plateNumber"],[1,"form-field","col-4"],["formControlName","makeId"],[3,"value",4,"ngFor","ngForOf"],["formControlName","modelId"],["type","number","matInput","","formControlName","year"],[1,"form-field","col-3"],["formControlName","wheelType"],["formControlName","fuelType"],["type","text","matInput","","formControlName","color"],[1,"form-field","col-6"],["formControlName","ownerCompanyId"],["formControlName","ownerPersonId"],["formArrayName","documentList"],[1,"row","my-4"],[1,"col-2"],[1,"mt-3"],["class","col-12 form-group",3,"formGroupName",4,"ngFor","ngForOf"],["formControlName","active",1,"form-field","col-2","offset-8","text-start"],[3,"value"],[1,"col-12","form-group",3,"formGroupName"],["formControlName","documentTypeId"],["typeId",""],["type","text","matInput","","formControlName","identifier"],["appearance","outline",1,"col-2","form-field"],["matInput","","formControlName","expiryDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],["hidden","","formControlName","id"],["id",""],["hidden","","formControlName","fileName"],["fileName",""],[1,"col-6","mt-2"],["class","col-8 text-center",4,"ngIf"],["class","mx-4",3,"item","viewEvent",4,"ngIf"],[3,"item","downloadEvent",4,"ngIf"],[1,"col-8","text-center"],[1,"mx-4",3,"item","viewEvent"],[3,"item","downloadEvent"]],template:function(i,l){1&i&&(e.YNc(0,Re,2,0,"app-form-heading",0),e.YNc(1,tt,69,9,"div",1)),2&i&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[g.sg,g.O5,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.sg,c.u,c.x0,c.CE,v.KE,v.hX,v.R9,A.Nt,x.xY,V.gD,L.ey,K.Rr,y.Mq,y.hl,y.nW,M.R,B.e,k.H]}),t})();var z=m(7974),j=m(4521),ot=m(1763);const nt=["page"];function at(t,a){1&t&&(e.TgZ(0,"th",27),e._uU(1," Code "),e.qZA())}function lt(t,a){if(1&t&&(e.TgZ(0,"td",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.hij(" ",o.code," ")}}function ct(t,a){1&t&&(e.TgZ(0,"th",27),e._uU(1," PlateNumber "),e.qZA())}function rt(t,a){if(1&t&&(e.TgZ(0,"td",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.hij(" ",o.plateNumber," ")}}function st(t,a){1&t&&(e.TgZ(0,"th",27),e._uU(1," Make "),e.qZA())}function mt(t,a){if(1&t&&(e.TgZ(0,"td",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.hij(" ",o.make," ")}}function dt(t,a){1&t&&(e.TgZ(0,"th",27),e._uU(1," Model "),e.qZA())}function pt(t,a){if(1&t&&(e.TgZ(0,"td",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.hij(" ",o.model," ")}}function ut(t,a){1&t&&(e.TgZ(0,"th",27),e._uU(1," Year "),e.qZA())}function ht(t,a){if(1&t&&(e.TgZ(0,"td",28),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.hij(" ",o.year," ")}}function _t(t,a){1&t&&(e.TgZ(0,"th",27),e._uU(1," Owner "),e.qZA())}function ft(t,a){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&t){const o=e.oxw().$implicit;e.xp6(1),e.hij("",o.ownerCompany," ")}}function gt(t,a){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&t){const o=e.oxw().$implicit;e.xp6(1),e.hij("",o.ownerPerson," ")}}function vt(t,a){if(1&t&&(e.TgZ(0,"td",29),e.YNc(1,ft,2,1,"span",30),e.YNc(2,gt,2,1,"span",30),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.Q6J("ngIf",null!=o.ownerCompany&&null==o.ownerPerson),e.xp6(1),e.Q6J("ngIf",null!=o.ownerPerson)}}function xt(t,a){1&t&&(e.TgZ(0,"th",27),e._uU(1," Wheel "),e.qZA())}function Zt(t,a){if(1&t&&(e.TgZ(0,"td",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.hij(" ",o.wheelType," ")}}function Tt(t,a){1&t&&(e.TgZ(0,"th",27),e._uU(1," Fuel "),e.qZA())}function wt(t,a){if(1&t&&(e.TgZ(0,"td",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.hij(" ",o.fuelType," ")}}function Ct(t,a){1&t&&(e.TgZ(0,"th",27),e._uU(1," Color "),e.qZA())}function yt(t,a){if(1&t&&(e.TgZ(0,"td",31),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.hij(" ",o.color," ")}}function Dt(t,a){1&t&&(e.TgZ(0,"th",27)(1,"i",32),e._uU(2,"attachment"),e.qZA(),e._uU(3," / "),e.TgZ(4,"i",32),e._uU(5,"description"),e.qZA()())}function It(t,a){if(1&t&&(e.TgZ(0,"span",37),e._uU(1),e.qZA()),2&t){const o=e.oxw().$implicit;e.xp6(1),e.AsE("",o.fileCount,"/",o.docCount,"")}}function Nt(t,a){if(1&t&&(e.TgZ(0,"span",38),e._uU(1),e.qZA()),2&t){const o=e.oxw().$implicit;e.xp6(1),e.AsE("",o.fileCount,"/",o.docCount,"")}}function bt(t,a){if(1&t&&(e.TgZ(0,"span",39),e._uU(1),e.qZA()),2&t){const o=e.oxw().$implicit;e.xp6(1),e.AsE("",o.fileCount,"/",o.docCount,"")}}function At(t,a){if(1&t&&(e.TgZ(0,"td",33),e.YNc(1,It,2,2,"span",34),e.YNc(2,Nt,2,2,"span",35),e.YNc(3,bt,2,2,"span",36),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.Q6J("ngIf",0==o.docCount),e.xp6(1),e.Q6J("ngIf",o.fileCount==o.docCount&&o.docCount>0),e.xp6(1),e.Q6J("ngIf",o.fileCount<o.docCount&&o.docCount>0)}}function Vt(t,a){1&t&&e._UZ(0,"th",40)}function Lt(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"app-edit-action-icon",45),e.NdJ("editEvent",function(){e.CHM(o);const i=e.oxw().$implicit,l=e.oxw();return e.KtG(l.edit(i))}),e.qZA()}if(2&t){const o=e.oxw().$implicit;e.Q6J("item",o)}}function qt(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"app-delete-action-icon",46),e.NdJ("deleteEvent",function(){e.CHM(o);const i=e.oxw().$implicit,l=e.oxw();return e.KtG(l.delete(i))}),e.qZA()}if(2&t){const o=e.oxw().$implicit;e.Q6J("item",o)}}function Ft(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"td",41)(1,"app-view-action-icon",42),e.NdJ("viewEvent",function(){const l=e.CHM(o).$implicit,r=e.oxw();return e.KtG(r.view(l))}),e.qZA(),e.YNc(2,Lt,1,1,"app-edit-action-icon",43),e.YNc(3,qt,1,1,"app-delete-action-icon",44),e.qZA()}if(2&t){const o=a.$implicit,n=e.oxw();e.xp6(1),e.Q6J("item",o),e.xp6(1),e.Q6J("ngIf",n.allowEdit),e.xp6(1),e.Q6J("ngIf",n.allowDelete)}}function Et(t,a){1&t&&e._UZ(0,"tr",47)}function Ut(t,a){1&t&&e._UZ(0,"tr",48)}const Jt=function(){return[10,20,50]};let St=(()=>{const a=class{constructor(n,i){this.menuRoleService=n,this.dialog=i,this.moreEvent=new Z.x,this.editEvent=new Z.x,this.deleteEvent=new Z.x,this.displayedColumns=["code","plateNumber","make","model","year","owner","wheel","fuel","color","d/f","manage"],this.baseUrl=(0,f.S)(),this.allowEdit=!1,this.allowDelete=!1}ngOnInit(){this.allowEdit=this.menuRoleService.isMenuRoleAuthorizedSingle(T.w.Fleet,w.k.edit),this.allowDelete=this.menuRoleService.isMenuRoleAuthorizedSingle(T.w.Fleet,w.k.delete)}ngOnChanges(n){this.vehicleList.paginator=this.paginator}ngAfterViewInit(){this.vehicleList.paginator=this.paginator}more(){this.moreEvent.next(!0)}edit(n){this.dialog.open(Oe,{data:n,width:"85%",maxHeight:"auto"}).afterClosed().subscribe(l=>{1==l&&this.editEvent.next()})}view(n){this.dialog.open(it,{data:n,width:"85%",maxHeight:"auto"})}delete(n){this.deleteEvent.next(n)}};let t=a;return a.\u0275fac=function(i){return new(i||a)(e.Y36(q.K),e.Y36(x.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-vehicle-list"]],viewQuery:function(i,l){if(1&i&&e.Gf(nt,5),2&i){let r;e.iGM(r=e.CRH())&&(l.paginator=r.first)}},inputs:{vehicleList:"vehicleList",count:"count"},outputs:{moreEvent:"moreEvent",editEvent:"editEvent",deleteEvent:"deleteEvent"},features:[e.TTD],decls:42,vars:7,consts:[[1,"mat-elevation-z8"],["mat-table","",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","col-1",4,"matCellDef"],["matColumnDef","plateNumber"],["matColumnDef","make"],["matColumnDef","model"],["matColumnDef","year"],["matColumnDef","owner"],["mat-cell","","class","col-3",4,"matCellDef"],["matColumnDef","wheel"],["mat-cell","","class","col",4,"matCellDef"],["matColumnDef","fuel"],["matColumnDef","color"],["matColumnDef","d/f"],["mat-cell","","class","","style","width: 6rem;",4,"matCellDef"],["matColumnDef","manage"],["mat-header-cell","","class","text-end",4,"matHeaderCellDef"],["mat-cell","","class","text-end","style","width: 12rem;",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","",3,"pageSizeOptions"],["page",""],[1,"row"],[1,"col-6"],[3,"loaded","count","loadMore"],["mat-header-cell",""],["mat-cell","",1,"col-1"],["mat-cell","",1,"col-3"],[4,"ngIf"],["mat-cell","",1,"col"],[1,"material-icons"],["mat-cell","",1,"",2,"width","6rem"],["class","bg-warn p-1 rounded-pill text-white",4,"ngIf"],["class","bg-success p-1 rounded-pill text-white",4,"ngIf"],["class","bg-accent p-1 rounded-pill",4,"ngIf"],[1,"bg-warn","p-1","rounded-pill","text-white"],[1,"bg-success","p-1","rounded-pill","text-white"],[1,"bg-accent","p-1","rounded-pill"],["mat-header-cell","",1,"text-end"],["mat-cell","",1,"text-end",2,"width","12rem"],[3,"item","viewEvent"],[3,"item","editEvent",4,"ngIf"],[3,"item","deleteEvent",4,"ngIf"],[3,"item","editEvent"],[3,"item","deleteEvent"],["mat-header-row",""],["mat-row",""]],template:function(i,l){1&i&&(e.TgZ(0,"div",0)(1,"table",1),e.ynx(2,2),e.YNc(3,at,2,0,"th",3),e.YNc(4,lt,2,1,"td",4),e.BQk(),e.ynx(5,5),e.YNc(6,ct,2,0,"th",3),e.YNc(7,rt,2,1,"td",4),e.BQk(),e.ynx(8,6),e.YNc(9,st,2,0,"th",3),e.YNc(10,mt,2,1,"td",4),e.BQk(),e.ynx(11,7),e.YNc(12,dt,2,0,"th",3),e.YNc(13,pt,2,1,"td",4),e.BQk(),e.ynx(14,8),e.YNc(15,ut,2,0,"th",3),e.YNc(16,ht,2,1,"td",4),e.BQk(),e.ynx(17,9),e.YNc(18,_t,2,0,"th",3),e.YNc(19,vt,3,2,"td",10),e.BQk(),e.ynx(20,11),e.YNc(21,xt,2,0,"th",3),e.YNc(22,Zt,2,1,"td",12),e.BQk(),e.ynx(23,13),e.YNc(24,Tt,2,0,"th",3),e.YNc(25,wt,2,1,"td",12),e.BQk(),e.ynx(26,14),e.YNc(27,Ct,2,0,"th",3),e.YNc(28,yt,2,1,"td",12),e.BQk(),e.ynx(29,15),e.YNc(30,Dt,6,0,"th",3),e.YNc(31,At,4,3,"td",16),e.BQk(),e.ynx(32,17),e.YNc(33,Vt,1,0,"th",18),e.YNc(34,Ft,4,3,"td",19),e.BQk(),e.YNc(35,Et,1,0,"tr",20),e.YNc(36,Ut,1,0,"tr",21),e.qZA(),e._UZ(37,"mat-paginator",22,23),e.qZA(),e.TgZ(39,"div",24)(40,"div",25)(41,"app-server-pagination",26),e.NdJ("loadMore",function(){return l.more()}),e.qZA()()()),2&i&&(e.xp6(1),e.Q6J("dataSource",l.vehicleList),e.xp6(34),e.Q6J("matHeaderRowDef",l.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",l.displayedColumns),e.xp6(1),e.Q6J("pageSizeOptions",e.DdM(6,Jt)),e.xp6(4),e.Q6J("loaded",l.vehicleList.data.length)("count",l.count))},dependencies:[g.O5,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,z.NW,j.H,Y.b,ot.p,M.R]}),t})();const Qt=["vehicleImport"];function Yt(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"app-vehicle-search-filter",3),e.NdJ("onSearchChange",function(i){e.CHM(o);const l=e.oxw();return e.KtG(l.changeSearchData(i))})("onSearch",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.getList())}),e.qZA()}if(2&t){const o=e.oxw();e.Q6J("searchData",o.searchData)}}function kt(t,a){1&t&&(e.TgZ(0,"span"),e._uU(1,"Document"),e.qZA())}function Mt(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"app-import-button",10),e.NdJ("importEvent",function(){e.CHM(o);const i=e.oxw(2);return e.KtG(i.importVehicle())}),e.qZA()}}function Ot(t,a){1&t&&e._UZ(0,"input",11,12)}function Rt(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"app-add-button",13),e.NdJ("addEvent",function(){e.CHM(o);const i=e.oxw(2);return e.KtG(i.addVehicle())}),e.qZA()}if(2&t){const o=e.oxw(2);e.Q6J("ngClass",0==o.allowImport?"offset-10":"offset-0")}}function Gt(t,a){if(1&t&&(e.TgZ(0,"div",4)(1,"a",5),e.YNc(2,kt,2,0,"span",6),e.qZA(),e.YNc(3,Mt,1,0,"app-import-button",7),e.YNc(4,Ot,2,0,"input",8),e.YNc(5,Rt,1,1,"app-add-button",9),e.qZA()),2&t){const o=e.oxw();e.xp6(2),e.Q6J("ngIf",o.viewVehicleDoc),e.xp6(1),e.Q6J("ngIf",o.allowImport),e.xp6(1),e.Q6J("ngIf",o.allowImport),e.xp6(1),e.Q6J("ngIf",o.allowAdd)}}function $t(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"app-vehicle-list",14),e.NdJ("moreEvent",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.getList())})("editEvent",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.editVehicle())})("deleteEvent",function(i){e.CHM(o);const l=e.oxw();return e.KtG(l.deleteVehicle(i))}),e.qZA()}if(2&t){const o=e.oxw();e.Q6J("vehicleList",o.dataSource)("count",o.count)}}let Ht=(()=>{const a=class{constructor(n,i,l){this.menuRoleService=n,this.vehicleService=i,this.dialog=l,this.isLoaded=!1,this.req=new X,this.eList=[],this.count=0,this.allowAdd=!1,this.allowImport=!1,this.viewVehicleDoc=!1}ngOnInit(){this.isLoaded=!1,this.sub=this.vehicleService.getVehicleSearchData().pipe((0,I.w)(n=>(this.searchData=n.item,this.isLoaded=!0,this.dataSource=new u.by(this.eList),this.req.pagination.pageSize=10,this.allowAdd=this.menuRoleService.isMenuRoleAuthorizedSingle(T.w.Fleet,w.k.add),this.allowImport=this.menuRoleService.isMenuRoleAuthorizedSingle(T.w.Fleet,w.k.import),this.viewVehicleDoc=this.menuRoleService.isMenuRoleAuthorizedSingle(T.w.VehicleDoc,w.k.view),this.vehicleService.getVehicleList(this.req)))).subscribe(n=>{this.update(n)})}ngAfterViewInit(){}changeSearchData(n){console.log(n),this.eList=[],this.dataSource=new u.by(this.eList),this.req.searchKey=n.searchKey,this.req.makeId=""!=n.makeId?n.makeId:null,this.req.modelId=""!=n.modelId?n.modelId:null,this.req.ownerCompanyId=""!=n.companyId?n.companyId:null,this.req.pagination.pageNumber=1}refreshList(){this.eList=[],this.dataSource=new u.by(this.eList),this.req.pagination.pageNumber=1,this.getList()}update(n){n?.response?.status==C.s.success&&(this.eList.push.apply(this.eList,n.list),this.dataSource=new u.by(this.eList),this.count=n.totalRecords,n.list.length>0&&(this.req.pagination.pageNumber+=1))}getList(){this.sub=this.vehicleService.getVehicleList(this.req).subscribe(n=>{this.update(n)})}addVehicle(){this.dialog.open(_e,{data:null,width:"85%",maxHeight:"auto"}).afterClosed().subscribe(i=>{1==i&&this.refreshList()})}editVehicle(){this.refreshList()}deleteVehicle(n){confirm(F.J.confirmDelete(n.code))&&(this.sub=this.vehicleService.deleteVehicle(n.id).subscribe(i=>{i?.status==C.s.success?this.refreshList():alert(i?.message)}))}importVehicle(){}ngOnDestroy(){this.sub?.unsubscribe(),this.importSub?.unsubscribe()}};let t=a;return a.\u0275fac=function(i){return new(i||a)(e.Y36(q.K),e.Y36(b),e.Y36(x.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-vehicle"]],viewQuery:function(i,l){if(1&i&&e.Gf(Qt,5),2&i){let r;e.iGM(r=e.CRH())&&(l.vehicleImport=r.first)}},decls:3,vars:3,consts:[[3,"searchData","onSearchChange","onSearch",4,"ngIf"],["class","row ps-3",4,"ngIf"],[3,"vehicleList","count","moreEvent","editEvent","deleteEvent",4,"ngIf"],[3,"searchData","onSearchChange","onSearch"],[1,"row","ps-3"],["mat-button","","routerLink","/vehicle/doc","routerLinkActive","active",1,"nav-link","col-1"],[4,"ngIf"],["class","col-1 offset-9",3,"importEvent",4,"ngIf"],["type","file","id","vehicleImport","name","vehicleImport","accept","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","style","display: none;",4,"ngIf"],["class","col-1",3,"ngClass","addEvent",4,"ngIf"],[1,"col-1","offset-9",3,"importEvent"],["type","file","id","vehicleImport","name","vehicleImport","accept","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",2,"display","none"],["vehicleImport",""],[1,"col-1",3,"ngClass","addEvent"],[3,"vehicleList","count","moreEvent","editEvent","deleteEvent"]],template:function(i,l){1&i&&(e.YNc(0,Yt,1,1,"app-vehicle-search-filter",0),e.YNc(1,Gt,6,4,"div",1),e.YNc(2,$t,1,2,"app-vehicle-list",2)),2&i&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",(l.allowAdd||l.allowImport||l.viewVehicleDoc)&&l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[g.mk,g.O5,N.zs,fe.L,ge.x,D.rH,D.Od,Te,St]}),t})();class Kt extends R.G{}function Pt(t,a){if(1&t&&(e.TgZ(0,"mat-option",15),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}function Bt(t,a){if(1&t&&(e.TgZ(0,"mat-option",15),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.Q6J("value",o.id),e.xp6(1),e.Oqu(o.name)}}let zt=(()=>{const a=class{constructor(){this.onSearchChange=new Z.x,this.onSearch=new Z.x}ngOnInit(){this.filterForm=new c.cw({searchKey:new c.NI(""),docTypeId:new c.NI(""),mode:new c.NI(4,[c.kI.required]),expiryDays:new c.NI(null)}),this.valueChangeSub=this.filterForm.valueChanges.subscribe(n=>{this.onSearchChange.next(n)})}search(){this.onSearch.next()}resetFilter(){this.filterForm.patchValue({searchKey:"",docTypeId:"",mode:4,expiryDays:null})}ngOnDestroy(){this.valueChangeSub.unsubscribe()}};let t=a;return a.\u0275fac=function(i){return new(i||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-vehicle-doc-search-filter"]],inputs:{searchData:"searchData"},outputs:{onSearchChange:"onSearchChange",onSearch:"onSearch"},decls:29,vars:3,consts:[[1,"mt-4",3,"formGroup","ngSubmit"],[1,"row","form-group"],["type","button","mat-button","","color","primary",1,"col-1","offset-3","mt-2",3,"click"],["appearance","outline","floatLabel","always",1,"form-field","col-1"],["type","number","placeholder","","matInput","","formControlName","expiryDays"],[1,"form-field","col-2"],["formControlName","docTypeId"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","mode"],["appearance","outline","floatLabel","always",1,"form-field","col-2"],["type","search","placeholder","","matInput","","formControlName","searchKey"],[1,"col-1"],["type","submit","mat-raised-button","","color","primary",1,"col-12","offset-0","mt-2"],[1,"material-icons"],[3,"value"]],template:function(i,l){1&i&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return l.search()}),e.TgZ(1,"div",1)(2,"button",2),e.NdJ("click",function(){return l.resetFilter()}),e._uU(3,"Reset"),e.qZA(),e.TgZ(4,"mat-form-field",3)(5,"mat-label"),e._uU(6,"Expire In"),e.qZA(),e._UZ(7,"input",4),e.qZA(),e.TgZ(8,"mat-form-field",5)(9,"mat-label"),e._uU(10,"Doc Type"),e.qZA(),e.TgZ(11,"mat-select",6)(12,"mat-option",7),e._uU(13,"All"),e.qZA(),e.YNc(14,Pt,2,2,"mat-option",8),e.qZA()(),e.TgZ(15,"mat-form-field",5)(16,"mat-label"),e._uU(17,"Mode"),e.qZA(),e.TgZ(18,"mat-select",9),e.YNc(19,Bt,2,2,"mat-option",8),e.qZA()(),e.TgZ(20,"mat-form-field",10)(21,"mat-label"),e._uU(22,"Search"),e.qZA(),e._UZ(23,"input",11),e.qZA(),e.TgZ(24,"div",12)(25,"button",13)(26,"i",14),e._uU(27,"search"),e.qZA(),e._uU(28," Search"),e.qZA()()()()),2&i&&(e.Q6J("formGroup",l.filterForm),e.xp6(14),e.Q6J("ngForOf",l.searchData.docTypeList),e.xp6(5),e.Q6J("ngForOf",l.searchData.searchModeList))},dependencies:[g.sg,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.sg,c.u,v.KE,v.hX,A.Nt,N.lW,V.gD,L.ey]}),t})();var jt=m(5894);const Xt=["page"];function Wt(t,a){1&t&&(e.TgZ(0,"th",21),e._uU(1," DocType "),e.qZA())}function ei(t,a){1&t&&(e.TgZ(0,"span",24)(1,"i",25),e._uU(2,"attachment"),e.qZA()())}function ti(t,a){if(1&t&&(e.TgZ(0,"td",22),e._uU(1),e.YNc(2,ei,3,0,"span",23),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.hij(" ",o.documentType.name," "),e.xp6(1),e.Q6J("ngIf",null!=o.fileName)}}function ii(t,a){1&t&&(e.TgZ(0,"th",21),e._uU(1," Identifier "),e.qZA())}function oi(t,a){if(1&t&&(e.TgZ(0,"td",22),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.hij(" ",o.identifier," ")}}function ni(t,a){1&t&&(e.TgZ(0,"th",21),e._uU(1," Expiry (Days) "),e.qZA())}function ai(t,a){if(1&t&&(e.TgZ(0,"td",22),e._uU(1),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.AsE(" ",o.expiryDate," (",o.expiryDays,") ")}}function li(t,a){1&t&&(e.TgZ(0,"th",21),e._uU(1," Code "),e.qZA())}function ci(t,a){if(1&t&&(e.TgZ(0,"td",22)(1,"span",26),e._uU(2),e.qZA()()),2&t){const o=a.$implicit;e.xp6(2),e.Oqu(o.vehicle.code)}}function ri(t,a){1&t&&(e.TgZ(0,"th",21),e._uU(1," PlateNumber "),e.qZA())}function si(t,a){if(1&t&&(e.TgZ(0,"td",22)(1,"span",26),e._uU(2),e.qZA()()),2&t){const o=a.$implicit;e.xp6(2),e.Oqu(o.vehicle.plateNumber)}}function mi(t,a){1&t&&(e.TgZ(0,"th",21),e._uU(1," Model "),e.qZA())}function di(t,a){if(1&t&&(e.TgZ(0,"td",22)(1,"span",26),e._uU(2),e.qZA()()),2&t){const o=a.$implicit;e.xp6(2),e.AsE("",o.vehicle.make," ",o.vehicle.model,"")}}function pi(t,a){1&t&&(e.TgZ(0,"th",21),e._uU(1," Status "),e.qZA())}function ui(t,a){1&t&&(e.TgZ(0,"span",30),e._uU(1,"Valid"),e.qZA())}function hi(t,a){1&t&&(e.TgZ(0,"span",31),e._uU(1,"Expired"),e.qZA())}function _i(t,a){1&t&&(e.TgZ(0,"span",32),e._uU(1,"Near Expiry"),e.qZA())}function fi(t,a){if(1&t&&(e.TgZ(0,"td",22),e.YNc(1,ui,2,0,"span",27),e.YNc(2,hi,2,0,"span",28),e.YNc(3,_i,2,0,"span",29),e.qZA()),2&t){const o=a.$implicit;e.xp6(1),e.Q6J("ngIf",1==o.valid),e.xp6(1),e.Q6J("ngIf",1==o.expired),e.xp6(1),e.Q6J("ngIf",1==o.nearExpiry)}}function gi(t,a){1&t&&e._UZ(0,"th",33)}function vi(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"app-view-action-icon",38),e.NdJ("viewEvent",function(i){e.CHM(o);const l=e.oxw(2);return e.KtG(l.viewDoc(i))}),e.qZA()}if(2&t){const o=e.oxw().$implicit;e.Q6J("item",o)}}function xi(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"app-download-action-icon",39),e.NdJ("downloadEvent",function(i){e.CHM(o);const l=e.oxw(2);return e.KtG(l.downloadDoc(i))}),e.qZA()}if(2&t){const o=e.oxw().$implicit;e.Q6J("item",o)}}function Zi(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"app-action-icon",40),e.NdJ("actionEvent",function(i){e.CHM(o);const l=e.oxw(2);return e.KtG(l.removeDocFile(i))}),e._uU(1,"attach_file_off"),e.qZA()}if(2&t){const o=e.oxw().$implicit;e.Q6J("item",o)}}function Ti(t,a){if(1&t&&(e.TgZ(0,"td",34),e.YNc(1,vi,1,1,"app-view-action-icon",35),e.YNc(2,xi,1,1,"app-download-action-icon",36),e.YNc(3,Zi,2,1,"app-action-icon",37),e.qZA()),2&t){const o=a.$implicit,n=e.oxw();e.xp6(1),e.Q6J("ngIf",null!=o.fileName&&n.allowExport),e.xp6(1),e.Q6J("ngIf",null!=o.fileName&&n.allowExport),e.xp6(1),e.Q6J("ngIf",null!=o.fileName&&n.allowDelete)}}function wi(t,a){1&t&&e._UZ(0,"tr",41)}function Ci(t,a){1&t&&e._UZ(0,"tr",42)}const yi=function(){return[10,20,50]};let Di=(()=>{const a=class{constructor(n,i){this.menuRoleService=n,this.dialog=i,this.moreEvent=new Z.x,this.displayedColumns=["docType","identifier","expiryDate","code","plateNumber","makeModel","status","manage"],this.baseUrl=(0,f.S)(),this.allowDelete=!1,this.allowExport=!1,this.viewDocEvent=new Z.x,this.downloadDocEvent=new Z.x,this.removeDocFileEvent=new Z.x}ngOnInit(){this.allowDelete=this.menuRoleService.isMenuRoleAuthorizedSingle(T.w.VehicleDoc,w.k.delete),this.allowExport=this.menuRoleService.isMenuRoleAuthorizedSingle(T.w.VehicleDoc,w.k.export)}ngOnChanges(n){this.vehicleDocList.paginator=this.paginator}ngAfterViewInit(){this.vehicleDocList.paginator=this.paginator}more(){this.moreEvent.next(!0)}viewDoc(n){this.viewDocEvent.next(n)}downloadDoc(n){this.downloadDocEvent.next(n)}removeDocFile(n){this.removeDocFileEvent.next(n)}};let t=a;return a.\u0275fac=function(i){return new(i||a)(e.Y36(q.K),e.Y36(x.uw))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-vehicle-doc-list"]],viewQuery:function(i,l){if(1&i&&e.Gf(Xt,5),2&i){let r;e.iGM(r=e.CRH())&&(l.paginator=r.first)}},inputs:{vehicleDocList:"vehicleDocList",count:"count"},outputs:{moreEvent:"moreEvent",viewDocEvent:"viewDocEvent",downloadDocEvent:"downloadDocEvent",removeDocFileEvent:"removeDocFileEvent"},features:[e.TTD],decls:33,vars:7,consts:[[1,"mat-elevation-z8"],["mat-table","",3,"dataSource"],["matColumnDef","docType"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","col",4,"matCellDef"],["matColumnDef","identifier"],["matColumnDef","expiryDate"],["matColumnDef","code"],["matColumnDef","plateNumber"],["matColumnDef","makeModel"],["matColumnDef","status"],["matColumnDef","manage"],["mat-header-cell","","class","text-end",4,"matHeaderCellDef"],["mat-cell","","class","col text-end",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","",3,"pageSizeOptions"],["page",""],[1,"row"],[1,"col-6"],[3,"loaded","count","loadMore"],["mat-header-cell",""],["mat-cell","",1,"col"],["class","ms-3",4,"ngIf"],[1,"ms-3"],[1,"material-icons","text-success"],[1,"ms-2"],["class","bg-success p-2 text-light rounded-pill",4,"ngIf"],["class","bg-warn p-2 text-light rounded-pill",4,"ngIf"],["class","bg-accent p-2 text-dark rounded-pill",4,"ngIf"],[1,"bg-success","p-2","text-light","rounded-pill"],[1,"bg-warn","p-2","text-light","rounded-pill"],[1,"bg-accent","p-2","text-dark","rounded-pill"],["mat-header-cell","",1,"text-end"],["mat-cell","",1,"col","text-end"],[3,"item","viewEvent",4,"ngIf"],[3,"item","downloadEvent",4,"ngIf"],["color","accent",3,"item","actionEvent",4,"ngIf"],[3,"item","viewEvent"],[3,"item","downloadEvent"],["color","accent",3,"item","actionEvent"],["mat-header-row",""],["mat-row",""]],template:function(i,l){1&i&&(e.TgZ(0,"div",0)(1,"table",1),e.ynx(2,2),e.YNc(3,Wt,2,0,"th",3),e.YNc(4,ti,3,2,"td",4),e.BQk(),e.ynx(5,5),e.YNc(6,ii,2,0,"th",3),e.YNc(7,oi,2,1,"td",4),e.BQk(),e.ynx(8,6),e.YNc(9,ni,2,0,"th",3),e.YNc(10,ai,2,2,"td",4),e.BQk(),e.ynx(11,7),e.YNc(12,li,2,0,"th",3),e.YNc(13,ci,3,1,"td",4),e.BQk(),e.ynx(14,8),e.YNc(15,ri,2,0,"th",3),e.YNc(16,si,3,1,"td",4),e.BQk(),e.ynx(17,9),e.YNc(18,mi,2,0,"th",3),e.YNc(19,di,3,2,"td",4),e.BQk(),e.ynx(20,10),e.YNc(21,pi,2,0,"th",3),e.YNc(22,fi,4,3,"td",4),e.BQk(),e.ynx(23,11),e.YNc(24,gi,1,0,"th",12),e.YNc(25,Ti,4,3,"td",13),e.BQk(),e.YNc(26,wi,1,0,"tr",14),e.YNc(27,Ci,1,0,"tr",15),e.qZA(),e._UZ(28,"mat-paginator",16,17),e.qZA(),e.TgZ(30,"div",18)(31,"div",19)(32,"app-server-pagination",20),e.NdJ("loadMore",function(){return l.more()}),e.qZA()()()),2&i&&(e.xp6(1),e.Q6J("dataSource",l.vehicleDocList),e.xp6(25),e.Q6J("matHeaderRowDef",l.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",l.displayedColumns),e.xp6(1),e.Q6J("pageSizeOptions",e.DdM(6,yi)),e.xp6(4),e.Q6J("loaded",l.vehicleDocList.data.length)("count",l.count))},dependencies:[g.O5,u.BZ,u.fO,u.as,u.w1,u.Dz,u.nj,u.ge,u.ev,u.XQ,u.Gk,z.NW,j.H,M.R,B.e,jt.m]}),t})();function Ii(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"app-vehicle-doc-search-filter",3),e.NdJ("onSearchChange",function(i){e.CHM(o);const l=e.oxw();return e.KtG(l.changeSearchData(i))})("onSearch",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.getList())}),e.qZA()}if(2&t){const o=e.oxw();e.Q6J("searchData",o.searchData)}}function Ni(t,a){1&t&&(e.TgZ(0,"div",4)(1,"a",5),e._uU(2," Back to Vehicle "),e.qZA()())}function bi(t,a){if(1&t){const o=e.EpF();e.TgZ(0,"app-vehicle-doc-list",6),e.NdJ("moreEvent",function(){e.CHM(o);const i=e.oxw();return e.KtG(i.getList())})("viewDocEvent",function(i){e.CHM(o);const l=e.oxw();return e.KtG(l.viewDoc(i))})("downloadDocEvent",function(i){e.CHM(o);const l=e.oxw();return e.KtG(l.downloadDoc(i))})("removeDocFileEvent",function(i){e.CHM(o);const l=e.oxw();return e.KtG(l.removeDocFile(i))}),e.qZA()}if(2&t){const o=e.oxw();e.Q6J("vehicleDocList",o.dataSource)("count",o.count)}}const Ai=[{path:"",component:Ht},{path:"doc",component:(()=>{const a=class{constructor(n,i,l,r){this.vehicleDocService=n,this.vehicleService=i,this.fileService=l,this.menuRoleService=r,this.isLoaded=!1,this.req=new Kt,this.eList=[],this.count=0,this.viewFleet=!1}ngOnInit(){this.isLoaded=!1,this.sub=this.vehicleDocService.getVehicleDocSearchData().pipe((0,I.w)(n=>(this.searchData=n.item,this.isLoaded=!0,this.dataSource=new u.by(this.eList),this.req.pagination.pageSize=10,this.vehicleDocService.getVehicleDocList(this.req)))).subscribe(n=>{this.viewFleet=this.menuRoleService.isMenuRoleAuthorizedSingle(T.w.Fleet,w.k.view),this.update(n)})}ngAfterViewInit(){}changeSearchData(n){console.log(n),this.eList=[],this.dataSource=new u.by(this.eList),this.req.searchKey=n.searchKey,this.req.docTypeId=""!=n.docTypeId?n.docTypeId:null,this.req.mode=n.mode,this.req.expiryDays=n.expiryDays,this.req.pagination.pageNumber=1}refreshList(){this.eList=[],this.dataSource=new u.by(this.eList),this.req.pagination.pageNumber=1,this.getList()}update(n){n?.response?.status==C.s.success&&(this.eList.push.apply(this.eList,n.list),this.dataSource=new u.by(this.eList),this.count=n.totalRecords,n.list.length>0&&(this.req.pagination.pageNumber+=1))}getList(){this.sub=this.vehicleDocService.getVehicleDocList(this.req).subscribe(n=>{this.update(n)})}viewDoc(n){var i=this;this.sub=this.vehicleDocService.exportVehicleDoc(n.id).subscribe(function(){var l=(0,J.Z)(function*(r){i.fileService.viewFile(r)});return function(r){return l.apply(this,arguments)}}())}downloadDoc(n){var i=this;let l=this.searchData.docTypeList.find(s=>s.id==n.documentType.id),r=`${n.vehicle.code}_${l.code}`;null!=n.identifier&&(r=`${r}_${n.identifier}`),this.sub=this.vehicleDocService.exportVehicleDoc(n.id).subscribe(function(){var s=(0,J.Z)(function*(d){i.fileService.downloadFile(d,r)});return function(d){return s.apply(this,arguments)}}())}removeDocFile(n){confirm(F.J.areYouSureTo)&&(this.sub=this.vehicleDocService.removeVehicleDocFile(n.id).subscribe(i=>{this.refreshList()}))}ngOnDestroy(){this.sub?.unsubscribe()}};let t=a;return a.\u0275fac=function(i){return new(i||a)(e.Y36(U),e.Y36(b),e.Y36(P.I),e.Y36(q.K))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-vehicle-doc"]],decls:3,vars:3,consts:[[3,"searchData","onSearchChange","onSearch",4,"ngIf"],["class","row my-2 ps-3",4,"ngIf"],[3,"vehicleDocList","count","moreEvent","viewDocEvent","downloadDocEvent","removeDocFileEvent",4,"ngIf"],[3,"searchData","onSearchChange","onSearch"],[1,"row","my-2","ps-3"],["mat-button","","routerLink","/vehicle","routerLinkActive","active",1,"nav-link","col-1"],[3,"vehicleDocList","count","moreEvent","viewDocEvent","downloadDocEvent","removeDocFileEvent"]],template:function(i,l){1&i&&(e.YNc(0,Ii,1,1,"app-vehicle-doc-search-filter",0),e.YNc(1,Ni,3,0,"div",1),e.YNc(2,bi,1,2,"app-vehicle-doc-list",2)),2&i&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.viewFleet),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[g.O5,N.zs,D.rH,D.Od,zt,Di]}),t})(),pathMatch:"full"}];let Vi=(()=>{const a=class{};let t=a;return a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[D.Bz.forChild(Ai)]}),t})();var Li=m(529),qi=m(3214),Fi=m(1260);let Ei=(()=>{const a=class{};let t=a;return a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[g.ez,Vi,c.u5,c.UX,Li.JF,qi._,Fi.m,D.Bz]}),t})()}}]);