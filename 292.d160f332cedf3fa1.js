"use strict";(self.webpackChunkshams_hr_web_app=self.webpackChunkshams_hr_web_app||[]).push([[292],{5630:(ce,O,d)=>{d.r(O),d.d(O,{FleetModule:()=>xo});var f=d(6895),I=d(1635),m=d(7155),N=d(3900),J=d(6212);class U extends J.G{}var x=d(9172),A=d(5311),v=d(1654),T=d(673),s=d(4006),u=d(5412),R=d(9646),W=d(4128);class re{}var e=d(4650),L=d(8112),B=d(5332),Q=d(3104),y=d(5659),h=d(9549),b=d(4144),S=d(4859),F=d(4385),V=d(3238),g=d(9602),P=d(2833),k=d(4682),Y=d(1837),ee=d(1234),E=d(2043);const de=["docUpload"],me=["docName"];function pe(t,o){1&t&&(e.TgZ(0,"app-form-heading"),e._uU(1," Add Vehicle\n"),e.qZA())}function ue(t,o){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function he(t,o){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function _e(t,o){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a),e.xp6(1),e.Oqu(a)}}function fe(t,o){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a),e.xp6(1),e.Oqu(a)}}function ge(t,o){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function ve(t,o){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function Ze(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"button",46),e.NdJ("click",function(){e.CHM(a);const n=e.oxw().index,l=e.oxw(2);return e.KtG(l.onDocRemove(n))}),e._uU(1,"Remove File"),e.qZA()}}function we(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"div",29)(1,"div",6)(2,"mat-form-field",7)(3,"mat-label"),e._uU(4,"Doc Type"),e.qZA(),e.TgZ(5,"mat-select",30,31),e.NdJ("selectionChange",function(n){const c=e.CHM(a).index,r=e.oxw(2);return e.KtG(r.onDocumentTypeChange(n,c))}),e.YNc(7,ve,2,2,"mat-option",12),e.qZA()(),e.TgZ(8,"mat-form-field",7)(9,"mat-label"),e._uU(10,"Identifier"),e.qZA(),e._UZ(11,"input",32),e.qZA(),e.TgZ(12,"mat-form-field",33)(13,"mat-label"),e._uU(14,"Expiry"),e.qZA(),e._UZ(15,"input",34)(16,"mat-datepicker-toggle",35)(17,"mat-datepicker",null,36),e.qZA(),e.TgZ(19,"div",37)(20,"button",38),e.NdJ("click",function(){const l=e.CHM(a).index,c=e.oxw(2);return e.KtG(c.onDocSelect(l))}),e._uU(21,"Select File"),e.qZA(),e._UZ(22,"input",39,40)(24,"label",41,42),e.YNc(26,Ze,2,0,"button",43),e.qZA(),e.TgZ(27,"div",44)(28,"app-delete-action-icon",45),e.NdJ("deleteEvent",function(){const l=e.CHM(a).index,c=e.oxw(2);return e.KtG(c.deleteDocumentItem(l))}),e.qZA()()()()}if(2&t){const a=o.$implicit,i=o.index,n=e.MAs(6),l=e.MAs(18),c=e.MAs(25),r=e.oxw(2);e.Q6J("formGroupName",i),e.xp6(7),e.Q6J("ngForOf",r.manageData.documentTypeList),e.xp6(8),e.Q6J("matDatepicker",l),e.xp6(1),e.Q6J("for",l),e.xp6(4),e.Q6J("disabled",null==n.value),e.xp6(6),e.Q6J("ngIf",""!=c.textContent),e.xp6(2),e.Q6J("item",a)}}function Te(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"div",2)(1,"form",3),e.NdJ("submit",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.addVehicle())}),e.TgZ(2,"div",4)(3,"div",5)(4,"div",6)(5,"mat-form-field",7)(6,"mat-label"),e._uU(7,"Code"),e.qZA(),e._UZ(8,"input",8),e.qZA(),e.TgZ(9,"mat-form-field",7)(10,"mat-label"),e._uU(11,"Plate Number"),e.qZA(),e._UZ(12,"input",9),e.qZA(),e.TgZ(13,"mat-form-field",10)(14,"mat-label"),e._uU(15,"Make"),e.qZA(),e.TgZ(16,"mat-select",11),e.NdJ("selectionChange",function(n){e.CHM(a);const l=e.oxw();return e.KtG(l.onMakeChange(n))}),e.YNc(17,ue,2,2,"mat-option",12),e.qZA()(),e.TgZ(18,"mat-form-field",10)(19,"mat-label"),e._uU(20,"Model"),e.qZA(),e.TgZ(21,"mat-select",13),e.YNc(22,he,2,2,"mat-option",12),e.qZA()()(),e.TgZ(23,"div",6)(24,"mat-form-field",7)(25,"mat-label"),e._uU(26,"Year"),e.qZA(),e._UZ(27,"input",14),e.qZA(),e.TgZ(28,"mat-form-field",7)(29,"mat-label"),e._uU(30,"Wheel"),e.qZA(),e.TgZ(31,"mat-select",15),e._UZ(32,"mat-option"),e.YNc(33,_e,2,2,"mat-option",12),e.qZA()(),e.TgZ(34,"mat-form-field",7)(35,"mat-label"),e._uU(36,"Fuel"),e.qZA(),e.TgZ(37,"mat-select",16),e._UZ(38,"mat-option"),e.YNc(39,fe,2,2,"mat-option",12),e.qZA()(),e.TgZ(40,"mat-form-field",7)(41,"mat-label"),e._uU(42,"Color"),e.qZA(),e._UZ(43,"input",17),e.qZA(),e.TgZ(44,"mat-form-field",10)(45,"mat-label"),e._uU(46,"Owner"),e.qZA(),e.TgZ(47,"mat-select",18),e.YNc(48,ge,2,2,"mat-option",12),e.qZA()()()()(),e.TgZ(49,"div",4)(50,"div",5)(51,"div",19)(52,"div",20)(53,"div",21)(54,"label"),e._uU(55,"Document"),e.qZA()(),e.TgZ(56,"div",22)(57,"app-add-action-icon",23),e.NdJ("addEvent",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.addDocumentItemForm())}),e.qZA()()(),e.TgZ(58,"div",24),e.YNc(59,we,29,7,"div",25),e.qZA()()()(),e.TgZ(60,"div",4)(61,"app-crud-reset-button",26),e.NdJ("resetEvent",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.reset())}),e.qZA(),e._UZ(62,"app-crud-add-button",27),e.qZA()()()}if(2&t){const a=e.oxw();e.xp6(1),e.Q6J("formGroup",a.manageForm),e.xp6(16),e.Q6J("ngForOf",a.manageData.makeList),e.xp6(5),e.Q6J("ngForOf",a.modelListFiltered),e.xp6(11),e.Q6J("ngForOf",a.manageData.wheelTypeList),e.xp6(6),e.Q6J("ngForOf",a.manageData.fuelTypeList),e.xp6(9),e.Q6J("ngForOf",a.manageData.ownerList),e.xp6(11),e.Q6J("ngForOf",a.documentListControls),e.xp6(3),e.Q6J("disabled",a.isProcessing)}}let xe=(()=>{const o=class{constructor(i,n,l,c,r,p,_){this.dialogRef=i,this.vehicleService=n,this.employeeService=l,this.vehicleDocService=c,this.ds=r,this.renderer=p,this.data=_,this.isLoaded=!1,this.modelListFiltered=[],this.employeeList=[],this.isProcessing=!1}get documentListControls(){return this.manageForm.get("documentList").controls}ngOnInit(){this.manageForm=new s.cw({code:new s.NI("VHC-",[s.kI.required]),plateNumber:new s.NI(null,[s.kI.required]),makeId:new s.NI(null,[s.kI.required]),modelId:new s.NI(null,[s.kI.required]),year:new s.NI(null),ownerId:new s.NI(null,[s.kI.required]),wheelType:new s.NI("Four"),fuelType:new s.NI("Petrol"),color:new s.NI(null),documentList:new s.Oe([])}),this.isLoaded=!1,this.sub=this.vehicleService.getVehicleManageData().subscribe(i=>{this.manageData=i.item,this.addDefaultDoc("Mulkia"),this.isLoaded=!0})}addDefaultDoc(i){let n=this.manageData.documentTypeList.find(l=>l.name==i)?.id;this.manageForm.get("documentList").push(new s.cw({documentTypeId:new s.NI(n,s.kI.required),identifier:new s.NI(null,s.kI.required),expiryDate:new s.NI(null,s.kI.required),file:new s.NI(null)}))}onMakeChange(i){this.modelListFiltered=this.manageData.modelList.filter(n=>n.make.id==this.manageForm.value.makeId)??[],this.manageForm.patchValue({modelId:""})}onDocumentTypeChange(i,n){let l=this.manageData.documentTypeList.find(r=>r.id==i.value);var c=this.manageForm.get("documentList").at(n);c.get("identifier").disabled&&c.get("identifier").enable(),c.get("expiryDate").disabled&&c.get("expiryDate").enable(),c.patchValue({identifier:null,expiryDate:null,file:null}),this.onDocRemove(n),l.isIdentifier?c.get("identifier")?.setValidators(s.kI.required):c.get("identifier")?.removeValidators(s.kI.required),l.isExpiry?c.get("expiryDate")?.setValidators(s.kI.required):c.get("expiryDate")?.removeValidators(s.kI.required),c.get("identifier").markAsUntouched(),c.get("expiryDate").markAsUntouched(),c.get("identifier").updateValueAndValidity(),c.get("expiryDate").updateValueAndValidity()}addDocumentItemForm(){this.manageForm.get("documentList").push(new s.cw({documentTypeId:new s.NI(null,s.kI.required),identifier:new s.NI({value:null,disabled:!0}),expiryDate:new s.NI({value:null,disabled:!0}),file:new s.NI(null)}))}deleteDocumentItem(i){this.manageForm.get("documentList").removeAt(i)}onDocSelect(i){let n=this.manageForm.get("documentList").at(i),l=this.manageData.documentTypeList.find(r=>r.id==n.value.documentTypeId),c=this.docUpload.get(i).nativeElement;c.onchange=()=>{if(c.files&&c.files[0]){const r=c.files[0];if(l.contentLimitKb>0&&r.size>1e3*l.contentLimitKb)return c.value="",void alert(`Size max allowed ${l.contentLimitKb}kb exceeded`);let p=this.docName.get(i).nativeElement;this.renderer.setProperty(p,"textContent",r.name),n.patchValue({file:r})}},c.click()}onDocRemove(i){let n=this.manageForm.get("documentList").at(i);this.docUpload.get(i).nativeElement.value="";let c=this.docName.get(i).nativeElement;this.renderer.setProperty(c,"textContent",""),n.patchValue({file:null})}addVehicle(){if(!this.manageForm.valid)return void this.manageForm.markAllAsTouched();if(!confirm(A.J.areYouSureTo))return;let i=new re;i.code=this.manageForm.value.code,i.plateNumber=this.manageForm.value.plateNumber,i.makeId=this.manageForm.value.makeId,i.modelId=this.manageForm.value.modelId,i.year=this.manageForm.value.year,i.ownerId=this.manageForm.value.ownerId,i.wheelType=this.manageForm.value.wheelType,i.fuelType=this.manageForm.value.fuelType,i.color=this.manageForm.value.color;let n=this.validateDoc();""==n?(this.isProcessing=!0,this.sub=this.vehicleService.addVehicle(i).pipe((0,N.w)(l=>{if(l.response?.status!=T.s.success)return this.isProcessing=!1,alert(l.response?.message),(0,R.of)(null);let c=l.item?.id;const r=[];return this.manageForm.value.documentList.forEach(p=>{const _=new FormData;_.append("vehicleId",c),_.append("documentTypeId",p.documentTypeId),_.append("identifier",p.identifier),null!=p.expiryDate&&_.append("expiryDate",this.ds.formatToRequest(p.expiryDate)),_.append("doc",p.file),r.push(this.vehicleDocService.addVehicleDoc(_))}),0==r.length?(this.reset(),this.closeDialog(),(0,R.of)(null)):(0,W.D)(r)})).subscribe(l=>{this.isProcessing=!1,this.reset(),this.closeDialog()})):alert(`Error : ${n}`)}validateDoc(){let i=[],n="";if(this.manageForm.value.documentList.forEach(c=>{i.findIndex(p=>p.key.docId==c.documentTypeId)>=0?n=c.documentTypeId:i.push({key:{docId:c.documentTypeId},value:1})}),""!=n){var l=this.manageData.documentTypeList.find(c=>c.id==n)?.name;return`Duplicate doc ${l} found`}return""}reset(){for(this.manageForm.reset();this.manageForm.get("documentList").length>0;)this.manageForm.get("documentList").removeAt(0)}closeDialog(){this.dialogRef.close(!0)}ngOnDestroy(){this.sub?.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(u.so),e.Y36(L.f),e.Y36(B.G),e.Y36(Q.l),e.Y36(y.R),e.Y36(e.Qsj),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-vehicle"]],viewQuery:function(n,l){if(1&n&&(e.Gf(de,5),e.Gf(me,5)),2&n){let c;e.iGM(c=e.CRH())&&(l.docUpload=c),e.iGM(c=e.CRH())&&(l.docName=c)}},decls:2,vars:2,consts:[[4,"ngIf"],["mat-dialog-content","","class","row",4,"ngIf"],["mat-dialog-content","",1,"row"],[1,"my-2",3,"formGroup","submit"],[1,"row"],[1,"col-12"],[1,"row","form-group"],[1,"form-field","col-2"],["type","text","matInput","","formControlName","code"],["type","text","matInput","","formControlName","plateNumber"],[1,"form-field","col-4"],["formControlName","makeId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","modelId"],["type","number","matInput","","formControlName","year"],["formControlName","wheelType"],["formControlName","fuelType"],["type","text","matInput","","formControlName","color"],["formControlName","ownerId"],["formArrayName","documentList"],[1,"row","my-4"],[1,"col-2"],[1,"col-2","text-end"],[3,"addEvent"],[1,"mt-3"],["class","col-12 form-group",3,"formGroupName",4,"ngFor","ngForOf"],[1,"col-2",3,"resetEvent"],[1,"col-2","offset-8",3,"disabled"],[3,"value"],[1,"col-12","form-group",3,"formGroupName"],["formControlName","documentTypeId",3,"selectionChange"],["typeId",""],["type","text","matInput","","formControlName","identifier"],["appearance","outline",1,"col-2","form-field"],["matInput","","formControlName","expiryDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],[1,"col-5","mt-2"],["type","button","mat-button","","color","primary",1,"col-3",3,"disabled","click"],["type","file","accept","image/*,.pdf",2,"display","none"],["docUpload",""],[1,"col-6"],["docName",""],["type","button","mat-button","","color","primary","class","col-3",3,"click",4,"ngIf"],[1,"col-1","text-end","mt-2"],[3,"item","deleteEvent"],["type","button","mat-button","","color","primary",1,"col-3",3,"click"]],template:function(n,l){1&n&&(e.YNc(0,pe,2,0,"app-form-heading",0),e.YNc(1,Te,63,8,"div",1)),2&n&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[f.sg,f.O5,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,s.x0,s.CE,h.KE,h.hX,h.R9,b.Nt,S.lW,u.xY,F.gD,V.ey,g.Mq,g.hl,g.nW,P.L,k.X,Y.b,ee.E,E.H]}),t})();var q=d(1219),te=d(2696),Ce=d(3667),M=d(7770),Z=d(7579);function Ae(t,o){if(1&t&&(e.TgZ(0,"mat-option",15),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function De(t,o){if(1&t&&(e.TgZ(0,"mat-option",15),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function be(t,o){if(1&t&&(e.TgZ(0,"mat-option",15),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}let Ie=(()=>{const o=class{constructor(){this.onSearchChange=new Z.x,this.onSearch=new Z.x,this.modelListFiltered=[]}ngOnInit(){this.filterForm=new s.cw({searchKey:new s.NI(""),makeId:new s.NI(""),modelId:new s.NI(""),ownerId:new s.NI("")}),this.valueChangeSub=this.filterForm.valueChanges.subscribe(i=>{this.onSearchChange.next(i)})}search(){this.onSearch.next()}resetFilter(){this.filterForm.patchValue({searchKey:"",makeId:"",modelId:"",ownerId:""})}onMakeChange(i){this.modelListFiltered=this.searchData.modelList.filter(n=>n.make.id==this.filterForm.value.makeId)??[],this.filterForm.patchValue({modelId:""})}ngOnDestroy(){this.valueChangeSub.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-vehicle-search-filter"]],inputs:{searchData:"searchData"},outputs:{onSearchChange:"onSearchChange",onSearch:"onSearch"},decls:34,vars:4,consts:[[1,"mt-4",3,"formGroup","ngSubmit"],[1,"row","form-group"],["type","button","mat-button","","color","primary",1,"col-1","offset-1","mt-2",3,"click"],[1,"form-field","col-2"],["formControlName","makeId",3,"selectionChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","modelId"],[1,"form-field","col-3"],["formControlName","ownerId"],["appearance","outline","floatLabel","always",1,"form-field","col-2"],["type","search","placeholder","","matInput","","formControlName","searchKey"],[1,"col-1"],["type","submit","mat-raised-button","","color","primary",1,"col-12","offset-0","mt-2"],[1,"material-icons"],[3,"value"]],template:function(n,l){1&n&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return l.search()}),e.TgZ(1,"div",1)(2,"button",2),e.NdJ("click",function(){return l.resetFilter()}),e._uU(3,"Reset"),e.qZA(),e.TgZ(4,"mat-form-field",3)(5,"mat-label"),e._uU(6,"Make"),e.qZA(),e.TgZ(7,"mat-select",4),e.NdJ("selectionChange",function(r){return l.onMakeChange(r)}),e.TgZ(8,"mat-option",5),e._uU(9,"All"),e.qZA(),e.YNc(10,Ae,2,2,"mat-option",6),e.qZA()(),e.TgZ(11,"mat-form-field",3)(12,"mat-label"),e._uU(13,"Model"),e.qZA(),e.TgZ(14,"mat-select",7)(15,"mat-option",5),e._uU(16,"All"),e.qZA(),e.YNc(17,De,2,2,"mat-option",6),e.qZA()(),e.TgZ(18,"mat-form-field",8)(19,"mat-label"),e._uU(20,"Owner"),e.qZA(),e.TgZ(21,"mat-select",9)(22,"mat-option",5),e._uU(23,"All"),e.qZA(),e.YNc(24,be,2,2,"mat-option",6),e.qZA()(),e.TgZ(25,"mat-form-field",10)(26,"mat-label"),e._uU(27,"Search"),e.qZA(),e._UZ(28,"input",11),e.qZA(),e.TgZ(29,"div",12)(30,"button",13)(31,"i",14),e._uU(32,"search"),e.qZA(),e._uU(33," Search"),e.qZA()()()()),2&n&&(e.Q6J("formGroup",l.filterForm),e.xp6(10),e.Q6J("ngForOf",l.searchData.makeList),e.xp6(7),e.Q6J("ngForOf",l.modelListFiltered),e.xp6(7),e.Q6J("ngForOf",l.searchData.ownerList))},dependencies:[f.sg,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,h.KE,h.hX,b.Nt,S.lW,F.gD,V.ey]}),t})();var D=d(9057);class Ne{}class ye extends Ne{}class qe{}var ie=d(455),G=d(7786);const Le=["docUpload"],Fe=["docName"];function Ve(t,o){1&t&&(e.TgZ(0,"app-form-heading"),e._uU(1," Edit Vehicle\n"),e.qZA())}function Ee(t,o){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function Ue(t,o){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function Je(t,o){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a),e.xp6(1),e.Oqu(a)}}function Se(t,o){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a),e.xp6(1),e.Oqu(a)}}function Qe(t,o){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function Ye(t,o){if(1&t&&(e.TgZ(0,"mat-option",28),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function Oe(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"button",50),e.NdJ("click",function(){e.CHM(a);const n=e.oxw().index,l=e.oxw(2);return e.KtG(l.onDocSelect(n))}),e._uU(1,"Select File"),e.qZA()}if(2&t){e.oxw();const a=e.MAs(6);e.Q6J("disabled",null==a.value)}}function Re(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"button",51),e.NdJ("click",function(){e.CHM(a);const n=e.oxw().index,l=e.oxw(2);return e.KtG(l.onDocRemove(n))}),e._uU(1,"Remove File"),e.qZA()}}function ke(t,o){1&t&&(e.TgZ(0,"label"),e._uU(1,"Doc Uploaded"),e.qZA())}function Me(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"div",29)(1,"div",6)(2,"mat-form-field",7)(3,"mat-label"),e._uU(4,"Doc Type"),e.qZA(),e.TgZ(5,"mat-select",30,31),e.NdJ("selectionChange",function(n){const c=e.CHM(a).index,r=e.oxw(2);return e.KtG(r.onDocumentTypeChange(n,c))}),e.YNc(7,Ye,2,2,"mat-option",12),e.qZA()(),e.TgZ(8,"mat-form-field",7)(9,"mat-label"),e._uU(10,"Identifier"),e.qZA(),e._UZ(11,"input",32),e.qZA(),e.TgZ(12,"mat-form-field",33)(13,"mat-label"),e._uU(14,"Expiry"),e.qZA(),e._UZ(15,"input",34)(16,"mat-datepicker-toggle",35)(17,"mat-datepicker",null,36),e.qZA(),e._UZ(19,"input",37,38)(21,"input",39,40),e.TgZ(23,"div",41),e.YNc(24,Oe,2,1,"button",42),e._UZ(25,"input",43,44)(27,"label",45,46),e.YNc(29,Re,2,0,"button",47),e.YNc(30,ke,2,0,"label",0),e.qZA(),e.TgZ(31,"div",48)(32,"app-delete-action-icon",49),e.NdJ("deleteEvent",function(){const l=e.CHM(a).index,c=e.oxw(2);return e.KtG(c.deleteDocumentItem(l))}),e.qZA()()()()}if(2&t){const a=o.$implicit,i=o.index,n=e.MAs(18),l=e.MAs(20),c=e.MAs(22),r=e.MAs(28),p=e.oxw(2);e.Q6J("formGroupName",i),e.xp6(7),e.Q6J("ngForOf",p.manageData.documentTypeList),e.xp6(8),e.Q6J("matDatepicker",n),e.xp6(1),e.Q6J("for",n),e.xp6(8),e.Q6J("ngIf",0==l.value.length||0==c.value.length),e.xp6(5),e.Q6J("ngIf",""!=r.textContent),e.xp6(1),e.Q6J("ngIf",l.value.length>0&&c.value.length>0),e.xp6(2),e.Q6J("item",a)}}function Ge(t,o){if(1&t&&e._UZ(0,"app-crud-edit-button",52),2&t){const a=e.oxw(2);e.Q6J("disabled",a.isProcessing)}}function Ke(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"div",2)(1,"form",3),e.NdJ("submit",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.editVehicle())}),e.TgZ(2,"div",4)(3,"div",5)(4,"div",6)(5,"mat-form-field",7)(6,"mat-label"),e._uU(7,"Code"),e.qZA(),e._UZ(8,"input",8),e.qZA(),e.TgZ(9,"mat-form-field",7)(10,"mat-label"),e._uU(11,"Plate Number"),e.qZA(),e._UZ(12,"input",9),e.qZA(),e.TgZ(13,"mat-form-field",10)(14,"mat-label"),e._uU(15,"Make"),e.qZA(),e.TgZ(16,"mat-select",11),e.NdJ("selectionChange",function(n){e.CHM(a);const l=e.oxw();return e.KtG(l.onMakeChange(n))}),e.YNc(17,Ee,2,2,"mat-option",12),e.qZA()(),e.TgZ(18,"mat-form-field",10)(19,"mat-label"),e._uU(20,"Model"),e.qZA(),e.TgZ(21,"mat-select",13),e.YNc(22,Ue,2,2,"mat-option",12),e.qZA()()(),e.TgZ(23,"div",6)(24,"mat-form-field",7)(25,"mat-label"),e._uU(26,"Year"),e.qZA(),e._UZ(27,"input",14),e.qZA(),e.TgZ(28,"mat-form-field",7)(29,"mat-label"),e._uU(30,"Wheel"),e.qZA(),e.TgZ(31,"mat-select",15),e._UZ(32,"mat-option"),e.YNc(33,Je,2,2,"mat-option",12),e.qZA()(),e.TgZ(34,"mat-form-field",7)(35,"mat-label"),e._uU(36,"Fuel"),e.qZA(),e.TgZ(37,"mat-select",16),e._UZ(38,"mat-option"),e.YNc(39,Se,2,2,"mat-option",12),e.qZA()(),e.TgZ(40,"mat-form-field",7)(41,"mat-label"),e._uU(42,"Color"),e.qZA(),e._UZ(43,"input",17),e.qZA(),e.TgZ(44,"mat-form-field",10)(45,"mat-label"),e._uU(46,"Owner"),e.qZA(),e.TgZ(47,"mat-select",18),e.YNc(48,Qe,2,2,"mat-option",12),e.qZA()()()()(),e.TgZ(49,"div",4)(50,"div",5)(51,"div",19)(52,"div",20)(53,"div",21)(54,"label"),e._uU(55,"Document"),e.qZA()(),e.TgZ(56,"div",22)(57,"app-add-action-icon",23),e.NdJ("addEvent",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.addDocumentItemForm())}),e.qZA()()(),e.TgZ(58,"div",24),e.YNc(59,Me,33,8,"div",25),e.qZA()(),e.TgZ(60,"div",4)(61,"mat-slide-toggle",26),e._uU(62,"Active"),e.qZA(),e.YNc(63,Ge,1,1,"app-crud-edit-button",27),e.qZA()()()()()}if(2&t){const a=e.oxw();e.xp6(1),e.Q6J("formGroup",a.manageForm),e.xp6(7),e.Q6J("disabled",!0),e.xp6(9),e.Q6J("ngForOf",a.manageData.makeList),e.xp6(5),e.Q6J("ngForOf",a.modelListFiltered),e.xp6(11),e.Q6J("ngForOf",a.manageData.wheelTypeList),e.xp6(6),e.Q6J("ngForOf",a.manageData.fuelTypeList),e.xp6(9),e.Q6J("ngForOf",a.manageData.ownerList),e.xp6(11),e.Q6J("ngForOf",a.documentListControls),e.xp6(4),e.Q6J("ngIf",null!=a.data)}}let He=(()=>{const o=class{constructor(i,n,l,c,r,p,_){this.dialogRef=i,this.vehicleService=n,this.vehicleDocService=l,this.employeeService=c,this.ds=r,this.renderer=p,this.data=_,this.isLoaded=!1,this.modelListFiltered=[],this.employeeList=[],this.deletedDocumentList=[],this.isProcessing=!1}get documentListControls(){return this.manageForm.get("documentList").controls}ngOnInit(){this.manageForm=new s.cw({code:new s.NI({value:null,disabled:!0},[s.kI.required]),plateNumber:new s.NI(null,[s.kI.required]),makeId:new s.NI(null,[s.kI.required]),modelId:new s.NI(null,[s.kI.required]),year:new s.NI(null),ownerId:new s.NI(null,[s.kI.required]),wheelType:new s.NI(null),fuelType:new s.NI(null),color:new s.NI(null),documentList:new s.Oe([]),active:new s.NI(!0,[s.kI.required])}),this.isLoaded=!1,this.sub=this.vehicleService.getVehicleManageData().pipe((0,N.w)(i=>(this.manageData=i.item,this.vehicleService.getVehicle(this.data?.id)))).subscribe(i=>{this.isLoaded=!0;let n=i.item;this.modelListFiltered=this.manageData.modelList.filter(l=>l.make.id==n.make?.id)??[],this.manageForm.patchValue({code:n.code,plateNumber:n.plateNumber,makeId:n.make.id,modelId:n.model?.id,year:n.year,ownerId:n.owner?.id,wheelType:n.wheelType,fuelType:n.fuelType,color:n.color,active:n.active}),(null!=n.ownerCompany||null!=n.ownerPerson)&&(this.sub=this.employeeService.getEmployeeListByCompany(this.manageForm.value.ownerCompanyId).subscribe(l=>{l?.response.status==T.s.success?(this.employeeList=l.list,this.manageForm.patchValue({ownerPersonId:n.ownerPerson?.id})):alert(l?.response.message)})),n.documentList.forEach(l=>{let c=null!=l.expiryDate?this.ds.responseFormatToDate(l.expiryDate):null;this.manageForm.get("documentList").push(new s.cw({id:new s.NI(l.id),documentTypeId:new s.NI({value:l.documentType.id,disabled:!0}),identifier:new s.NI({value:l.identifier,disabled:!0}),expiryDate:new s.NI({value:c,disabled:!0}),file:new s.NI(null),fileName:new s.NI(l.fileName)}))})})}addDocumentItemForm(){this.manageForm.get("documentList").push(new s.cw({id:new s.NI(null),documentTypeId:new s.NI(null,s.kI.required),identifier:new s.NI({value:null,disabled:!0}),expiryDate:new s.NI({value:null,disabled:!0}),file:new s.NI(null),fileName:new s.NI(null)}))}deleteDocumentItem(i){let n=this.manageForm.get("documentList").at(i);null!=n.value.id&&this.deletedDocumentList.push(n.value.id),this.manageForm.get("documentList").removeAt(i)}onDocumentTypeChange(i,n){let l=this.manageData.documentTypeList.find(r=>r.id==i.value);var c=this.manageForm.get("documentList").at(n);c.get("identifier").disabled&&c.get("identifier").enable(),c.get("expiryDate").disabled&&c.get("expiryDate").enable(),c.patchValue({identifier:null,expiryDate:null,file:null,fileName:null}),this.onDocRemove(n),l.isIdentifier?c.get("identifier")?.setValidators(s.kI.required):c.get("identifier")?.removeValidators(s.kI.required),l.isExpiry?c.get("expiryDate")?.setValidators(s.kI.required):c.get("expiryDate")?.removeValidators(s.kI.required),c.get("identifier").markAsUntouched(),c.get("expiryDate").markAsUntouched(),c.get("identifier").updateValueAndValidity(),c.get("expiryDate").updateValueAndValidity()}onDocSelect(i){let n=this.manageForm.get("documentList").at(i),l=this.manageData.documentTypeList.find(r=>r.id==n.getRawValue().documentTypeId),c=this.docUpload.get(i).nativeElement;c.onchange=()=>{if(c.files&&c.files[0]){const r=c.files[0];if(l.contentLimitKb>0&&r.size>1e3*l.contentLimitKb)return c.value="",void alert(`Size max allowed ${l.contentLimitKb}kb exceeded`);let p=this.docName.get(i).nativeElement;this.renderer.setProperty(p,"textContent",r.name),n.patchValue({file:r})}},c.click()}onDocRemove(i){let n=this.manageForm.get("documentList").at(i);this.docUpload.get(i).nativeElement.value="";let c=this.docName.get(i).nativeElement;this.renderer.setProperty(c,"textContent",""),n.patchValue({file:null})}reset(){for(this.manageForm.reset();this.manageForm.get("documentList").length>0;)this.manageForm.get("documentList").removeAt(0)}onMakeChange(i){this.modelListFiltered=this.manageData.modelList.filter(n=>n.make.id==this.manageForm.value.makeId)??[],this.manageForm.patchValue({modelId:""})}editVehicle(){if(!this.manageForm.valid)return void this.manageForm.markAllAsTouched();if(!confirm(A.J.areYouSureTo))return;let i=new qe;i.id=this.data?.id,i.code=this.data.code,i.plateNumber=this.manageForm.value.plateNumber,i.makeId=this.manageForm.value.makeId,i.modelId=this.manageForm.value.modelId,i.year=this.manageForm.value.year,i.ownerId=this.manageForm.value.ownerId,i.wheelType=this.manageForm.value.wheelType,i.fuelType=this.manageForm.value.fuelType,i.color=this.manageForm.value.color,i.active=this.manageForm.value.active;let n=[],l=[];this.manageForm.get("documentList").controls.forEach((r,p)=>{if(null!=r.value.id)return void l.push({docId:r.getRawValue().documentTypeId,identifier:r.getRawValue().identifier});let _=new ye;_.documentTypeId=r.value.documentTypeId,_.identifier=r.value.identifier,null!=r.value.expiryDate&&(_.expiryDate=this.ds.formatToRequest(r.value.expiryDate)),n.push(_)});let c=this.validateDoc(n,l);""==c?(this.isProcessing=!0,this.sub=this.vehicleService.editVehicle(i).pipe((0,N.w)(r=>{if(r.status!=T.s.success)return this.isProcessing=!1,alert(r.message),(0,R.of)(null);let p=i.id;const _=[];return this.deletedDocumentList.forEach(w=>{_.push(this.vehicleDocService.removeVehicleDoc(w))}),this.manageForm.get("documentList").controls.forEach(w=>{if(null!=w.getRawValue().id){if(null==w.value.file)return;{const C=new FormData;C.append("id",w.getRawValue().id),C.append("doc",w.value.file),_.push(this.vehicleDocService.addVehicleDocFile(C))}}else{const C=new FormData;C.append("vehicleId",p),C.append("documentTypeId",w.value.documentTypeId),C.append("identifier",w.value.identifier),null!=w.value.expiryDate&&C.append("expiryDate",this.ds.formatToRequest(w.value.expiryDate)),C.append("doc",w.value.file),_.push(this.vehicleDocService.addVehicleDoc(C))}}),0==_.length?(this.reset(),this.closeDialog(),(0,R.of)(null)):(0,W.D)(_)})).subscribe(r=>{this.isProcessing=!1,this.reset(),this.closeDialog()})):alert(`Error : ${c}`)}validateDoc(i,n){let l=[],c="";if(i.forEach(p=>{l.findIndex(w=>w.key.docId==p.documentTypeId)>=0||n.findIndex(C=>C.docId==p.documentTypeId)>=0?c=p.documentTypeId:l.push({key:{docId:p.documentTypeId},value:1})}),""!=c){var r=this.manageData.documentTypeList.find(p=>p.id==c)?.name;return`Duplicate doc ${r} found`}return""}closeDialog(){this.dialogRef.close(!0)}ngOnDestroy(){this.sub?.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(u.so),e.Y36(L.f),e.Y36(Q.l),e.Y36(B.G),e.Y36(y.R),e.Y36(e.Qsj),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-edit-vehicle"]],viewQuery:function(n,l){if(1&n&&(e.Gf(Le,5),e.Gf(Fe,5)),2&n){let c;e.iGM(c=e.CRH())&&(l.docUpload=c),e.iGM(c=e.CRH())&&(l.docName=c)}},decls:2,vars:2,consts:[[4,"ngIf"],["mat-dialog-content","","class","row",4,"ngIf"],["mat-dialog-content","",1,"row"],[1,"my-2",3,"formGroup","submit"],[1,"row"],[1,"col-12"],[1,"row","form-group"],[1,"form-field","col-2"],["type","text","matInput","","formControlName","code",3,"disabled"],["type","text","matInput","","formControlName","plateNumber"],[1,"form-field","col-4"],["formControlName","makeId",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","modelId"],["type","number","matInput","","formControlName","year"],["formControlName","wheelType"],["formControlName","fuelType"],["type","text","matInput","","formControlName","color"],["formControlName","ownerId"],["formArrayName","documentList"],[1,"row","my-4"],[1,"col-2"],[1,"col-2","text-end"],[3,"addEvent"],[1,"mt-3"],["class","col-12 form-group",3,"formGroupName",4,"ngFor","ngForOf"],["formControlName","active",1,"form-field","col-2","offset-8","text-start"],["class","col-2",3,"disabled",4,"ngIf"],[3,"value"],[1,"col-12","form-group",3,"formGroupName"],["formControlName","documentTypeId",3,"selectionChange"],["typeId",""],["type","text","matInput","","formControlName","identifier"],["appearance","outline",1,"col-2","form-field"],["matInput","","formControlName","expiryDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],["hidden","","formControlName","id"],["id",""],["hidden","","formControlName","fileName"],["fileName",""],[1,"col-5","mt-2"],["type","button","mat-button","","color","primary","class","col-3",3,"disabled","click",4,"ngIf"],["type","file","accept","image/*,.pdf",2,"display","none"],["docUpload",""],[1,"col-6"],["docName",""],["type","button","mat-button","","color","primary","class","col-3",3,"click",4,"ngIf"],[1,"col-1","text-end","mt-2"],[3,"item","deleteEvent"],["type","button","mat-button","","color","primary",1,"col-3",3,"disabled","click"],["type","button","mat-button","","color","primary",1,"col-3",3,"click"],[1,"col-2",3,"disabled"]],template:function(n,l){1&n&&(e.YNc(0,Ve,2,0,"app-form-heading",0),e.YNc(1,Ke,64,9,"div",1)),2&n&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[f.sg,f.O5,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,s.x0,s.CE,h.KE,h.hX,h.R9,b.Nt,S.lW,u.xY,F.gD,V.ey,ie.Rr,g.Mq,g.hl,g.nW,G.W,Y.b,ee.E,E.H]}),t})();var K=d(5861),ne=d(8064),j=d(7268),oe=d(8922);function $e(t,o){1&t&&(e.TgZ(0,"app-form-heading"),e._uU(1," View Vehicle\n"),e.qZA())}function Be(t,o){if(1&t&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function Pe(t,o){if(1&t&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function je(t,o){if(1&t&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a),e.xp6(1),e.Oqu(a)}}function ze(t,o){if(1&t&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a),e.xp6(1),e.Oqu(a)}}function Xe(t,o){if(1&t&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function We(t,o){if(1&t&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function et(t,o){1&t&&(e.TgZ(0,"label",42),e._uU(1,"Doc Uploaded"),e.qZA())}function tt(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-view-action-icon",43),e.NdJ("viewEvent",function(n){e.CHM(a);const l=e.oxw(3);return e.KtG(l.viewDoc(n))}),e.qZA()}if(2&t){const a=e.oxw().index;e.Q6J("item",a)}}function it(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-download-action-icon",44),e.NdJ("downloadEvent",function(n){e.CHM(a);const l=e.oxw(3);return e.KtG(l.downloadDoc(n))}),e.qZA()}if(2&t){const a=e.oxw().index;e.Q6J("item",a)}}function nt(t,o){if(1&t&&(e.TgZ(0,"div",26)(1,"div",6)(2,"mat-form-field",7)(3,"mat-label"),e._uU(4,"Doc Type"),e.qZA(),e.TgZ(5,"mat-select",27,28),e.YNc(7,We,2,2,"mat-option",12),e.qZA()(),e.TgZ(8,"mat-form-field",7)(9,"mat-label"),e._uU(10,"Identifier"),e.qZA(),e._UZ(11,"input",29),e.qZA(),e.TgZ(12,"mat-form-field",30)(13,"mat-label"),e._uU(14,"Expiry"),e.qZA(),e._UZ(15,"input",31)(16,"mat-datepicker-toggle",32)(17,"mat-datepicker",null,33),e.qZA(),e._UZ(19,"input",34,35)(21,"input",36,37),e.TgZ(23,"div",38),e.YNc(24,et,2,0,"label",39),e.YNc(25,tt,1,1,"app-view-action-icon",40),e.YNc(26,it,1,1,"app-download-action-icon",41),e.qZA()()()),2&t){const a=o.index,i=e.MAs(18),n=e.MAs(20),l=e.MAs(22),c=e.oxw(2);e.Q6J("formGroupName",a),e.xp6(7),e.Q6J("ngForOf",c.manageData.documentTypeList),e.xp6(8),e.Q6J("matDatepicker",i),e.xp6(1),e.Q6J("for",i),e.xp6(8),e.Q6J("ngIf",n.value.length>0&&l.value.length>0),e.xp6(1),e.Q6J("ngIf",n.value.length>0&&l.value.length>0&&c.allowExport),e.xp6(1),e.Q6J("ngIf",n.value.length>0&&l.value.length>0&&c.allowExport)}}function ot(t,o){if(1&t&&(e.TgZ(0,"div",2)(1,"form",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"mat-form-field",7)(6,"mat-label"),e._uU(7,"Code"),e.qZA(),e._UZ(8,"input",8),e.qZA(),e.TgZ(9,"mat-form-field",7)(10,"mat-label"),e._uU(11,"Plate Number"),e.qZA(),e._UZ(12,"input",9),e.qZA(),e.TgZ(13,"mat-form-field",10)(14,"mat-label"),e._uU(15,"Make"),e.qZA(),e.TgZ(16,"mat-select",11),e.YNc(17,Be,2,2,"mat-option",12),e.qZA()(),e.TgZ(18,"mat-form-field",10)(19,"mat-label"),e._uU(20,"Model"),e.qZA(),e.TgZ(21,"mat-select",13),e.YNc(22,Pe,2,2,"mat-option",12),e.qZA()()(),e.TgZ(23,"div",6)(24,"mat-form-field",7)(25,"mat-label"),e._uU(26,"Year"),e.qZA(),e._UZ(27,"input",14),e.qZA(),e.TgZ(28,"mat-form-field",7)(29,"mat-label"),e._uU(30,"Wheel"),e.qZA(),e.TgZ(31,"mat-select",15),e._UZ(32,"mat-option"),e.YNc(33,je,2,2,"mat-option",12),e.qZA()(),e.TgZ(34,"mat-form-field",7)(35,"mat-label"),e._uU(36,"Fuel"),e.qZA(),e.TgZ(37,"mat-select",16),e._UZ(38,"mat-option"),e.YNc(39,ze,2,2,"mat-option",12),e.qZA()(),e.TgZ(40,"mat-form-field",7)(41,"mat-label"),e._uU(42,"Color"),e.qZA(),e._UZ(43,"input",17),e.qZA(),e.TgZ(44,"mat-form-field",10)(45,"mat-label"),e._uU(46,"Owner"),e.qZA(),e.TgZ(47,"mat-select",18),e._UZ(48,"mat-option"),e.YNc(49,Xe,2,2,"mat-option",12),e.qZA()()()()(),e.TgZ(50,"div",4)(51,"div",5)(52,"div",19)(53,"div",20)(54,"div",21)(55,"label"),e._uU(56,"Document"),e.qZA()()(),e.TgZ(57,"div",22),e.YNc(58,nt,27,7,"div",23),e.qZA()(),e.TgZ(59,"div",4)(60,"mat-slide-toggle",24),e._uU(61,"Active"),e.qZA()()()()()()),2&t){const a=e.oxw();e.xp6(1),e.Q6J("formGroup",a.manageForm),e.xp6(7),e.Q6J("disabled",!0),e.xp6(9),e.Q6J("ngForOf",a.manageData.makeList),e.xp6(5),e.Q6J("ngForOf",a.modelListFiltered),e.xp6(11),e.Q6J("ngForOf",a.manageData.wheelTypeList),e.xp6(6),e.Q6J("ngForOf",a.manageData.fuelTypeList),e.xp6(10),e.Q6J("ngForOf",a.manageData.ownerList),e.xp6(9),e.Q6J("ngForOf",a.documentListControls)}}let at=(()=>{const o=class{constructor(i,n,l,c,r,p,_,w,C){this.dialogRef=i,this.menuRoleService=n,this.vehicleService=l,this.vehicleDocService=c,this.employeeService=r,this.ds=p,this.renderer=_,this.fileService=w,this.data=C,this.isLoaded=!1,this.modelListFiltered=[],this.employeeList=[],this.allowExport=!1}get documentListControls(){return this.manageForm.get("documentList").controls}ngOnInit(){this.allowExport=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.Fleet,v.k.export),this.manageForm=new s.cw({code:new s.NI({value:null,disabled:!0},[s.kI.required]),plateNumber:new s.NI({value:null,disabled:!0},[s.kI.required]),makeId:new s.NI({value:null,disabled:!0},[s.kI.required]),modelId:new s.NI({value:null,disabled:!0},[s.kI.required]),year:new s.NI({value:null,disabled:!0}),ownerId:new s.NI({value:null,disabled:!0}),wheelType:new s.NI({value:null,disabled:!0}),fuelType:new s.NI({value:null,disabled:!0}),color:new s.NI({value:null,disabled:!0}),documentList:new s.Oe([]),active:new s.NI({value:null,disabled:!0},[s.kI.required])}),this.isLoaded=!1,this.sub=this.vehicleService.getVehicleManageData().pipe((0,N.w)(i=>(this.manageData=i.item,this.vehicleService.getVehicle(this.data?.id)))).subscribe(i=>{this.isLoaded=!0;let n=i.item;this.modelListFiltered=this.manageData.modelList.filter(l=>l.make.id==n.make?.id)??[],this.manageForm.patchValue({code:n.code,plateNumber:n.plateNumber,makeId:n.make.id,modelId:n.model?.id,year:n.year,ownerId:n.owner?.id,wheelType:n.wheelType,fuelType:n.fuelType,color:n.color,active:n.active}),(null!=n.ownerCompany||null!=n.ownerPerson)&&(this.sub=this.employeeService.getEmployeeListByCompany(this.manageForm.value.ownerCompanyId).subscribe(l=>{l?.response.status==T.s.success?(this.employeeList=l.list,this.manageForm.patchValue({ownerPersonId:n.ownerPerson?.id})):alert(l?.response.message)})),n.documentList.forEach(l=>{let c=null!=l.expiryDate?this.ds.responseFormatToDate(l.expiryDate):null;this.manageForm.get("documentList").push(new s.cw({id:new s.NI(l.id),documentTypeId:new s.NI({value:l.documentType.id,disabled:!0}),identifier:new s.NI({value:l.identifier,disabled:!0}),expiryDate:new s.NI({value:c,disabled:!0}),file:new s.NI(null),fileName:new s.NI(l.fileName)}))})})}viewDoc(i){var n=this;let c=this.manageForm.get("documentList").at(i).getRawValue().id;this.sub=this.vehicleDocService.exportVehicleDoc(c).subscribe(function(){var r=(0,K.Z)(function*(p){n.fileService.viewFile(p)});return function(p){return r.apply(this,arguments)}}())}downloadDoc(i){var n=this,l=this.manageForm.get("documentList").at(i);let c=l.getRawValue().id,r=l.getRawValue().identifier,p=this.manageData.documentTypeList.find(w=>w.id==l.getRawValue().documentTypeId),_=`${this.data.code}_${p.code}`;null!=r&&(_=`${_}_${r}`),this.sub=this.vehicleDocService.exportVehicleDoc(c).subscribe(function(){var w=(0,K.Z)(function*(C){n.fileService.downloadFile(C,_)});return function(C){return w.apply(this,arguments)}}())}ngOnDestroy(){this.sub?.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(u.so),e.Y36(q.K),e.Y36(L.f),e.Y36(Q.l),e.Y36(B.G),e.Y36(y.R),e.Y36(e.Qsj),e.Y36(ne.I),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-view-vehicle"]],decls:2,vars:2,consts:[[4,"ngIf"],["mat-dialog-content","","class","row",4,"ngIf"],["mat-dialog-content","",1,"row"],[1,"my-2",3,"formGroup"],[1,"row"],[1,"col-12"],[1,"row","form-group"],[1,"form-field","col-2"],["type","text","matInput","","formControlName","code",3,"disabled"],["type","text","matInput","","formControlName","plateNumber"],[1,"form-field","col-4"],["formControlName","makeId"],[3,"value",4,"ngFor","ngForOf"],["formControlName","modelId"],["type","number","matInput","","formControlName","year"],["formControlName","wheelType"],["formControlName","fuelType"],["type","text","matInput","","formControlName","color"],["formControlName","ownerId"],["formArrayName","documentList"],[1,"row","my-4"],[1,"col-2"],[1,"mt-3"],["class","col-12 form-group",3,"formGroupName",4,"ngFor","ngForOf"],["formControlName","active",1,"form-field","col-2","offset-8","text-start"],[3,"value"],[1,"col-12","form-group",3,"formGroupName"],["formControlName","documentTypeId"],["typeId",""],["type","text","matInput","","formControlName","identifier"],["appearance","outline",1,"col-2","form-field"],["matInput","","formControlName","expiryDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],["hidden","","formControlName","id"],["id",""],["hidden","","formControlName","fileName"],["fileName",""],[1,"col-6","mt-2"],["class","col-8 text-center",4,"ngIf"],["class","mx-4",3,"item","viewEvent",4,"ngIf"],[3,"item","downloadEvent",4,"ngIf"],[1,"col-8","text-center"],[1,"mx-4",3,"item","viewEvent"],[3,"item","downloadEvent"]],template:function(n,l){1&n&&(e.YNc(0,$e,2,0,"app-form-heading",0),e.YNc(1,ot,62,8,"div",1)),2&n&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[f.sg,f.O5,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,s.x0,s.CE,h.KE,h.hX,h.R9,b.Nt,u.xY,F.gD,V.ey,ie.Rr,g.Mq,g.hl,g.nW,j.R,oe.e,E.H]}),t})();var lt=d(9528);let st=(()=>{const o=class{constructor(i,n,l,c){this.dialogRef=i,this.vehicleService=n,this.menuRoleService=l,this.data=c,this.isProcessing=!1,this.allowEdit=!1}ngOnInit(){this.allowEdit=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.Fleet,v.k.edit),this.manageForm=new s.cw({code:new s.NI(this.data.code)})}editCode(){if(!this.allowEdit||!confirm(A.J.areYouSureTo))return;let i=new lt.X;i.id=this.data.id,i.code=this.manageForm.value.code,this.isProcessing=!0,this.sub=this.vehicleService.editVehicleCode(i).subscribe(n=>{if(n.status!=T.s.success)return this.isProcessing=!1,void alert(n.message);this.closeDialog()})}closeDialog(){this.dialogRef.close(!0)}ngOnDestroy(){this.sub?.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(u.so),e.Y36(L.f),e.Y36(q.K),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-edit-vehicle-code"]],decls:14,vars:4,consts:[["mat-dialog-content","",1,"row"],[1,"my-2",3,"formGroup","submit"],[1,"row","mb-4"],[1,""],[1,"row","form-group"],[1,"form-field","col-12"],["type","text","matInput","","formControlName","code"],[1,"row"],[1,"col-4","offset-8",3,"disabled"]],template:function(n,l){1&n&&(e.TgZ(0,"app-form-heading"),e._uU(1," Edit Vehicle Code\n"),e.qZA(),e.TgZ(2,"div",0)(3,"form",1),e.NdJ("submit",function(){return l.editCode()}),e.TgZ(4,"div",2)(5,"label",3),e._uU(6),e.qZA()(),e.TgZ(7,"div",4)(8,"mat-form-field",5)(9,"mat-label"),e._uU(10,"Code New"),e.qZA(),e._UZ(11,"input",6),e.qZA()(),e.TgZ(12,"div",7),e._UZ(13,"app-crud-edit-button",8),e.qZA()()()),2&n&&(e.xp6(3),e.Q6J("formGroup",l.manageForm),e.xp6(3),e.AsE("",l.data.plateNumber," (",l.data.code,")"),e.xp6(7),e.Q6J("disabled",l.isProcessing))},dependencies:[s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,h.KE,h.hX,b.Nt,u.xY,G.W,E.H]}),t})();class ct{}var ae=d(5);let le=(()=>{const o=class{constructor(i){this.http=i}getOdometerReadingList(i){return this.http.post(D.bU.getOdometerReadingList,i)}getOdometerReadingManageData(){return this.http.get(D.bU.getOdometerReadingManageData)}addOdometerReading(i){return this.http.post(D.bU.addOdometerReading,i)}editOdometerReading(i){return this.http.post(D.bU.editOdometerReading,i)}deleteOdometerReading(i){let n=D.bU.deleteOdometerReading;return n=n.replace(/{id}/gi,i),this.http.post(n,null)}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.LFG(ae.o))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),t})(),rt=(()=>{const o=class{constructor(i,n,l,c){this.dialogRef=i,this.odometerReadingService=n,this.ds=l,this.data=c,this.isProcessing=!1}ngOnInit(){this.manageForm=new s.cw({reading:new s.NI(null,[s.kI.required])})}addOdometerReading(){if(!this.manageForm.valid)return void this.manageForm.markAllAsTouched();if(!confirm(A.J.areYouSureTo))return;let i=new ct;i.reading=this.manageForm.value.reading,i.timestamp=this.ds.formatToRequestDatetime(new Date),i.vehicleId=this.data.id,this.isProcessing=!0,this.sub=this.odometerReadingService.addOdometerReading(i).subscribe(n=>{if(this.isProcessing=!1,n?.status!=T.s.success)return this.isProcessing=!1,void alert(n?.message);this.reset(),this.closeDialog()})}reset(){this.manageForm.reset()}closeDialog(){this.dialogRef.close(!0)}ngOnDestroy(){this.sub?.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(u.so),e.Y36(le),e.Y36(y.R),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-odometer-reading"]],decls:25,vars:7,consts:[["mat-dialog-content","",1,"row"],[1,"my-2",3,"formGroup","submit"],[1,"row","mb-4"],[1,"col-12","py-0"],[1,"row"],[1,"col-6"],[1,"col-6","text-end"],[1,"row","mt-2"],[1,"col-4","text-start"],[1,"col-8","text-end"],[1,"row","form-group"],[1,"form-field","col-12"],["type","number","matInput","","formControlName","reading"],[1,"col-3",3,"resetEvent"],[1,"col-3","offset-6",3,"disabled"]],template:function(n,l){1&n&&(e.TgZ(0,"app-form-heading"),e._uU(1," Add Odometer Reading\n"),e.qZA(),e.TgZ(2,"div",0)(3,"form",1),e.NdJ("submit",function(){return l.addOdometerReading()}),e.TgZ(4,"div",2)(5,"div",3)(6,"div",4)(7,"label",5)(8,"strong"),e._uU(9),e.qZA()(),e.TgZ(10,"label",6),e._uU(11),e.qZA()(),e.TgZ(12,"div",7)(13,"label",8),e._uU(14),e.qZA(),e.TgZ(15,"label",9),e._uU(16),e.qZA()()()(),e.TgZ(17,"div",10)(18,"mat-form-field",11)(19,"mat-label"),e._uU(20,"Reading"),e.qZA(),e._UZ(21,"input",12),e.qZA()(),e.TgZ(22,"div",4)(23,"app-crud-reset-button",13),e.NdJ("resetEvent",function(){return l.reset()}),e.qZA(),e._UZ(24,"app-crud-add-button",14),e.qZA()()()),2&n&&(e.xp6(3),e.Q6J("formGroup",l.manageForm),e.xp6(6),e.Oqu(l.data.code),e.xp6(2),e.hij(" ",l.data.plateNumber," "),e.xp6(3),e.AsE("",l.data.make," ",l.data.model,""),e.xp6(2),e.Oqu(l.data.owner),e.xp6(8),e.Q6J("disabled",l.isProcessing))},dependencies:[s._Y,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,h.KE,h.hX,b.Nt,u.xY,P.L,k.X,E.H]}),t})();var H=d(7974),$=d(4521),z=d(1763),se=d(5894);const dt=["page"];function mt(t,o){1&t&&(e.TgZ(0,"th",28),e._uU(1," Code "),e.qZA())}function pt(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"td",29),e.NdJ("click",function(){const l=e.CHM(a).$implicit,c=e.oxw();return e.KtG(c.editCode(l))}),e._uU(1),e.qZA()}if(2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.code," ")}}function ut(t,o){1&t&&(e.TgZ(0,"th",28),e._uU(1," PlateNumber "),e.qZA())}function ht(t,o){if(1&t&&(e.TgZ(0,"td",30),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.plateNumber," ")}}function _t(t,o){1&t&&(e.TgZ(0,"th",28),e._uU(1," Make "),e.qZA())}function ft(t,o){if(1&t&&(e.TgZ(0,"td",30),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.make," ")}}function gt(t,o){1&t&&(e.TgZ(0,"th",28),e._uU(1," Model "),e.qZA())}function vt(t,o){if(1&t&&(e.TgZ(0,"td",30),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.model," ")}}function Zt(t,o){1&t&&(e.TgZ(0,"th",28),e._uU(1," Year "),e.qZA())}function wt(t,o){if(1&t&&(e.TgZ(0,"td",30),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.year," ")}}function Tt(t,o){1&t&&(e.TgZ(0,"th",28),e._uU(1," Owner "),e.qZA())}function xt(t,o){if(1&t&&(e.TgZ(0,"td",31),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.owner," ")}}function Ct(t,o){1&t&&(e.TgZ(0,"th",28),e._uU(1," Wheel "),e.qZA())}function At(t,o){if(1&t&&(e.TgZ(0,"td",32),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.wheelType," ")}}function Dt(t,o){1&t&&(e.TgZ(0,"th",28),e._uU(1," Fuel "),e.qZA())}function bt(t,o){if(1&t&&(e.TgZ(0,"td",32),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.fuelType," ")}}function It(t,o){1&t&&(e.TgZ(0,"th",28),e._uU(1," Color "),e.qZA())}function Nt(t,o){if(1&t&&(e.TgZ(0,"td",32),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.color," ")}}function yt(t,o){1&t&&(e.TgZ(0,"th",28)(1,"i",33),e._uU(2,"attachment"),e.qZA(),e._uU(3," / "),e.TgZ(4,"i",33),e._uU(5,"description"),e.qZA()())}function qt(t,o){if(1&t&&(e.TgZ(0,"span",38),e._uU(1),e.qZA()),2&t){const a=e.oxw().$implicit;e.xp6(1),e.AsE("",a.fileCount,"/",a.docCount,"")}}function Lt(t,o){if(1&t&&(e.TgZ(0,"span",39),e._uU(1),e.qZA()),2&t){const a=e.oxw().$implicit;e.xp6(1),e.AsE("",a.fileCount,"/",a.docCount,"")}}function Ft(t,o){if(1&t&&(e.TgZ(0,"span",40),e._uU(1),e.qZA()),2&t){const a=e.oxw().$implicit;e.xp6(1),e.AsE("",a.fileCount,"/",a.docCount,"")}}function Vt(t,o){if(1&t&&(e.TgZ(0,"td",34),e.YNc(1,qt,2,2,"span",35),e.YNc(2,Lt,2,2,"span",36),e.YNc(3,Ft,2,2,"span",37),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.Q6J("ngIf",0==a.docCount),e.xp6(1),e.Q6J("ngIf",a.fileCount==a.docCount&&a.docCount>0),e.xp6(1),e.Q6J("ngIf",a.fileCount<a.docCount&&a.docCount>0)}}function Et(t,o){1&t&&e._UZ(0,"th",41)}function Ut(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-edit-action-icon",47),e.NdJ("editEvent",function(){e.CHM(a);const n=e.oxw().$implicit,l=e.oxw();return e.KtG(l.edit(n))}),e.qZA()}if(2&t){const a=e.oxw().$implicit;e.Q6J("item",a)}}function Jt(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-action-icon",48),e.NdJ("actionEvent",function(){e.CHM(a);const n=e.oxw().$implicit,l=e.oxw();return e.KtG(l.addOdometerReading(n))}),e._uU(1,"123"),e.qZA()}if(2&t){const a=e.oxw().$implicit;e.Q6J("item",a)}}function St(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-delete-action-icon",49),e.NdJ("deleteEvent",function(){e.CHM(a);const n=e.oxw().$implicit,l=e.oxw();return e.KtG(l.delete(n))}),e.qZA()}if(2&t){const a=e.oxw().$implicit;e.Q6J("item",a)}}function Qt(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"td",42)(1,"app-view-action-icon",43),e.NdJ("viewEvent",function(){const l=e.CHM(a).$implicit,c=e.oxw();return e.KtG(c.view(l))}),e.qZA(),e.YNc(2,Ut,1,1,"app-edit-action-icon",44),e.YNc(3,Jt,2,1,"app-action-icon",45),e.YNc(4,St,1,1,"app-delete-action-icon",46),e.qZA()}if(2&t){const a=o.$implicit,i=e.oxw();e.xp6(1),e.Q6J("item",a),e.xp6(1),e.Q6J("ngIf",i.allowEdit),e.xp6(1),e.Q6J("ngIf",i.allowAddOmr),e.xp6(1),e.Q6J("ngIf",i.allowDelete)}}function Yt(t,o){1&t&&e._UZ(0,"tr",50)}function Ot(t,o){1&t&&e._UZ(0,"tr",51)}const Rt=function(){return[10,20,50]};let kt=(()=>{const o=class{constructor(i,n){this.menuRoleService=i,this.dialog=n,this.moreEvent=new Z.x,this.editEvent=new Z.x,this.deleteEvent=new Z.x,this.displayedColumns=["code","plateNumber","make","model","year","owner","wheel","fuel","color","d/f","manage"],this.baseUrl=(0,D.SV)(),this.allowEdit=!1,this.allowDelete=!1,this.allowAddOmr=!1}ngOnInit(){this.allowEdit=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.Fleet,v.k.edit),this.allowDelete=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.Fleet,v.k.delete),this.allowAddOmr=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.OdometerReading_Fleet,v.k.add)}ngOnChanges(i){this.vehicleList.paginator=this.paginator}ngAfterViewInit(){this.vehicleList.paginator=this.paginator}more(){this.moreEvent.next(!0)}edit(i){this.dialog.open(He,{data:i,width:"85%",maxHeight:"auto"}).afterClosed().subscribe(l=>{1==l&&this.editEvent.next()})}editCode(i){this.dialog.open(st,{data:i,width:"20%",maxHeight:"auto"}).afterClosed().subscribe(l=>{1==l&&this.editEvent.next()})}view(i){this.dialog.open(at,{data:i,width:"85%",maxHeight:"auto"})}delete(i){this.deleteEvent.next(i)}addOdometerReading(i){this.dialog.open(rt,{data:i,width:"30%",maxHeight:"auto"})}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(q.K),e.Y36(u.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-vehicle-list"]],viewQuery:function(n,l){if(1&n&&e.Gf(dt,5),2&n){let c;e.iGM(c=e.CRH())&&(l.paginator=c.first)}},inputs:{vehicleList:"vehicleList",count:"count"},outputs:{moreEvent:"moreEvent",editEvent:"editEvent",deleteEvent:"deleteEvent"},features:[e.TTD],decls:42,vars:7,consts:[[1,"mat-elevation-z8"],["mat-table","",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","col-1",3,"click",4,"matCellDef"],["matColumnDef","plateNumber"],["mat-cell","","class","col-1",4,"matCellDef"],["matColumnDef","make"],["matColumnDef","model"],["matColumnDef","year"],["matColumnDef","owner"],["mat-cell","","class","col-3",4,"matCellDef"],["matColumnDef","wheel"],["mat-cell","","class","col",4,"matCellDef"],["matColumnDef","fuel"],["matColumnDef","color"],["matColumnDef","d/f"],["mat-cell","","class","","style","width: 6rem;",4,"matCellDef"],["matColumnDef","manage"],["mat-header-cell","","class","text-end",4,"matHeaderCellDef"],["mat-cell","","class","text-end","style","width: 15rem;",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","",3,"pageSizeOptions"],["page",""],[1,"row"],[1,"col-6"],[3,"loaded","count","loadMore"],["mat-header-cell",""],["mat-cell","",1,"col-1",3,"click"],["mat-cell","",1,"col-1"],["mat-cell","",1,"col-3"],["mat-cell","",1,"col"],[1,"material-icons"],["mat-cell","",1,"",2,"width","6rem"],["class","bg-warn p-1 rounded-pill text-white",4,"ngIf"],["class","bg-success p-1 rounded-pill text-white",4,"ngIf"],["class","bg-accent p-1 rounded-pill",4,"ngIf"],[1,"bg-warn","p-1","rounded-pill","text-white"],[1,"bg-success","p-1","rounded-pill","text-white"],[1,"bg-accent","p-1","rounded-pill"],["mat-header-cell","",1,"text-end"],["mat-cell","",1,"text-end",2,"width","15rem"],[3,"item","viewEvent"],[3,"item","editEvent",4,"ngIf"],[3,"item","actionEvent",4,"ngIf"],[3,"item","deleteEvent",4,"ngIf"],[3,"item","editEvent"],[3,"item","actionEvent"],[3,"item","deleteEvent"],["mat-header-row",""],["mat-row",""]],template:function(n,l){1&n&&(e.TgZ(0,"div",0)(1,"table",1),e.ynx(2,2),e.YNc(3,mt,2,0,"th",3),e.YNc(4,pt,2,1,"td",4),e.BQk(),e.ynx(5,5),e.YNc(6,ut,2,0,"th",3),e.YNc(7,ht,2,1,"td",6),e.BQk(),e.ynx(8,7),e.YNc(9,_t,2,0,"th",3),e.YNc(10,ft,2,1,"td",6),e.BQk(),e.ynx(11,8),e.YNc(12,gt,2,0,"th",3),e.YNc(13,vt,2,1,"td",6),e.BQk(),e.ynx(14,9),e.YNc(15,Zt,2,0,"th",3),e.YNc(16,wt,2,1,"td",6),e.BQk(),e.ynx(17,10),e.YNc(18,Tt,2,0,"th",3),e.YNc(19,xt,2,1,"td",11),e.BQk(),e.ynx(20,12),e.YNc(21,Ct,2,0,"th",3),e.YNc(22,At,2,1,"td",13),e.BQk(),e.ynx(23,14),e.YNc(24,Dt,2,0,"th",3),e.YNc(25,bt,2,1,"td",13),e.BQk(),e.ynx(26,15),e.YNc(27,It,2,0,"th",3),e.YNc(28,Nt,2,1,"td",13),e.BQk(),e.ynx(29,16),e.YNc(30,yt,6,0,"th",3),e.YNc(31,Vt,4,3,"td",17),e.BQk(),e.ynx(32,18),e.YNc(33,Et,1,0,"th",19),e.YNc(34,Qt,5,4,"td",20),e.BQk(),e.YNc(35,Yt,1,0,"tr",21),e.YNc(36,Ot,1,0,"tr",22),e.qZA(),e._UZ(37,"mat-paginator",23,24),e.qZA(),e.TgZ(39,"div",25)(40,"div",26)(41,"app-server-pagination",27),e.NdJ("loadMore",function(){return l.more()}),e.qZA()()()),2&n&&(e.xp6(1),e.Q6J("dataSource",l.vehicleList),e.xp6(34),e.Q6J("matHeaderRowDef",l.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",l.displayedColumns),e.xp6(1),e.Q6J("pageSizeOptions",e.DdM(6,Rt)),e.xp6(4),e.Q6J("loaded",l.vehicleList.data.length)("count",l.count))},dependencies:[f.O5,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,H.NW,$.H,Y.b,z.p,j.R,se.m]}),t})();const Mt=["vehicleImport"];function Gt(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-vehicle-search-filter",3),e.NdJ("onSearchChange",function(n){e.CHM(a);const l=e.oxw();return e.KtG(l.changeSearchData(n))})("onSearch",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.getList())}),e.qZA()}if(2&t){const a=e.oxw();e.Q6J("searchData",a.searchData)}}function Kt(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-import-button",11),e.NdJ("importEvent",function(){e.CHM(a);const n=e.oxw(2);return e.KtG(n.importVehicle())}),e.qZA()}}function Ht(t,o){1&t&&e._UZ(0,"input",12,13)}function $t(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-add-button",14),e.NdJ("addEvent",function(){e.CHM(a);const n=e.oxw(2);return e.KtG(n.addVehicle())}),e.qZA()}}function Bt(t,o){if(1&t&&(e.TgZ(0,"div",4)(1,"app-table-heading",5),e._uU(2," Vehicle "),e.qZA(),e.TgZ(3,"div",6),e.YNc(4,Kt,1,0,"app-import-button",7),e.YNc(5,Ht,2,0,"input",8),e.qZA(),e.TgZ(6,"div",9),e.YNc(7,$t,1,0,"app-add-button",10),e.qZA()()),2&t){const a=e.oxw();e.xp6(4),e.Q6J("ngIf",a.allowImport),e.xp6(1),e.Q6J("ngIf",a.allowImport),e.xp6(2),e.Q6J("ngIf",a.allowAdd)}}function Pt(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-vehicle-list",15),e.NdJ("moreEvent",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.getList())})("editEvent",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.editVehicle())})("deleteEvent",function(n){e.CHM(a);const l=e.oxw();return e.KtG(l.deleteVehicle(n))}),e.qZA()}if(2&t){const a=e.oxw();e.Q6J("vehicleList",a.dataSource)("count",a.count)}}let jt=(()=>{const o=class{constructor(i,n,l){this.menuRoleService=i,this.vehicleService=n,this.dialog=l,this.isLoaded=!1,this.req=new U,this.eList=[],this.count=0,this.allowAdd=!1,this.allowImport=!1,this.viewVehicleDoc=!1,this.viewOdometerReading=!1}ngOnInit(){this.isLoaded=!1,this.sub=this.vehicleService.getVehicleSearchData().pipe((0,N.w)(i=>(this.searchData=i.item,this.isLoaded=!0,this.dataSource=new m.by(this.eList),this.req.pagination.pageSize=10,this.allowAdd=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.Fleet,v.k.add),this.allowImport=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.Fleet,v.k.import),this.viewVehicleDoc=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.VehicleDoc,v.k.view),this.viewOdometerReading=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.OdometerReading_Fleet,v.k.view),this.vehicleService.getVehicleList(this.req)))).subscribe(i=>{this.update(i)})}ngAfterViewInit(){}changeSearchData(i){console.log(i),this.eList=[],this.dataSource=new m.by(this.eList),this.req.searchKey=i.searchKey,this.req.makeId=""!=i.makeId?i.makeId:null,this.req.modelId=""!=i.modelId?i.modelId:null,this.req.ownerId=""!=i.ownerId?i.ownerId:null,this.req.pagination.pageNumber=1}refreshList(){this.eList=[],this.dataSource=new m.by(this.eList),this.req.pagination.pageNumber=1,this.getList()}update(i){i?.response?.status==T.s.success&&(this.eList.push.apply(this.eList,i.list),this.dataSource=new m.by(this.eList),this.count=i.totalRecords,i.list.length>0&&(this.req.pagination.pageNumber+=1))}getList(){this.sub=this.vehicleService.getVehicleList(this.req).subscribe(i=>{this.update(i)})}addVehicle(){this.dialog.open(xe,{data:null,width:"85%",maxHeight:"auto"}).afterClosed().subscribe(n=>{1==n&&this.refreshList()})}editVehicle(){this.refreshList()}deleteVehicle(i){confirm(A.J.confirmDelete(i.code))&&(this.sub=this.vehicleService.deleteVehicle(i.id).subscribe(n=>{n?.status==T.s.success?this.refreshList():alert(n?.message)}))}importVehicle(){}ngOnDestroy(){this.sub?.unsubscribe(),this.importSub?.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(q.K),e.Y36(L.f),e.Y36(u.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-vehicle"]],viewQuery:function(n,l){if(1&n&&e.Gf(Mt,5),2&n){let c;e.iGM(c=e.CRH())&&(l.vehicleImport=c.first)}},decls:3,vars:3,consts:[[3,"searchData","onSearchChange","onSearch",4,"ngIf"],["class","row",4,"ngIf"],[3,"vehicleList","count","moreEvent","editEvent","deleteEvent",4,"ngIf"],[3,"searchData","onSearchChange","onSearch"],[1,"row"],[1,"col-3"],[1,"col-1","offset-7"],["class","col-12",3,"importEvent",4,"ngIf"],["type","file","id","vehicleImport","name","vehicleImport","accept","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","style","display: none;",4,"ngIf"],[1,"col-1"],["class","col-12",3,"addEvent",4,"ngIf"],[1,"col-12",3,"importEvent"],["type","file","id","vehicleImport","name","vehicleImport","accept","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",2,"display","none"],["vehicleImport",""],[1,"col-12",3,"addEvent"],[3,"vehicleList","count","moreEvent","editEvent","deleteEvent"]],template:function(n,l){1&n&&(e.YNc(0,Gt,1,1,"app-vehicle-search-filter",0),e.YNc(1,Bt,8,3,"div",1),e.YNc(2,Pt,1,2,"app-vehicle-list",2)),2&n&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",(l.allowAdd||l.allowImport||l.viewVehicleDoc)&&l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[f.O5,te.L,Ce.x,M.u,Ie,kt]}),t})();class zt extends J.G{}function Xt(t,o){if(1&t&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function Wt(t,o){if(1&t&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function ei(t,o){if(1&t&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}let ti=(()=>{const o=class{constructor(){this.onSearchChange=new Z.x,this.onSearch=new Z.x}ngOnInit(){this.filterForm=new s.cw({searchKey:new s.NI(""),docTypeId:new s.NI(""),mode:new s.NI(4,[s.kI.required]),expiryDays:new s.NI(null),ownerId:new s.NI("")}),this.valueChangeSub=this.filterForm.valueChanges.subscribe(i=>{this.onSearchChange.next(i)})}search(){this.onSearch.next()}resetFilter(){this.filterForm.patchValue({searchKey:"",docTypeId:"",mode:4,expiryDays:null,ownerId:""})}ngOnDestroy(){this.valueChangeSub.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-vehicle-doc-search-filter"]],inputs:{searchData:"searchData"},outputs:{onSearchChange:"onSearchChange",onSearch:"onSearch"},decls:36,vars:4,consts:[[1,"mt-4",3,"formGroup","ngSubmit"],[1,"row","form-group"],["type","button","mat-button","","color","primary",1,"col-1","mt-2",3,"click"],["appearance","outline","floatLabel","always",1,"form-field","col-1"],["type","number","placeholder","","matInput","","formControlName","expiryDays"],[1,"form-field","col-3"],["formControlName","ownerId"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-field","col-2"],["formControlName","docTypeId"],["formControlName","mode"],["appearance","outline","floatLabel","always",1,"form-field","col-2"],["type","search","placeholder","","matInput","","formControlName","searchKey"],[1,"col-1"],["type","submit","mat-raised-button","","color","primary",1,"col-12","offset-0","mt-2"],[1,"material-icons"],[3,"value"]],template:function(n,l){1&n&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return l.search()}),e.TgZ(1,"div",1)(2,"button",2),e.NdJ("click",function(){return l.resetFilter()}),e._uU(3,"Reset"),e.qZA(),e.TgZ(4,"mat-form-field",3)(5,"mat-label"),e._uU(6,"Expire In"),e.qZA(),e._UZ(7,"input",4),e.qZA(),e.TgZ(8,"mat-form-field",5)(9,"mat-label"),e._uU(10,"Owner"),e.qZA(),e.TgZ(11,"mat-select",6)(12,"mat-option",7),e._uU(13,"All"),e.qZA(),e.YNc(14,Xt,2,2,"mat-option",8),e.qZA()(),e.TgZ(15,"mat-form-field",9)(16,"mat-label"),e._uU(17,"Doc Type"),e.qZA(),e.TgZ(18,"mat-select",10)(19,"mat-option",7),e._uU(20,"All"),e.qZA(),e.YNc(21,Wt,2,2,"mat-option",8),e.qZA()(),e.TgZ(22,"mat-form-field",9)(23,"mat-label"),e._uU(24,"Mode"),e.qZA(),e.TgZ(25,"mat-select",11),e.YNc(26,ei,2,2,"mat-option",8),e.qZA()(),e.TgZ(27,"mat-form-field",12)(28,"mat-label"),e._uU(29,"Search"),e.qZA(),e._UZ(30,"input",13),e.qZA(),e.TgZ(31,"div",14)(32,"button",15)(33,"i",16),e._uU(34,"search"),e.qZA(),e._uU(35," Search"),e.qZA()()()()),2&n&&(e.Q6J("formGroup",l.filterForm),e.xp6(14),e.Q6J("ngForOf",l.searchData.ownerList),e.xp6(7),e.Q6J("ngForOf",l.searchData.docTypeList),e.xp6(5),e.Q6J("ngForOf",l.searchData.searchModeList))},dependencies:[f.sg,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,h.KE,h.hX,b.Nt,S.lW,F.gD,V.ey]}),t})();var ii=d(6464);const ni=["docUpload"],oi=["docName"];function ai(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.onDocRemove())}),e._uU(1,"Remove File"),e.qZA()}}let li=(()=>{const o=class{constructor(i,n,l,c,r,p){this.dialogRef=i,this.vehicleDocService=n,this.vehicleService=l,this.ds=c,this.renderer=r,this.data=p,this.isProcessing=!1}ngOnInit(){let i=null!=this.data.expiryDate?this.ds.responseFormatToDate(this.data.expiryDate):null;this.manageForm=new s.cw({id:new s.NI(this.data.id),identifier:new s.NI({value:this.data.identifier,disabled:!0}),expiryDate:new s.NI({value:i,disabled:!0}),file:new s.NI(null)})}onDocSelect(){let i=this.docUpload.nativeElement;i.onchange=()=>{if(i.files&&i.files[0]){const n=i.files[0];this.renderer.setProperty(this.docName.nativeElement,"textContent",n.name),this.manageForm.patchValue({file:n})}},i.click()}onDocRemove(){this.docUpload.nativeElement.value="",this.renderer.setProperty(this.docName.nativeElement,"textContent",""),this.manageForm.patchValue({file:null})}attachVehicleDocFile(){if(!confirm(A.J.areYouSure+" to attach doc file ?"))return;this.isProcessing=!0;const i=new FormData;i.append("id",this.data.id),i.append("doc",this.manageForm.value.file),this.sub=this.vehicleDocService.addVehicleDocFile(i).subscribe(n=>{if(n.status!=T.s.success)return this.isProcessing=!1,void alert(n.message);this.closeDialog()})}closeDialog(){this.dialogRef.close(!0)}ngOnDestroy(){this.sub?.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(u.so),e.Y36(Q.l),e.Y36(L.f),e.Y36(y.R),e.Y36(e.Qsj),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-attach-vehicle-doc"]],viewQuery:function(n,l){if(1&n&&(e.Gf(ni,5),e.Gf(oi,5)),2&n){let c;e.iGM(c=e.CRH())&&(l.docUpload=c.first),e.iGM(c=e.CRH())&&(l.docName=c.first)}},decls:33,vars:10,consts:[["mat-dialog-content","",1,"row"],[1,"my-2",3,"formGroup","submit"],[1,"row","mb-4"],[1,"col-6"],[1,"col-6","text-end"],[1,"row","form-group"],[1,"form-field","col-6"],["type","text","matInput","","formControlName","identifier"],["appearance","outline",1,"col-6","form-field"],["matInput","","formControlName","expiryDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],[1,"col-12","mt-2"],["type","button","mat-button","","color","primary",1,"col-3",3,"click"],["type","file","accept","image/*,.pdf",2,"display","none"],["docUpload",""],["docName",""],["type","button","mat-button","","color","primary","class","col-3",3,"click",4,"ngIf"],[1,"row"],[1,"col-2","offset-10",3,"disabled"]],template:function(n,l){if(1&n&&(e.TgZ(0,"app-form-heading"),e._uU(1),e.qZA(),e.TgZ(2,"div",0)(3,"form",1),e.NdJ("submit",function(){return l.attachVehicleDocFile()}),e.TgZ(4,"div",2)(5,"label",3),e._uU(6),e.qZA(),e.TgZ(7,"label",4),e._uU(8),e.qZA()(),e.TgZ(9,"div",5)(10,"mat-form-field",6)(11,"mat-label"),e._uU(12,"Identifier"),e.qZA(),e._UZ(13,"input",7),e.qZA(),e.TgZ(14,"mat-form-field",8)(15,"mat-label"),e._uU(16,"Expiry (dd/mm/yyyy)"),e.qZA(),e._UZ(17,"input",9)(18,"mat-datepicker-toggle",10)(19,"mat-datepicker",null,11),e.qZA()(),e.TgZ(21,"div",5)(22,"div",12)(23,"button",13),e.NdJ("click",function(){return l.onDocSelect()}),e._uU(24,"Select File"),e.qZA(),e._UZ(25,"input",14,15)(27,"label",3,16),e.YNc(29,ai,2,0,"button",17),e.qZA()(),e.TgZ(30,"div",18)(31,"app-crud-button",19),e._uU(32,"Attach"),e.qZA()()()()),2&n){const c=e.MAs(20),r=e.MAs(28);e.xp6(1),e.hij(" Attach Doc File : ",l.data.documentType.name,"\n"),e.xp6(2),e.Q6J("formGroup",l.manageForm),e.xp6(3),e.AsE("",l.data.vehicle.plateNumber," (",l.data.vehicle.code,")"),e.xp6(2),e.AsE("",l.data.vehicle.make," ",l.data.vehicle.model,""),e.xp6(9),e.Q6J("matDatepicker",c),e.xp6(1),e.Q6J("for",c),e.xp6(11),e.Q6J("ngIf",""!=r.textContent),e.xp6(2),e.Q6J("disabled",l.isProcessing||""==r.textContent)}},dependencies:[f.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,h.KE,h.hX,h.R9,b.Nt,S.lW,u.xY,g.Mq,g.hl,g.nW,ii.X,E.H]}),t})();var si=d(7358);function ci(t,o){if(1&t&&e._UZ(0,"app-crud-edit-button",14),2&t){const a=e.oxw();e.Q6J("disabled",a.isProcessing)}}let ri=(()=>{const o=class{constructor(i,n,l,c){this.dialogRef=i,this.vehicleDocService=n,this.ds=l,this.data=c,this.isProcessing=!1}ngOnInit(){let i=null!=this.data.expiryDate?this.ds.responseFormatToDate(this.data.expiryDate):null;this.manageForm=new s.cw({id:new s.NI(this.data.id),identifier:new s.NI(this.data.identifier),expiryDate:new s.NI(i)})}editVehicleDoc(){if(!confirm(A.J.areYouSureTo))return;let i=new si.w;i.id=this.manageForm.value.id,i.identifier=this.manageForm.value.identifier,i.expiryDate=this.ds.formatToRequest(this.manageForm.value.expiryDate),this.isProcessing=!0,this.sub=this.vehicleDocService.editVehicleDoc(i).subscribe(n=>{if(n.status!=T.s.success)return this.isProcessing=!1,void alert(n.message);this.closeDialog()})}closeDialog(){this.dialogRef.close(!0)}ngOnDestroy(){this.sub?.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(u.so),e.Y36(Q.l),e.Y36(y.R),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-edit-vehicle-doc"]],decls:23,vars:9,consts:[["mat-dialog-content","",1,"row"],[1,"my-2",3,"formGroup","submit"],[1,"row","mb-4"],[1,"col-6"],[1,"col-6","text-end"],[1,"row","form-group"],[1,"form-field","col-6"],["type","text","matInput","","formControlName","identifier"],["appearance","outline",1,"col-6","form-field"],["matInput","","formControlName","expiryDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],[1,"row"],["class","col-2 offset-10",3,"disabled",4,"ngIf"],[1,"col-2","offset-10",3,"disabled"]],template:function(n,l){if(1&n&&(e.TgZ(0,"app-form-heading"),e._uU(1),e.qZA(),e.TgZ(2,"div",0)(3,"form",1),e.NdJ("submit",function(){return l.editVehicleDoc()}),e.TgZ(4,"div",2)(5,"label",3),e._uU(6),e.qZA(),e.TgZ(7,"label",4),e._uU(8),e.qZA()(),e.TgZ(9,"div",5)(10,"mat-form-field",6)(11,"mat-label"),e._uU(12,"Identifier"),e.qZA(),e._UZ(13,"input",7),e.qZA(),e.TgZ(14,"mat-form-field",8)(15,"mat-label"),e._uU(16,"Expiry (dd/mm/yyyy)"),e.qZA(),e._UZ(17,"input",9)(18,"mat-datepicker-toggle",10)(19,"mat-datepicker",null,11),e.qZA()(),e.TgZ(21,"div",12),e.YNc(22,ci,1,1,"app-crud-edit-button",13),e.qZA()()()),2&n){const c=e.MAs(20);e.xp6(1),e.hij(" Edit Doc : ",l.data.documentType.name,"\n"),e.xp6(2),e.Q6J("formGroup",l.manageForm),e.xp6(3),e.AsE("",l.data.vehicle.plateNumber," (",l.data.vehicle.code,")"),e.xp6(2),e.AsE("",l.data.vehicle.make," ",l.data.vehicle.model,""),e.xp6(9),e.Q6J("matDatepicker",c),e.xp6(1),e.Q6J("for",c),e.xp6(4),e.Q6J("ngIf",null!=l.data)}},dependencies:[f.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,h.KE,h.hX,h.R9,b.Nt,u.xY,g.Mq,g.hl,g.nW,G.W,E.H]}),t})();const di=["page"];function mi(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," DocType "),e.qZA())}function pi(t,o){1&t&&(e.TgZ(0,"span",25)(1,"i",26),e._uU(2,"attachment"),e.qZA()())}function ui(t,o){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.YNc(2,pi,3,0,"span",24),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.documentType.name," "),e.xp6(1),e.Q6J("ngIf",null!=a.fileName)}}function hi(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," Identifier "),e.qZA())}function _i(t,o){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.identifier," ")}}function fi(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," Expiry (Days) "),e.qZA())}function gi(t,o){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.AsE(" ",a.expiryDate," (",a.expiryDays,") ")}}function vi(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," Code "),e.qZA())}function Zi(t,o){if(1&t&&(e.TgZ(0,"td",23)(1,"span",27),e._uU(2),e.qZA()()),2&t){const a=o.$implicit;e.xp6(2),e.Oqu(a.vehicle.code)}}function wi(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," PlateNumber "),e.qZA())}function Ti(t,o){if(1&t&&(e.TgZ(0,"td",23)(1,"span",27),e._uU(2),e.qZA()()),2&t){const a=o.$implicit;e.xp6(2),e.Oqu(a.vehicle.plateNumber)}}function xi(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," Model "),e.qZA())}function Ci(t,o){if(1&t&&(e.TgZ(0,"td",23)(1,"span",27),e._uU(2),e.qZA()()),2&t){const a=o.$implicit;e.xp6(2),e.AsE("",a.vehicle.make," ",a.vehicle.model,"")}}function Ai(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," Owner "),e.qZA())}function Di(t,o){if(1&t&&(e.TgZ(0,"td",23)(1,"span",27),e._uU(2),e.qZA()()),2&t){const a=o.$implicit;e.xp6(2),e.Oqu(a.vehicle.owner)}}function bi(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," Status "),e.qZA())}function Ii(t,o){1&t&&(e.TgZ(0,"span",31),e._uU(1,"Valid"),e.qZA())}function Ni(t,o){1&t&&(e.TgZ(0,"span",32),e._uU(1,"Expired"),e.qZA())}function yi(t,o){1&t&&(e.TgZ(0,"span",33),e._uU(1,"Near Expiry"),e.qZA())}function qi(t,o){if(1&t&&(e.TgZ(0,"td",23),e.YNc(1,Ii,2,0,"span",28),e.YNc(2,Ni,2,0,"span",29),e.YNc(3,yi,2,0,"span",30),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.Q6J("ngIf",1==a.valid),e.xp6(1),e.Q6J("ngIf",1==a.expired),e.xp6(1),e.Q6J("ngIf",1==a.nearExpiry)}}function Li(t,o){1&t&&e._UZ(0,"th",34)}function Fi(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-edit-action-icon",41),e.NdJ("editEvent",function(){e.CHM(a);const n=e.oxw().$implicit,l=e.oxw();return e.KtG(l.editDoc(n))}),e.qZA()}if(2&t){const a=e.oxw().$implicit;e.Q6J("item",a)}}function Vi(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-view-action-icon",42),e.NdJ("viewEvent",function(n){e.CHM(a);const l=e.oxw(2);return e.KtG(l.viewDoc(n))}),e.qZA()}if(2&t){const a=e.oxw().$implicit;e.Q6J("item",a)}}function Ei(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-download-action-icon",43),e.NdJ("downloadEvent",function(n){e.CHM(a);const l=e.oxw(2);return e.KtG(l.downloadDoc(n))}),e.qZA()}if(2&t){const a=e.oxw().$implicit;e.Q6J("item",a)}}function Ui(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-action-icon",44),e.NdJ("actionEvent",function(n){e.CHM(a);const l=e.oxw(2);return e.KtG(l.removeDocFile(n))}),e._uU(1,"attach_file_off"),e.qZA()}if(2&t){const a=e.oxw().$implicit;e.Q6J("item",a)}}function Ji(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-action-icon",45),e.NdJ("actionEvent",function(n){e.CHM(a);const l=e.oxw(2);return e.KtG(l.attachDocFile(n))}),e._uU(1,"attach_file"),e.qZA()}if(2&t){const a=e.oxw().$implicit;e.Q6J("item",a)}}function Si(t,o){if(1&t&&(e.TgZ(0,"td",35),e.YNc(1,Fi,1,1,"app-edit-action-icon",36),e.YNc(2,Vi,1,1,"app-view-action-icon",37),e.YNc(3,Ei,1,1,"app-download-action-icon",38),e.YNc(4,Ui,2,1,"app-action-icon",39),e.YNc(5,Ji,2,1,"app-action-icon",40),e.qZA()),2&t){const a=o.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.allowEdit),e.xp6(1),e.Q6J("ngIf",null!=a.fileName&&i.allowExport),e.xp6(1),e.Q6J("ngIf",null!=a.fileName&&i.allowExport),e.xp6(1),e.Q6J("ngIf",null!=a.fileName&&i.allowDelete),e.xp6(1),e.Q6J("ngIf",null==a.fileName&&i.allowEdit)}}function Qi(t,o){1&t&&e._UZ(0,"tr",46)}function Yi(t,o){1&t&&e._UZ(0,"tr",47)}const Oi=function(){return[10,20,50]};let Ri=(()=>{const o=class{constructor(i,n){this.menuRoleService=i,this.dialog=n,this.moreEvent=new Z.x,this.displayedColumns=["docType","identifier","expiryDate","code","plateNumber","makeModel","owner","status","manage"],this.baseUrl=(0,D.SV)(),this.allowDelete=!1,this.allowEdit=!1,this.allowExport=!1,this.viewDocEvent=new Z.x,this.downloadDocEvent=new Z.x,this.removeDocFileEvent=new Z.x,this.editDocEvent=new Z.x}ngOnInit(){this.allowDelete=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.VehicleDoc,v.k.delete),this.allowEdit=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.VehicleDoc,v.k.edit),this.allowExport=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.VehicleDoc,v.k.export)}ngOnChanges(i){this.vehicleDocList.paginator=this.paginator}ngAfterViewInit(){this.vehicleDocList.paginator=this.paginator}more(){this.moreEvent.next(!0)}viewDoc(i){this.viewDocEvent.next(i)}downloadDoc(i){this.downloadDocEvent.next(i)}removeDocFile(i){this.removeDocFileEvent.next(i)}attachDocFile(i){this.dialog.open(li,{data:i,width:"40%",maxHeight:"auto"}).afterClosed().subscribe(l=>{1==l&&this.editDocEvent.next()})}editDoc(i){this.dialog.open(ri,{data:i,width:"40%",maxHeight:"auto"}).afterClosed().subscribe(l=>{1==l&&this.editDocEvent.next()})}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(q.K),e.Y36(u.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-vehicle-doc-list"]],viewQuery:function(n,l){if(1&n&&e.Gf(di,5),2&n){let c;e.iGM(c=e.CRH())&&(l.paginator=c.first)}},inputs:{vehicleDocList:"vehicleDocList",count:"count"},outputs:{moreEvent:"moreEvent",viewDocEvent:"viewDocEvent",downloadDocEvent:"downloadDocEvent",removeDocFileEvent:"removeDocFileEvent",editDocEvent:"editDocEvent"},features:[e.TTD],decls:36,vars:7,consts:[[1,"mat-elevation-z8"],["mat-table","",3,"dataSource"],["matColumnDef","docType"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","col",4,"matCellDef"],["matColumnDef","identifier"],["matColumnDef","expiryDate"],["matColumnDef","code"],["matColumnDef","plateNumber"],["matColumnDef","makeModel"],["matColumnDef","owner"],["matColumnDef","status"],["matColumnDef","manage"],["mat-header-cell","","class","text-end",4,"matHeaderCellDef"],["mat-cell","","class","col text-end",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","",3,"pageSizeOptions"],["page",""],[1,"row"],[1,"col-6"],[3,"loaded","count","loadMore"],["mat-header-cell",""],["mat-cell","",1,"col"],["class","ms-3",4,"ngIf"],[1,"ms-3"],[1,"material-icons","text-success"],[1,"ms-2"],["class","bg-success p-2 text-light rounded-pill",4,"ngIf"],["class","bg-warn p-2 text-light rounded-pill",4,"ngIf"],["class","bg-accent p-2 text-dark rounded-pill",4,"ngIf"],[1,"bg-success","p-2","text-light","rounded-pill"],[1,"bg-warn","p-2","text-light","rounded-pill"],[1,"bg-accent","p-2","text-dark","rounded-pill"],["mat-header-cell","",1,"text-end"],["mat-cell","",1,"col","text-end"],[3,"item","editEvent",4,"ngIf"],[3,"item","viewEvent",4,"ngIf"],[3,"item","downloadEvent",4,"ngIf"],["color","accent",3,"item","actionEvent",4,"ngIf"],[3,"item","actionEvent",4,"ngIf"],[3,"item","editEvent"],[3,"item","viewEvent"],[3,"item","downloadEvent"],["color","accent",3,"item","actionEvent"],[3,"item","actionEvent"],["mat-header-row",""],["mat-row",""]],template:function(n,l){1&n&&(e.TgZ(0,"div",0)(1,"table",1),e.ynx(2,2),e.YNc(3,mi,2,0,"th",3),e.YNc(4,ui,3,2,"td",4),e.BQk(),e.ynx(5,5),e.YNc(6,hi,2,0,"th",3),e.YNc(7,_i,2,1,"td",4),e.BQk(),e.ynx(8,6),e.YNc(9,fi,2,0,"th",3),e.YNc(10,gi,2,2,"td",4),e.BQk(),e.ynx(11,7),e.YNc(12,vi,2,0,"th",3),e.YNc(13,Zi,3,1,"td",4),e.BQk(),e.ynx(14,8),e.YNc(15,wi,2,0,"th",3),e.YNc(16,Ti,3,1,"td",4),e.BQk(),e.ynx(17,9),e.YNc(18,xi,2,0,"th",3),e.YNc(19,Ci,3,2,"td",4),e.BQk(),e.ynx(20,10),e.YNc(21,Ai,2,0,"th",3),e.YNc(22,Di,3,1,"td",4),e.BQk(),e.ynx(23,11),e.YNc(24,bi,2,0,"th",3),e.YNc(25,qi,4,3,"td",4),e.BQk(),e.ynx(26,12),e.YNc(27,Li,1,0,"th",13),e.YNc(28,Si,6,5,"td",14),e.BQk(),e.YNc(29,Qi,1,0,"tr",15),e.YNc(30,Yi,1,0,"tr",16),e.qZA(),e._UZ(31,"mat-paginator",17,18),e.qZA(),e.TgZ(33,"div",19)(34,"div",20)(35,"app-server-pagination",21),e.NdJ("loadMore",function(){return l.more()}),e.qZA()()()),2&n&&(e.xp6(1),e.Q6J("dataSource",l.vehicleDocList),e.xp6(28),e.Q6J("matHeaderRowDef",l.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",l.displayedColumns),e.xp6(1),e.Q6J("pageSizeOptions",e.DdM(6,Oi)),e.xp6(4),e.Q6J("loaded",l.vehicleDocList.data.length)("count",l.count))},dependencies:[f.O5,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,H.NW,$.H,z.p,j.R,oe.e,se.m]}),t})();function ki(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-vehicle-doc-search-filter",3),e.NdJ("onSearchChange",function(n){e.CHM(a);const l=e.oxw();return e.KtG(l.changeSearchData(n))})("onSearch",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.getList())}),e.qZA()}if(2&t){const a=e.oxw();e.Q6J("searchData",a.searchData)}}function Mi(t,o){1&t&&(e.TgZ(0,"div",4)(1,"app-table-heading",5),e._uU(2," Vehicle Doc "),e.qZA()())}function Gi(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-vehicle-doc-list",6),e.NdJ("moreEvent",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.getList())})("viewDocEvent",function(n){e.CHM(a);const l=e.oxw();return e.KtG(l.viewDoc(n))})("downloadDocEvent",function(n){e.CHM(a);const l=e.oxw();return e.KtG(l.downloadDoc(n))})("removeDocFileEvent",function(n){e.CHM(a);const l=e.oxw();return e.KtG(l.removeDocFile(n))})("editDocEvent",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.refreshList())}),e.qZA()}if(2&t){const a=e.oxw();e.Q6J("vehicleDocList",a.dataSource)("count",a.count)}}let Ki=(()=>{const o=class{constructor(i,n,l,c){this.vehicleDocService=i,this.vehicleService=n,this.fileService=l,this.menuRoleService=c,this.isLoaded=!1,this.req=new zt,this.eList=[],this.count=0,this.viewFleet=!1}ngOnInit(){this.isLoaded=!1,this.sub=this.vehicleDocService.getVehicleDocSearchData().pipe((0,N.w)(i=>(this.searchData=i.item,this.isLoaded=!0,this.dataSource=new m.by(this.eList),this.req.pagination.pageSize=10,this.vehicleDocService.getVehicleDocList(this.req)))).subscribe(i=>{this.viewFleet=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.Fleet,v.k.view),this.update(i)})}ngAfterViewInit(){}changeSearchData(i){console.log(i),this.eList=[],this.dataSource=new m.by(this.eList),this.req.searchKey=i.searchKey,this.req.docTypeId=""!=i.docTypeId?i.docTypeId:null,this.req.mode=i.mode,this.req.expiryDays=i.expiryDays,this.req.ownerId=""!=i.ownerId?i.ownerId:null,this.req.pagination.pageNumber=1}refreshList(){this.eList=[],this.dataSource=new m.by(this.eList),this.req.pagination.pageNumber=1,this.getList()}update(i){i?.response?.status==T.s.success&&(this.eList.push.apply(this.eList,i.list),this.dataSource=new m.by(this.eList),this.count=i.totalRecords,i.list.length>0&&(this.req.pagination.pageNumber+=1))}getList(){this.sub=this.vehicleDocService.getVehicleDocList(this.req).subscribe(i=>{this.update(i)})}viewDoc(i){var n=this;this.sub=this.vehicleDocService.exportVehicleDoc(i.id).subscribe(function(){var l=(0,K.Z)(function*(c){n.fileService.viewFile(c)});return function(c){return l.apply(this,arguments)}}())}downloadDoc(i){var n=this;let l=this.searchData.docTypeList.find(r=>r.id==i.documentType.id),c=`${i.vehicle.code}_${l.code}`;null!=i.identifier&&(c=`${c}_${i.identifier}`),this.sub=this.vehicleDocService.exportVehicleDoc(i.id).subscribe(function(){var r=(0,K.Z)(function*(p){n.fileService.downloadFile(p,c)});return function(p){return r.apply(this,arguments)}}())}removeDocFile(i){confirm(A.J.confirmRemove("file"))&&(this.sub=this.vehicleDocService.removeVehicleDocFile(i.id).subscribe(n=>{this.refreshList()}))}ngOnDestroy(){this.sub?.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(Q.l),e.Y36(L.f),e.Y36(ne.I),e.Y36(q.K))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-vehicle-doc"]],decls:3,vars:3,consts:[[3,"searchData","onSearchChange","onSearch",4,"ngIf"],["class","row",4,"ngIf"],[3,"vehicleDocList","count","moreEvent","viewDocEvent","downloadDocEvent","removeDocFileEvent","editDocEvent",4,"ngIf"],[3,"searchData","onSearchChange","onSearch"],[1,"row"],[1,"col-6"],[3,"vehicleDocList","count","moreEvent","viewDocEvent","downloadDocEvent","removeDocFileEvent","editDocEvent"]],template:function(n,l){1&n&&(e.YNc(0,ki,1,1,"app-vehicle-doc-search-filter",0),e.YNc(1,Mi,3,0,"div",1),e.YNc(2,Gi,1,2,"app-vehicle-doc-list",2)),2&n&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[f.O5,M.u,ti,Ri]}),t})();class Hi extends J.G{}const $i=["page"];function Bi(t,o){1&t&&(e.TgZ(0,"th",20),e._uU(1," Code "),e.qZA())}function Pi(t,o){if(1&t&&(e.TgZ(0,"td",21)(1,"span",22),e._uU(2),e.qZA()()),2&t){const a=o.$implicit;e.xp6(2),e.Oqu(a.vehicle.code)}}function ji(t,o){1&t&&(e.TgZ(0,"th",20),e._uU(1," PlateNumber "),e.qZA())}function zi(t,o){if(1&t&&(e.TgZ(0,"td",21)(1,"span",22),e._uU(2),e.qZA()()),2&t){const a=o.$implicit;e.xp6(2),e.Oqu(a.vehicle.plateNumber)}}function Xi(t,o){1&t&&(e.TgZ(0,"th",20),e._uU(1," Model "),e.qZA())}function Wi(t,o){if(1&t&&(e.TgZ(0,"td",21)(1,"span",22),e._uU(2),e.qZA()()),2&t){const a=o.$implicit;e.xp6(2),e.AsE("",a.vehicle.make," ",a.vehicle.model,"")}}function en(t,o){1&t&&(e.TgZ(0,"th",20),e._uU(1," Owner "),e.qZA())}function tn(t,o){if(1&t&&(e.TgZ(0,"td",21)(1,"span",22),e._uU(2),e.qZA()()),2&t){const a=o.$implicit;e.xp6(2),e.Oqu(a.vehicle.owner)}}function nn(t,o){1&t&&(e.TgZ(0,"th",20),e._uU(1," Reading "),e.qZA())}function on(t,o){if(1&t&&(e.TgZ(0,"td",21)(1,"span",22),e._uU(2),e.qZA()()),2&t){const a=o.$implicit;e.xp6(2),e.Oqu(a.reading)}}function an(t,o){1&t&&(e.TgZ(0,"th",20),e._uU(1," Timestamp "),e.qZA())}function ln(t,o){if(1&t&&(e.TgZ(0,"td",21)(1,"span",22),e._uU(2),e.qZA()()),2&t){const a=o.$implicit;e.xp6(2),e.Oqu(a.timestamp)}}function sn(t,o){1&t&&e._UZ(0,"th",23)}function cn(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-delete-action-icon",26),e.NdJ("deleteEvent",function(){e.CHM(a);const n=e.oxw().$implicit,l=e.oxw();return e.KtG(l.delete(n))}),e.qZA()}if(2&t){const a=e.oxw().$implicit;e.Q6J("item",a)}}function rn(t,o){if(1&t&&(e.TgZ(0,"td",24),e.YNc(1,cn,1,1,"app-delete-action-icon",25),e.qZA()),2&t){const a=e.oxw();e.xp6(1),e.Q6J("ngIf",a.allowDelete)}}function dn(t,o){1&t&&e._UZ(0,"tr",27)}function mn(t,o){1&t&&e._UZ(0,"tr",28)}const pn=function(){return[10,20,50]};let un=(()=>{const o=class{constructor(i,n){this.menuRoleService=i,this.dialog=n,this.moreEvent=new Z.x,this.displayedColumns=["code","plateNumber","makeModel","owner","reading","timestamp","manage"],this.baseUrl=(0,D.SV)(),this.allowEdit=!1,this.allowDelete=!1,this.editEvent=new Z.x,this.deleteEvent=new Z.x}ngOnInit(){this.allowEdit=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.OdometerReading_Fleet,v.k.edit),this.allowDelete=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.OdometerReading_Fleet,v.k.delete)}ngOnChanges(i){this.omrList.paginator=this.paginator}ngAfterViewInit(){this.omrList.paginator=this.paginator}more(){this.moreEvent.next(!0)}edit(i){this.editEvent.next()}delete(i){this.deleteEvent.next(i)}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(q.K),e.Y36(u.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-odometer-reading-list"]],viewQuery:function(n,l){if(1&n&&e.Gf($i,5),2&n){let c;e.iGM(c=e.CRH())&&(l.paginator=c.first)}},inputs:{omrList:"omrList",count:"count"},outputs:{moreEvent:"moreEvent",editEvent:"editEvent",deleteEvent:"deleteEvent"},features:[e.TTD],decls:30,vars:7,consts:[[1,"mat-elevation-z8"],["mat-table","",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","col",4,"matCellDef"],["matColumnDef","plateNumber"],["matColumnDef","makeModel"],["matColumnDef","owner"],["matColumnDef","reading"],["matColumnDef","timestamp"],["matColumnDef","manage"],["mat-header-cell","","class","text-end",4,"matHeaderCellDef"],["mat-cell","","class","col text-end",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","",3,"pageSizeOptions"],["page",""],[1,"row"],[1,"col-6"],[3,"loaded","count","loadMore"],["mat-header-cell",""],["mat-cell","",1,"col"],[1,"ms-2"],["mat-header-cell","",1,"text-end"],["mat-cell","",1,"col","text-end"],[3,"item","deleteEvent",4,"ngIf"],[3,"item","deleteEvent"],["mat-header-row",""],["mat-row",""]],template:function(n,l){1&n&&(e.TgZ(0,"div",0)(1,"table",1),e.ynx(2,2),e.YNc(3,Bi,2,0,"th",3),e.YNc(4,Pi,3,1,"td",4),e.BQk(),e.ynx(5,5),e.YNc(6,ji,2,0,"th",3),e.YNc(7,zi,3,1,"td",4),e.BQk(),e.ynx(8,6),e.YNc(9,Xi,2,0,"th",3),e.YNc(10,Wi,3,2,"td",4),e.BQk(),e.ynx(11,7),e.YNc(12,en,2,0,"th",3),e.YNc(13,tn,3,1,"td",4),e.BQk(),e.ynx(14,8),e.YNc(15,nn,2,0,"th",3),e.YNc(16,on,3,1,"td",4),e.BQk(),e.ynx(17,9),e.YNc(18,an,2,0,"th",3),e.YNc(19,ln,3,1,"td",4),e.BQk(),e.ynx(20,10),e.YNc(21,sn,1,0,"th",11),e.YNc(22,rn,2,1,"td",12),e.BQk(),e.YNc(23,dn,1,0,"tr",13),e.YNc(24,mn,1,0,"tr",14),e.qZA(),e._UZ(25,"mat-paginator",15,16),e.qZA(),e.TgZ(27,"div",17)(28,"div",18)(29,"app-server-pagination",19),e.NdJ("loadMore",function(){return l.more()}),e.qZA()()()),2&n&&(e.xp6(1),e.Q6J("dataSource",l.omrList),e.xp6(22),e.Q6J("matHeaderRowDef",l.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",l.displayedColumns),e.xp6(1),e.Q6J("pageSizeOptions",e.DdM(6,pn)),e.xp6(4),e.Q6J("loaded",l.omrList.data.length)("count",l.count))},dependencies:[f.O5,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,H.NW,$.H,Y.b]}),t})();function hn(t,o){if(1&t&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function _n(t,o){if(1&t&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function fn(t,o){if(1&t&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function gn(t,o){if(1&t&&(e.TgZ(0,"mat-option",17),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.AsE("",a.code," - (",a.plateNumber,")")}}let vn=(()=>{const o=class{constructor(i){this.vehicleService=i,this.vehicleList=[],this.onSearchChange=new Z.x,this.onSearch=new Z.x,this.modelListFiltered=[],this.vehicleListFiltered=[]}ngOnInit(){this.filterForm=new s.cw({searchKey:new s.NI(""),makeId:new s.NI(""),modelId:new s.NI(""),ownerId:new s.NI(""),vehicleId:new s.NI("")}),this.valueChangeSub=this.filterForm.valueChanges.subscribe(i=>{this.onSearchChange.next(i)})}search(){this.onSearch.next()}resetFilter(){this.filterForm.patchValue({searchKey:"",makeId:"",modelId:"",ownerId:"",vehicleId:""})}onMakeChange(i){this.modelListFiltered=this.searchData.modelList.filter(l=>l.make.id==this.filterForm.value.makeId)??[];let n=this.searchData.makeList.find(l=>l.id==this.filterForm.value.makeId)?.name??"";this.vehicleListFiltered=this.vehicleList.filter(l=>l.make==n||""==n)??[],this.filterForm.patchValue({modelId:"",vehicleId:""})}onModelChange(i){let n=this.searchData.makeList.find(c=>c.id==this.filterForm.value.makeId)?.name??"",l=this.searchData.modelList.find(c=>c.id==this.filterForm.value.modelId)?.name??"";this.vehicleListFiltered=this.vehicleList.filter(c=>!(c.make!=n&&""!=n||c.model!=l&&""!=l))??[],this.filterForm.patchValue({vehicleId:""})}onOwnerChange(i){this.vehicleList=[],this.vehicleListFiltered=[],""!=this.filterForm.value.ownerId?(this.sub=this.vehicleService.getVehicleListByOwner(this.filterForm.value.ownerId).subscribe(n=>{this.vehicleList=n.list;let l=this.searchData.makeList.find(r=>r.id==this.filterForm.value.makeId)?.name??"",c=this.searchData.modelList.find(r=>r.id==this.filterForm.value.modelId)?.name??"";this.vehicleListFiltered=this.vehicleList.filter(r=>!(r.make!=l&&""!=l||r.model!=c&&""!=c))??[]}),this.filterForm.patchValue({vehicleId:""})):this.filterForm.patchValue({vehicleId:""})}ngOnDestroy(){this.sub?.unsubscribe(),this.valueChangeSub.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(L.f))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-odometer-reading-search-filter"]],inputs:{searchData:"searchData"},outputs:{onSearchChange:"onSearchChange",onSearch:"onSearch"},decls:41,vars:5,consts:[[1,"mt-4",3,"formGroup","ngSubmit"],[1,"row","form-group"],["type","button","mat-button","","color","primary",1,"col-1","offset-0","mt-2",3,"click"],[1,"form-field","col-1"],["formControlName","makeId",3,"selectionChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-field","col-2"],["formControlName","modelId",3,"selectionChange"],[1,"form-field","col-3"],["formControlName","ownerId",3,"selectionChange"],["formControlName","vehicleId"],["appearance","outline","floatLabel","always",1,"form-field","col-2"],["type","search","placeholder","","matInput","","formControlName","searchKey"],[1,"col-1"],["type","submit","mat-raised-button","","color","primary",1,"col-12","offset-0","mt-2"],[1,"material-icons"],[3,"value"]],template:function(n,l){1&n&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return l.search()}),e.TgZ(1,"div",1)(2,"button",2),e.NdJ("click",function(){return l.resetFilter()}),e._uU(3,"Reset"),e.qZA(),e.TgZ(4,"mat-form-field",3)(5,"mat-label"),e._uU(6,"Make"),e.qZA(),e.TgZ(7,"mat-select",4),e.NdJ("selectionChange",function(r){return l.onMakeChange(r)}),e.TgZ(8,"mat-option",5),e._uU(9,"All"),e.qZA(),e.YNc(10,hn,2,2,"mat-option",6),e.qZA()(),e.TgZ(11,"mat-form-field",7)(12,"mat-label"),e._uU(13,"Model"),e.qZA(),e.TgZ(14,"mat-select",8),e.NdJ("selectionChange",function(r){return l.onModelChange(r)}),e.TgZ(15,"mat-option",5),e._uU(16,"All"),e.qZA(),e.YNc(17,_n,2,2,"mat-option",6),e.qZA()(),e.TgZ(18,"mat-form-field",9)(19,"mat-label"),e._uU(20,"Owner"),e.qZA(),e.TgZ(21,"mat-select",10),e.NdJ("selectionChange",function(r){return l.onOwnerChange(r)}),e.TgZ(22,"mat-option",5),e._uU(23,"All"),e.qZA(),e.YNc(24,fn,2,2,"mat-option",6),e.qZA()(),e.TgZ(25,"mat-form-field",7)(26,"mat-label"),e._uU(27,"Vehicle"),e.qZA(),e.TgZ(28,"mat-select",11)(29,"mat-option",5),e._uU(30,"All"),e.qZA(),e.YNc(31,gn,2,3,"mat-option",6),e.qZA()(),e.TgZ(32,"mat-form-field",12)(33,"mat-label"),e._uU(34,"Search"),e.qZA(),e._UZ(35,"input",13),e.qZA(),e.TgZ(36,"div",14)(37,"button",15)(38,"i",16),e._uU(39,"search"),e.qZA(),e._uU(40," Search"),e.qZA()()()()),2&n&&(e.Q6J("formGroup",l.filterForm),e.xp6(10),e.Q6J("ngForOf",l.searchData.makeList),e.xp6(7),e.Q6J("ngForOf",l.modelListFiltered),e.xp6(7),e.Q6J("ngForOf",l.searchData.ownerList),e.xp6(7),e.Q6J("ngForOf",l.vehicleListFiltered))},dependencies:[f.sg,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,h.KE,h.hX,b.Nt,S.lW,F.gD,V.ey]}),t})();function Zn(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-odometer-reading-search-filter",3),e.NdJ("onSearchChange",function(n){e.CHM(a);const l=e.oxw();return e.KtG(l.changeSearchData(n))})("onSearch",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.getList())}),e.qZA()}if(2&t){const a=e.oxw();e.Q6J("searchData",a.searchData)}}function wn(t,o){1&t&&(e.TgZ(0,"div",4)(1,"app-table-heading",5),e._uU(2," Odometer Reading "),e.qZA()())}function Tn(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-odometer-reading-list",6),e.NdJ("moreEvent",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.getList())})("editEvent",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.refreshList())})("deleteEvent",function(n){e.CHM(a);const l=e.oxw();return e.KtG(l.delete(n))}),e.qZA()}if(2&t){const a=e.oxw();e.Q6J("omrList",a.dataSource)("count",a.count)}}let xn=(()=>{const o=class{constructor(i,n,l,c){this.menuRoleService=i,this.vehicleService=n,this.odometerReadingService=l,this.dialog=c,this.isLoaded=!1,this.req=new Hi,this.eList=[],this.count=0}ngOnInit(){this.isLoaded=!1,this.sub=this.vehicleService.getVehicleSearchData().pipe((0,N.w)(i=>(this.searchData=i.item,this.isLoaded=!0,this.dataSource=new m.by(this.eList),this.req.pagination.pageSize=10,this.odometerReadingService.getOdometerReadingList(this.req)))).subscribe(i=>{this.update(i)})}ngAfterViewInit(){}changeSearchData(i){console.log(i),this.eList=[],this.dataSource=new m.by(this.eList),this.req.searchKey=i.searchKey,this.req.makeId=""!=i.makeId?i.makeId:null,this.req.modelId=""!=i.modelId?i.modelId:null,this.req.ownerId=""!=i.ownerId?i.ownerId:null,this.req.vehicleId=""!=i.vehicleId?i.vehicleId:null,this.req.pagination.pageNumber=1}refreshList(){this.eList=[],this.dataSource=new m.by(this.eList),this.req.pagination.pageNumber=1,this.getList()}update(i){i?.response?.status==T.s.success&&(this.eList.push.apply(this.eList,i.list),this.dataSource=new m.by(this.eList),this.count=i.totalRecords,i.list.length>0&&(this.req.pagination.pageNumber+=1))}getList(){this.sub=this.odometerReadingService.getOdometerReadingList(this.req).subscribe(i=>{this.update(i)})}delete(i){confirm(A.J.areYouSureTo)&&(this.sub=this.odometerReadingService.deleteOdometerReading(i.id).subscribe(n=>{n?.status==T.s.success?this.refreshList():alert(n?.message)}))}ngOnDestroy(){this.sub?.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(q.K),e.Y36(L.f),e.Y36(le),e.Y36(u.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-odometer-reading"]],decls:3,vars:3,consts:[[3,"searchData","onSearchChange","onSearch",4,"ngIf"],["class","row",4,"ngIf"],[3,"omrList","count","moreEvent","editEvent","deleteEvent",4,"ngIf"],[3,"searchData","onSearchChange","onSearch"],[1,"row"],[1,"col-6"],[3,"omrList","count","moreEvent","editEvent","deleteEvent"]],template:function(n,l){1&n&&(e.YNc(0,Zn,1,1,"app-odometer-reading-search-filter",0),e.YNc(1,wn,3,0,"div",1),e.YNc(2,Tn,1,2,"app-odometer-reading-list",2)),2&n&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[f.O5,M.u,un,vn]}),t})();var Cn=d(5086);class An extends Cn.i{}class Dn{}let X=(()=>{const o=class{constructor(i){this.http=i}getVehicleAssignList(i){return this.http.post(D.bU.getVehicleAssignList,i)}getVehicleAssignSearchData(){return this.http.get(D.bU.getVehicleAssignSearchData)}getVehicleAssignManageData(){return this.http.get(D.bU.getVehicleAssignManageData)}addVehicleAssign(i){return this.http.post(D.bU.addVehicleAssign,i)}editVehicleAssign(i){return this.http.post(D.bU.editVehicleAssign,i)}deleteVehicleAssign(i){let n=D.bU.deleteVehicleAssign;return n=n.replace(/{id}/gi,i),this.http.post(n,null)}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.LFG(ae.o))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),t})();function bn(t,o){1&t&&(e.TgZ(0,"app-form-heading"),e._uU(1," Add Vehicle Assign\n"),e.qZA())}function In(t,o){if(1&t&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function Nn(t,o){if(1&t&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.AsE("",a.code," - (",a.plateNumber,")")}}function yn(t,o){if(1&t&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.AsE("",a.name," - ",a.licenseNumber,"")}}function qn(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"div",2)(1,"form",3),e.NdJ("submit",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.addVehicleAssign())}),e.TgZ(2,"div",4)(3,"mat-form-field",5)(4,"mat-label"),e._uU(5,"Owner"),e.qZA(),e.TgZ(6,"mat-select",6),e.NdJ("selectionChange",function(n){e.CHM(a);const l=e.oxw();return e.KtG(l.onOwnerChange(n))}),e.TgZ(7,"mat-option",7),e._uU(8,"All"),e.qZA(),e.YNc(9,In,2,2,"mat-option",8),e.qZA()()(),e.TgZ(10,"div",4)(11,"mat-form-field",5)(12,"mat-label"),e._uU(13,"Vehicle"),e.qZA(),e.TgZ(14,"mat-select",9),e.YNc(15,Nn,2,3,"mat-option",8),e.qZA()()(),e.TgZ(16,"div",4)(17,"mat-form-field",5)(18,"mat-label"),e._uU(19,"Driver"),e.qZA(),e.TgZ(20,"mat-select",10),e.YNc(21,yn,2,3,"mat-option",8),e.qZA()()(),e.TgZ(22,"div",4)(23,"mat-form-field",11)(24,"mat-label"),e._uU(25,"Start"),e.qZA(),e._UZ(26,"input",12)(27,"mat-datepicker-toggle",13)(28,"mat-datepicker",null,14),e.qZA(),e.TgZ(30,"mat-form-field",11)(31,"mat-label"),e._uU(32,"End"),e.qZA(),e._UZ(33,"input",15)(34,"mat-datepicker-toggle",16)(35,"mat-datepicker",null,17),e.qZA()(),e.TgZ(37,"div",4)(38,"mat-form-field",5)(39,"mat-label"),e._uU(40,"Note"),e.qZA(),e._UZ(41,"input",18),e.qZA()(),e.TgZ(42,"div",19)(43,"app-crud-reset-button",20),e.NdJ("resetEvent",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.reset())}),e.qZA(),e._UZ(44,"app-crud-add-button",21),e.qZA()()()}if(2&t){const a=e.MAs(29),i=e.MAs(36),n=e.oxw();e.xp6(1),e.Q6J("formGroup",n.manageForm),e.xp6(8),e.Q6J("ngForOf",n.manageData.ownerList),e.xp6(6),e.Q6J("ngForOf",n.vehicleListFiltered),e.xp6(6),e.Q6J("ngForOf",n.manageData.driverList),e.xp6(5),e.Q6J("matDatepicker",a),e.xp6(1),e.Q6J("for",a),e.xp6(6),e.Q6J("matDatepicker",i),e.xp6(1),e.Q6J("for",i)}}let Ln=(()=>{const o=class{constructor(i,n,l,c,r){this.dialogRef=i,this.vehicleAssignService=n,this.ds=l,this.renderer=c,this.data=r,this.isLoaded=!1,this.ownerListFiltered=[],this.vehicleListFiltered=[]}ngOnInit(){this.manageForm=new s.cw({startDate:new s.NI(null,[s.kI.required]),endDate:new s.NI(null),ownerId:new s.NI(""),vehicleId:new s.NI(null,[s.kI.required]),driverId:new s.NI(null,[s.kI.required]),note:new s.NI(null)}),this.manageForm.patchValue({start:this.ds.formatToRequest(new Date)}),this.isLoaded=!1,this.sub=this.vehicleAssignService.getVehicleAssignManageData().subscribe(i=>{this.manageData=i.item,this.vehicleListFiltered=this.manageData.vehicleList,this.isLoaded=!0})}addVehicleAssign(){if(!this.manageForm.valid)return void this.manageForm.markAllAsTouched();if(!confirm(A.J.areYouSureTo))return;let i=new Dn;i.startDate=this.ds.formatToRequestDatetime(this.manageForm.value.startDate),null!=this.manageForm.value.endDate&&(i.endDate=this.ds.formatToRequestDatetime(this.manageForm.value.endDate)),i.vehicleId=this.manageForm.value.vehicleId,i.driverId=this.manageForm.value.driverId,i.note=this.manageForm.value.note,this.sub=this.vehicleAssignService.addVehicleAssign(i).subscribe(n=>{n?.status==T.s.success?(this.reset(),this.closeDialog()):alert(n?.message)})}onOwnerChange(i){this.vehicleListFiltered=[],this.manageForm.patchValue({vehicleId:null});let n=this.manageData.ownerList.find(l=>l.id==this.manageForm.value.ownerId);this.vehicleListFiltered=""==this.manageForm.value.ownerId?this.manageData.vehicleList:this.manageData.vehicleList.filter(l=>l.owner==n?.name)}reset(){this.manageForm.reset()}closeDialog(){this.dialogRef.close(!0)}onKey(i){this.ownerListFiltered=this.manageData.ownerList.filter(n=>n.name.toLowerCase().includes(i.target.value))}ngOnDestroy(){this.sub?.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(u.so),e.Y36(X),e.Y36(y.R),e.Y36(e.Qsj),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-vehicle-assign"]],decls:2,vars:2,consts:[[4,"ngIf"],["mat-dialog-content","","class","row",4,"ngIf"],["mat-dialog-content","",1,"row"],[1,"my-2",3,"formGroup","submit"],[1,"row","form-group"],[1,"form-field","col-12"],["formControlName","ownerId",3,"selectionChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","vehicleId"],["formControlName","driverId"],["appearance","outline",1,"col-6","form-field"],["matInput","","formControlName","startDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],["matInput","","formControlName","endDate",3,"matDatepicker"],["matSuffix","","matIconSuffix","",3,"for"],["picker2",""],["type","text","matInput","","formControlName","note"],[1,"row"],[1,"col-2",3,"resetEvent"],[1,"col-2","offset-8"],[3,"value"]],template:function(n,l){1&n&&(e.YNc(0,bn,2,0,"app-form-heading",0),e.YNc(1,qn,45,8,"div",1)),2&n&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[f.sg,f.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,h.KE,h.hX,h.R9,b.Nt,u.xY,F.gD,V.ey,g.Mq,g.hl,g.nW,P.L,k.X,E.H]}),t})();function Fn(t,o){if(1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function Vn(t,o){if(1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.AsE("",a.code," - (",a.plateNumber,")")}}function En(t,o){if(1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.AsE("",a.name," - ",a.licenseNumber,"")}}let Un=(()=>{const o=class{constructor(i){this.ds=i,this.onSearchChange=new Z.x,this.onSearch=new Z.x,this.vehicleListFiltered=[]}ngOnInit(){this.filterForm=new s.cw({from:new s.NI(null,[s.kI.required]),to:new s.NI(null,[s.kI.required]),searchKey:new s.NI(""),ownerId:new s.NI(""),vehicleId:new s.NI(""),driverId:new s.NI("")}),this.vehicleListFiltered=this.searchData.vehicleList,this.filterForm.patchValue({from:this.ds.formatToRequest(this.ds.monthStart(new Date)),to:this.ds.formatToRequest(new Date)}),this.valueChangeSub=this.filterForm.valueChanges.subscribe(i=>{this.onSearchChange.next(i)})}search(){this.onSearch.next()}resetFilter(){this.filterForm.patchValue({from:this.ds.formatToRequest(this.ds.monthStart(new Date)),to:this.ds.formatToRequest(new Date),searchKey:"",ownerId:"",vehicleId:"",driverId:""})}onOwnerChange(i){this.vehicleListFiltered=[],this.filterForm.patchValue({vehicleId:""});let n=this.searchData.ownerList.find(l=>l.id==this.filterForm.value.ownerId);this.vehicleListFiltered=""==this.filterForm.value.ownerId?this.searchData.vehicleList:this.searchData.vehicleList.filter(l=>l.owner==n?.name)}ngOnDestroy(){this.valueChangeSub.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(y.R))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-vehicle-assign-search-filter"]],inputs:{searchData:"searchData"},outputs:{onSearchChange:"onSearchChange",onSearch:"onSearch"},decls:48,vars:8,consts:[[1,"mt-4",3,"formGroup","ngSubmit"],[1,"row","form-group"],["type","button","mat-button","","color","primary",1,"col-1","mt-2",3,"click"],[1,"form-field","col-2"],["formControlName","ownerId",3,"selectionChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","vehicleId"],["formControlName","driverId"],["appearance","outline",1,"col","form-field"],["matInput","","formControlName","from",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],["matInput","","formControlName","to",3,"matDatepicker"],["picker1",""],["appearance","outline","floatLabel","always",1,"form-field","col"],["type","search","placeholder","","matInput","","formControlName","searchKey"],[1,"col-1"],["type","submit","mat-raised-button","","color","primary",1,"col-12","offset-0","mt-2"],[1,"material-icons"],[3,"value"]],template:function(n,l){if(1&n&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return l.search()}),e.TgZ(1,"div",1)(2,"button",2),e.NdJ("click",function(){return l.resetFilter()}),e._uU(3,"Reset"),e.qZA(),e.TgZ(4,"mat-form-field",3)(5,"mat-label"),e._uU(6,"Owner"),e.qZA(),e.TgZ(7,"mat-select",4),e.NdJ("selectionChange",function(r){return l.onOwnerChange(r)}),e.TgZ(8,"mat-option",5),e._uU(9,"All"),e.qZA(),e.YNc(10,Fn,2,2,"mat-option",6),e.qZA()(),e.TgZ(11,"mat-form-field",3)(12,"mat-label"),e._uU(13,"Vehicle"),e.qZA(),e.TgZ(14,"mat-select",7)(15,"mat-option",5),e._uU(16,"All"),e.qZA(),e.YNc(17,Vn,2,3,"mat-option",6),e.qZA()(),e.TgZ(18,"mat-form-field",3)(19,"mat-label"),e._uU(20,"Driver"),e.qZA(),e.TgZ(21,"mat-select",8)(22,"mat-option",5),e._uU(23,"All"),e.qZA(),e.YNc(24,En,2,3,"mat-option",6),e.qZA()(),e.TgZ(25,"mat-form-field",9)(26,"mat-label"),e._uU(27,"From"),e.qZA(),e._UZ(28,"input",10)(29,"mat-datepicker-toggle",11)(30,"mat-datepicker",null,12),e.qZA(),e.TgZ(32,"mat-form-field",9)(33,"mat-label"),e._uU(34,"To"),e.qZA(),e._UZ(35,"input",13)(36,"mat-datepicker-toggle",11)(37,"mat-datepicker",null,14),e.qZA(),e.TgZ(39,"mat-form-field",15)(40,"mat-label"),e._uU(41,"Search"),e.qZA(),e._UZ(42,"input",16),e.qZA(),e.TgZ(43,"div",17)(44,"button",18)(45,"i",19),e._uU(46,"search"),e.qZA(),e._uU(47," Search"),e.qZA()()()()),2&n){const c=e.MAs(31),r=e.MAs(38);e.Q6J("formGroup",l.filterForm),e.xp6(10),e.Q6J("ngForOf",l.searchData.ownerList),e.xp6(7),e.Q6J("ngForOf",l.vehicleListFiltered),e.xp6(7),e.Q6J("ngForOf",l.searchData.driverList),e.xp6(4),e.Q6J("matDatepicker",c),e.xp6(1),e.Q6J("for",c),e.xp6(6),e.Q6J("matDatepicker",r),e.xp6(1),e.Q6J("for",r)}},dependencies:[f.sg,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,h.KE,h.hX,h.R9,b.Nt,S.lW,F.gD,V.ey,g.Mq,g.hl,g.nW]}),t})();class Jn{}function Sn(t,o){1&t&&(e.TgZ(0,"app-form-heading"),e._uU(1," Edit Vehicle Assign\n"),e.qZA())}function Qn(t,o){if(1&t&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.name)}}function Yn(t,o){if(1&t&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.AsE("",a.code," - (",a.plateNumber,")")}}function On(t,o){if(1&t&&(e.TgZ(0,"mat-option",22),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.Q6J("value",a.id),e.xp6(1),e.AsE("",a.name," - ",a.licenseNumber,"")}}function Rn(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"div",2)(1,"form",3),e.NdJ("submit",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.editVehicleAssign())}),e.TgZ(2,"div",4)(3,"mat-form-field",5)(4,"mat-label"),e._uU(5,"Owner"),e.qZA(),e.TgZ(6,"mat-select",6)(7,"mat-option",7),e._uU(8,"All"),e.qZA(),e.YNc(9,Qn,2,2,"mat-option",8),e.qZA()()(),e.TgZ(10,"div",4)(11,"mat-form-field",5)(12,"mat-label"),e._uU(13,"Vehicle"),e.qZA(),e.TgZ(14,"mat-select",9),e.YNc(15,Yn,2,3,"mat-option",8),e.qZA()()(),e.TgZ(16,"div",4)(17,"mat-form-field",5)(18,"mat-label"),e._uU(19,"Driver"),e.qZA(),e.TgZ(20,"mat-select",10),e.YNc(21,On,2,3,"mat-option",8),e.qZA()()(),e.TgZ(22,"div",4)(23,"mat-form-field",11)(24,"mat-label"),e._uU(25,"Start"),e.qZA(),e._UZ(26,"input",12)(27,"mat-datepicker-toggle",13)(28,"mat-datepicker",null,14),e.qZA(),e.TgZ(30,"mat-form-field",11)(31,"mat-label"),e._uU(32,"End"),e.qZA(),e._UZ(33,"input",15)(34,"mat-datepicker-toggle",16)(35,"mat-datepicker",null,17),e.qZA()(),e.TgZ(37,"div",4)(38,"mat-form-field",5)(39,"mat-label"),e._uU(40,"Note"),e.qZA(),e._UZ(41,"input",18),e.qZA()(),e.TgZ(42,"div",19)(43,"app-crud-reset-button",20),e.NdJ("resetEvent",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.reset())}),e.qZA(),e._UZ(44,"app-crud-edit-button",21),e.qZA()()()}if(2&t){const a=e.MAs(29),i=e.MAs(36),n=e.oxw();e.xp6(1),e.Q6J("formGroup",n.manageForm),e.xp6(8),e.Q6J("ngForOf",n.manageData.ownerList),e.xp6(6),e.Q6J("ngForOf",n.vehicleListFiltered),e.xp6(6),e.Q6J("ngForOf",n.manageData.driverList),e.xp6(5),e.Q6J("matDatepicker",a),e.xp6(1),e.Q6J("for",a),e.xp6(6),e.Q6J("matDatepicker",i),e.xp6(1),e.Q6J("for",i),e.xp6(9),e.Q6J("isReset",!1)}}let kn=(()=>{const o=class{constructor(i,n,l,c,r){this.dialogRef=i,this.vehicleAssignService=n,this.ds=l,this.renderer=c,this.data=r,this.isLoaded=!1,this.vehicleListFiltered=[]}ngOnInit(){this.manageForm=new s.cw({startDate:new s.NI({value:null,disabled:!0},[s.kI.required]),endDate:new s.NI(null),ownerId:new s.NI({value:"",disabled:!0}),vehicleId:new s.NI({value:null,disabled:!0},[s.kI.required]),driverId:new s.NI({value:null,disabled:!0},[s.kI.required]),note:new s.NI(null)}),this.isLoaded=!1,this.sub=this.vehicleAssignService.getVehicleAssignManageData().subscribe(i=>{this.manageData=i.item,this.vehicleListFiltered=this.manageData.vehicleList;let n=this.manageData.ownerList.filter(l=>l.name==this.data.vehicle.owner)?.at(0);this.manageForm.patchValue({startDate:this.ds.responseFormatToDate(this.data.startDate),endDate:null!=this.data.endDate?this.ds.responseFormatToDate(this.data.endDate):null,ownerId:n?.id,vehicleId:this.data.vehicle.id,driverId:this.data.driver.id,note:this.data.note}),this.isLoaded=!0})}editVehicleAssign(){if(!this.manageForm.valid)return void this.manageForm.markAllAsTouched();if(!confirm(A.J.areYouSureTo))return;let i=new Jn;i.id=this.data.id,null!=this.manageForm.value.endDate&&(i.endDate=this.ds.formatToRequest(this.manageForm.value.endDate)),i.note=this.manageForm.value.note,this.sub=this.vehicleAssignService.editVehicleAssign(i).subscribe(n=>{n?.status==T.s.success?(this.reset(),this.closeDialog()):alert(n?.message)})}reset(){this.manageForm.patchValue({endDate:null,note:null})}closeDialog(){this.dialogRef.close(!0)}ngOnDestroy(){this.sub?.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(u.so),e.Y36(X),e.Y36(y.R),e.Y36(e.Qsj),e.Y36(u.WI))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-edit-vehicle-assign"]],decls:2,vars:2,consts:[[4,"ngIf"],["mat-dialog-content","","class","row",4,"ngIf"],["mat-dialog-content","",1,"row"],[1,"my-2",3,"formGroup","submit"],[1,"row","form-group"],[1,"form-field","col-12"],["formControlName","ownerId"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","vehicleId"],["formControlName","driverId"],["appearance","outline",1,"col-6","form-field"],["matInput","","formControlName","startDate",3,"matDatepicker"],["matIconSuffix","",3,"for"],["picker",""],["matInput","","formControlName","endDate",3,"matDatepicker"],["matSuffix","","matIconSuffix","",3,"for"],["picker2",""],["type","text","matInput","","formControlName","note"],[1,"row"],[1,"col-2",3,"isReset","resetEvent"],[1,"col-2","offset-8"],[3,"value"]],template:function(n,l){1&n&&(e.YNc(0,Sn,2,0,"app-form-heading",0),e.YNc(1,Rn,45,9,"div",1)),2&n&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[f.sg,f.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,h.KE,h.hX,h.R9,b.Nt,u.xY,F.gD,V.ey,g.Mq,g.hl,g.nW,G.W,k.X,E.H]}),t})();const Mn=["page"];function Gn(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," Vehicle "),e.qZA())}function Kn(t,o){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.HOy(" ",a.vehicle.code," - ",a.vehicle.plateNumber," (",a.vehicle.make," ",a.vehicle.model,") ")}}function Hn(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," Owner "),e.qZA())}function $n(t,o){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.vehicle.owner," ")}}function Bn(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," Driver "),e.qZA())}function Pn(t,o){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.driver.name," ")}}function jn(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," Start "),e.qZA())}function zn(t,o){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.startDate.substring(0,16)," ")}}function Xn(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," End "),e.qZA())}function Wn(t,o){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",null==a.endDate?null:a.endDate.substring(0,16)," ")}}function eo(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," Description "),e.qZA())}function to(t,o){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.description," ")}}function io(t,o){1&t&&(e.TgZ(0,"th",22),e._uU(1," Note "),e.qZA())}function no(t,o){if(1&t&&(e.TgZ(0,"td",24),e._uU(1),e.qZA()),2&t){const a=o.$implicit;e.xp6(1),e.hij(" ",a.note," ")}}function oo(t,o){1&t&&e._UZ(0,"th",25)}function ao(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-edit-action-icon",29),e.NdJ("editEvent",function(){e.CHM(a);const n=e.oxw().$implicit,l=e.oxw();return e.KtG(l.edit(n))}),e.qZA()}if(2&t){const a=e.oxw().$implicit;e.Q6J("item",a)}}function lo(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-delete-action-icon",30),e.NdJ("deleteEvent",function(){e.CHM(a);const n=e.oxw().$implicit,l=e.oxw();return e.KtG(l.delete(n))}),e.qZA()}if(2&t){const a=e.oxw().$implicit;e.Q6J("item",a)}}function so(t,o){if(1&t&&(e.TgZ(0,"td",26),e.YNc(1,ao,1,1,"app-edit-action-icon",27),e.YNc(2,lo,1,1,"app-delete-action-icon",28),e.qZA()),2&t){const a=e.oxw();e.xp6(1),e.Q6J("ngIf",a.allowEdit),e.xp6(1),e.Q6J("ngIf",a.allowDelete)}}function co(t,o){1&t&&e._UZ(0,"tr",31)}function ro(t,o){1&t&&e._UZ(0,"tr",32)}const mo=function(){return[10,20,50]};let po=(()=>{const o=class{constructor(i,n){this.menuRoleService=i,this.dialog=n,this.moreEvent=new Z.x,this.editEvent=new Z.x,this.deleteEvent=new Z.x,this.displayedColumns=["vehicle","owner","driver","startDate","endDate","note","manage"],this.allowEdit=!1,this.allowDelete=!1}ngOnInit(){this.allowEdit=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.VehicleAssign_Fleet,v.k.edit),this.allowDelete=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.VehicleAssign_Fleet,v.k.delete)}ngOnChanges(i){this.vehicleAssignList.paginator=this.paginator}ngAfterViewInit(){this.vehicleAssignList.paginator=this.paginator}more(){this.moreEvent.next(!0)}edit(i){this.dialog.open(kn,{data:i,width:"40%",maxHeight:"auto"}).afterClosed().subscribe(l=>{1==l&&this.editEvent.next()})}delete(i){this.deleteEvent.next(i)}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(q.K),e.Y36(u.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-vehicle-assign-list"]],viewQuery:function(n,l){if(1&n&&e.Gf(Mn,5),2&n){let c;e.iGM(c=e.CRH())&&(l.paginator=c.first)}},inputs:{vehicleAssignList:"vehicleAssignList",count:"count"},outputs:{moreEvent:"moreEvent",editEvent:"editEvent",deleteEvent:"deleteEvent"},features:[e.TTD],decls:33,vars:7,consts:[[1,"mat-elevation-z8"],["mat-table","",3,"dataSource"],["matColumnDef","vehicle"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","col",4,"matCellDef"],["matColumnDef","owner"],["matColumnDef","driver"],["matColumnDef","startDate"],["matColumnDef","endDate"],["matColumnDef","note"],["matColumnDef","nextDate"],["mat-cell","","class","col-1",4,"matCellDef"],["matColumnDef","manage"],["mat-header-cell","","class","text-end",4,"matHeaderCellDef"],["mat-cell","","class","text-end","style","width: 12rem;",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","","aria-label","",3,"pageSizeOptions"],["page",""],[1,"row"],[1,"col-6"],[3,"loaded","count","loadMore"],["mat-header-cell",""],["mat-cell","",1,"col"],["mat-cell","",1,"col-1"],["mat-header-cell","",1,"text-end"],["mat-cell","",1,"text-end",2,"width","12rem"],[3,"item","editEvent",4,"ngIf"],[3,"item","deleteEvent",4,"ngIf"],[3,"item","editEvent"],[3,"item","deleteEvent"],["mat-header-row",""],["mat-row",""]],template:function(n,l){1&n&&(e.TgZ(0,"div",0)(1,"table",1),e.ynx(2,2),e.YNc(3,Gn,2,0,"th",3),e.YNc(4,Kn,2,4,"td",4),e.BQk(),e.ynx(5,5),e.YNc(6,Hn,2,0,"th",3),e.YNc(7,$n,2,1,"td",4),e.BQk(),e.ynx(8,6),e.YNc(9,Bn,2,0,"th",3),e.YNc(10,Pn,2,1,"td",4),e.BQk(),e.ynx(11,7),e.YNc(12,jn,2,0,"th",3),e.YNc(13,zn,2,1,"td",4),e.BQk(),e.ynx(14,8),e.YNc(15,Xn,2,0,"th",3),e.YNc(16,Wn,2,1,"td",4),e.BQk(),e.ynx(17,9),e.YNc(18,eo,2,0,"th",3),e.YNc(19,to,2,1,"td",4),e.BQk(),e.ynx(20,10),e.YNc(21,io,2,0,"th",3),e.YNc(22,no,2,1,"td",11),e.BQk(),e.ynx(23,12),e.YNc(24,oo,1,0,"th",13),e.YNc(25,so,3,2,"td",14),e.BQk(),e.YNc(26,co,1,0,"tr",15),e.YNc(27,ro,1,0,"tr",16),e.qZA(),e._UZ(28,"mat-paginator",17,18),e.qZA(),e.TgZ(30,"div",19)(31,"div",20)(32,"app-server-pagination",21),e.NdJ("loadMore",function(){return l.more()}),e.qZA()()()),2&n&&(e.xp6(1),e.Q6J("dataSource",l.vehicleAssignList),e.xp6(25),e.Q6J("matHeaderRowDef",l.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",l.displayedColumns),e.xp6(1),e.Q6J("pageSizeOptions",e.DdM(6,mo)),e.xp6(4),e.Q6J("loaded",l.vehicleAssignList.data.length)("count",l.count))},dependencies:[f.O5,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,H.NW,$.H,Y.b,z.p]}),t})();function uo(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-vehicle-assign-search-filter",3),e.NdJ("onSearchChange",function(n){e.CHM(a);const l=e.oxw();return e.KtG(l.changeSearchData(n))})("onSearch",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.getList())}),e.qZA()}if(2&t){const a=e.oxw();e.Q6J("searchData",a.searchData)}}function ho(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-add-button",7),e.NdJ("addEvent",function(){e.CHM(a);const n=e.oxw(2);return e.KtG(n.addVehicleAssign())}),e.qZA()}}function _o(t,o){if(1&t&&(e.TgZ(0,"div",4)(1,"app-table-heading",5),e._uU(2," Vehicle Assign "),e.qZA(),e.YNc(3,ho,1,0,"app-add-button",6),e.qZA()),2&t){const a=e.oxw();e.xp6(3),e.Q6J("ngIf",a.allowAdd)}}function fo(t,o){if(1&t){const a=e.EpF();e.TgZ(0,"app-vehicle-assign-list",8),e.NdJ("moreEvent",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.getList())})("editEvent",function(){e.CHM(a);const n=e.oxw();return e.KtG(n.editVehicleAssign())})("deleteEvent",function(n){e.CHM(a);const l=e.oxw();return e.KtG(l.deleteVehicleAssign(n))}),e.qZA()}if(2&t){const a=e.oxw();e.Q6J("vehicleAssignList",a.dataSource)("count",a.count)}}const go=[{path:"",component:jt},{path:"doc",component:Ki,pathMatch:"full"},{path:"odometer/reading",component:xn,pathMatch:"full"},{path:"assign",component:(()=>{const o=class{constructor(i,n,l,c){this.menuRoleService=i,this.vehicleAssignService=n,this.ds=l,this.dialog=c,this.isLoaded=!1,this.req=new An,this.eList=[],this.count=0,this.allowAdd=!1}ngOnInit(){this.isLoaded=!1,this.sub=this.vehicleAssignService.getVehicleAssignSearchData().pipe((0,N.w)(i=>(this.searchData=i.item,this.isLoaded=!0,this.dataSource=new m.by(this.eList),this.req.from=this.ds.formatToRequest(this.ds.monthStart(new Date)),this.req.to=this.ds.formatToRequest(new Date),this.req.pagination.pageSize=10,this.allowAdd=this.menuRoleService.isMenuRoleAuthorizedSingle(x.w.VehicleAssign_Fleet,v.k.add),this.vehicleAssignService.getVehicleAssignList(this.req)))).subscribe(i=>{this.update(i)})}ngAfterViewInit(){}changeSearchData(i){this.eList=[],this.dataSource=new m.by(this.eList),this.req.from=this.ds.formatToRequest(i.from),this.req.to=this.ds.formatToRequest(i.to),this.req.searchKey=i.searchKey,this.req.ownerId=""!=i.ownerId?i.ownerId:null,this.req.vehicleId=""!=i.vehicleId?i.vehicleId:null,this.req.driverId=""!=i.driverId?i.driverId:null,this.req.pagination.pageNumber=1}refreshList(){this.eList=[],this.dataSource=new m.by(this.eList),this.req.pagination.pageNumber=1,this.getList()}update(i){i?.response?.status==T.s.success&&(this.eList.push.apply(this.eList,i.list),this.dataSource=new m.by(this.eList),this.count=i.totalRecords,i.list.length>0&&(this.req.pagination.pageNumber+=1))}getList(){this.sub=this.vehicleAssignService.getVehicleAssignList(this.req).subscribe(i=>{this.update(i)})}addVehicleAssign(){this.dialog.open(Ln,{data:null,width:"40%",maxHeight:"auto"}).afterClosed().subscribe(n=>{1==n&&this.refreshList()})}editVehicleAssign(){this.refreshList()}deleteVehicleAssign(i){confirm(A.J.confirmDelete("vehicle assign"))&&(this.sub=this.vehicleAssignService.deleteVehicleAssign(i.id).subscribe(n=>{n?.status==T.s.success?this.refreshList():alert(n?.message)}))}ngOnDestroy(){this.sub?.unsubscribe()}};let t=o;return o.\u0275fac=function(n){return new(n||o)(e.Y36(q.K),e.Y36(X),e.Y36(y.R),e.Y36(u.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-vehicle-assign"]],decls:3,vars:3,consts:[[3,"searchData","onSearchChange","onSearch",4,"ngIf"],["class","row",4,"ngIf"],[3,"vehicleAssignList","count","moreEvent","editEvent","deleteEvent",4,"ngIf"],[3,"searchData","onSearchChange","onSearch"],[1,"row"],[1,"col-6"],["class","col-1 offset-5",3,"addEvent",4,"ngIf"],[1,"col-1","offset-5",3,"addEvent"],[3,"vehicleAssignList","count","moreEvent","editEvent","deleteEvent"]],template:function(n,l){1&n&&(e.YNc(0,uo,1,1,"app-vehicle-assign-search-filter",0),e.YNc(1,_o,4,1,"div",1),e.YNc(2,fo,1,2,"app-vehicle-assign-list",2)),2&n&&(e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded),e.xp6(1),e.Q6J("ngIf",l.isLoaded))},dependencies:[f.O5,te.L,M.u,Un,po]}),t})(),pathMatch:"full"}];let vo=(()=>{const o=class{};let t=o;return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[I.Bz.forChild(go)]}),t})();var Zo=d(529),wo=d(3214),To=d(1260);let xo=(()=>{const o=class{};let t=o;return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.ez,vo,s.u5,s.UX,Zo.JF,wo._,To.m,I.Bz]}),t})()},2696:(ce,O,d)=>{d.d(O,{L:()=>N});var f=d(7579),I=d(4650),m=d(4859);let N=(()=>{const U=class{constructor(){this.addEvent=new f.x}addItem(){this.addEvent.next()}};let J=U;return U.\u0275fac=function(v){return new(v||U)},U.\u0275cmp=I.Xpm({type:U,selectors:[["app-add-button"]],outputs:{addEvent:"addEvent"},decls:4,vars:0,consts:[["type","button","mat-raised-button","","color","primary",1,"col-12","my-2",3,"click"],[1,"material-icons"]],template:function(v,T){1&v&&(I.TgZ(0,"button",0),I.NdJ("click",function(){return T.addItem()}),I.TgZ(1,"i",1),I._uU(2,"add"),I.qZA(),I._uU(3," Add"),I.qZA())},dependencies:[m.lW]}),J})()}}]);